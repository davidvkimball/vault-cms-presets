/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __esm = (fn, res) => function __init() {
  return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/utils/frontmatter.ts
var frontmatter_exports = {};
__export(frontmatter_exports, {
  getFrontmatter: () => getFrontmatter,
  getFrontmatterSync: () => getFrontmatterSync,
  isFileTypeSupported: () => isFileTypeSupported
});
async function getFrontmatter(app, file, settings) {
  if (file.extension === "md") {
    const fileCache = app.metadataCache.getFileCache(file);
    return (fileCache == null ? void 0 : fileCache.frontmatter) || null;
  }
  if (file.extension === "mdx" && settings.enableMdxSupport) {
    try {
      const content = await app.vault.read(file);
      const frontmatterRegex = /^---\n([\s\S]*?)\n---/;
      const match = content.match(frontmatterRegex);
      if (match && match[1]) {
        const frontmatterText = match[1];
        try {
          const parsed = (0, import_obsidian.parseYaml)(frontmatterText);
          return parsed && typeof parsed === "object" ? parsed : null;
        } catch (parseError) {
          console.error("MDX YAML parse error:", parseError);
          return null;
        }
      }
      return null;
    } catch (readError) {
      console.error("Error reading MDX file:", readError);
      return null;
    }
  }
  return null;
}
function getFrontmatterSync(app, file, settings) {
  if (file.extension === "md") {
    const fileCache = app.metadataCache.getFileCache(file);
    return (fileCache == null ? void 0 : fileCache.frontmatter) || null;
  }
  if (file.extension === "mdx" && settings.enableMdxSupport) {
    return null;
  }
  return null;
}
function isFileTypeSupported(extension, settings) {
  if (extension === "md") {
    return true;
  }
  if (extension === "mdx") {
    return settings.enableMdxSupport;
  }
  return false;
}
var import_obsidian;
var init_frontmatter = __esm({
  "src/utils/frontmatter.ts"() {
    "use strict";
    import_obsidian = require("obsidian");
  }
});

// src/utils/search.ts
async function buildFileCache(files, metadataCache, app, propertyKey, settings) {
  const cache = /* @__PURE__ */ new Map();
  const { getFrontmatter: getFrontmatter2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
  await Promise.all(files.map(async (file) => {
    if (!isFileTypeSupported(file.extension, settings)) {
      return;
    }
    let frontmatter;
    if (file.extension === "md") {
      const fileCache = app.metadataCache.getFileCache(file);
      frontmatter = (fileCache == null ? void 0 : fileCache.frontmatter) || null;
    } else {
      frontmatter = await getFrontmatter2(app, file, settings);
    }
    let displayName = file.basename;
    let isCustomDisplay = false;
    let aliases = [];
    if (frontmatter && frontmatter[propertyKey] !== void 0 && frontmatter[propertyKey] !== null) {
      const propertyValueRaw = frontmatter[propertyKey];
      let propertyValue;
      if (typeof propertyValueRaw === "string") {
        propertyValue = propertyValueRaw.trim();
      } else if (typeof propertyValueRaw === "number" || typeof propertyValueRaw === "boolean") {
        propertyValue = String(propertyValueRaw).trim();
      } else {
        propertyValue = "";
      }
      if (propertyValue && propertyValue !== "") {
        displayName = propertyValue;
        isCustomDisplay = true;
      }
    }
    if (frontmatter == null ? void 0 : frontmatter.aliases) {
      const aliasesRaw = frontmatter.aliases;
      aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
      aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
    }
    cache.set(file.path, {
      file,
      displayName,
      aliases,
      lastModified: file.stat.mtime,
      isCustomDisplay
    });
  }));
  return cache;
}
function isExcluded(file, app) {
  const metadataCache = app.metadataCache;
  if (typeof metadataCache.isExcludedFile === "function") {
    try {
      if (metadataCache.isExcludedFile(file)) return true;
      if (metadataCache.isExcludedFile(file.path)) return true;
    } catch (e) {
    }
  }
  try {
    const filters = app.vault.getConfig("userIgnoreFilters");
    if (Array.isArray(filters)) {
      const path = file.path;
      for (const filter of filters) {
        if (!filter) continue;
        if (filter.endsWith("/")) {
          if (path.startsWith(filter)) return true;
        } else {
          if (path === filter || path.startsWith(filter + "/")) return true;
        }
      }
    }
  } catch (e) {
  }
  return false;
}
var init_search = __esm({
  "src/utils/search.ts"() {
    "use strict";
    init_frontmatter();
  }
});

// src/ui/QuickSwitchModal.ts
var QuickSwitchModal_exports = {};
__export(QuickSwitchModal_exports, {
  QuickSwitchModal: () => QuickSwitchModal
});
var import_obsidian5, QuickSwitchModal;
var init_QuickSwitchModal = __esm({
  "src/ui/QuickSwitchModal.ts"() {
    "use strict";
    import_obsidian5 = require("obsidian");
    init_search();
    init_frontmatter();
    QuickSwitchModal = class extends import_obsidian5.FuzzySuggestModal {
      constructor(app, plugin) {
        super(app);
        this.fileCache = /* @__PURE__ */ new Map();
        this.recentFiles = [];
        this.searchTimeout = null;
        this.matchReasons = /* @__PURE__ */ new Map();
        this.plugin = plugin;
        this.limit = 8;
        if (this.plugin.settings.enableForQuickSwitcher) {
          this.setPlaceholder("Type to search notes by title or file name...");
        } else {
          this.setPlaceholder("Type to search files...");
        }
        void this.buildFileCache();
        this.updateRecentFiles();
        this.addKeyboardNavigation();
        this.addFooter();
        if (this.plugin.settings.enableForQuickSwitcher) {
          this.containerEl.addClass("property-over-filename-modal");
        }
      }
      addKeyboardNavigation() {
        this.inputEl.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            this.close();
            e.preventDefault();
            e.stopPropagation();
          }
        });
      }
      addFooter() {
        const promptContainer = this.containerEl.querySelector(".prompt");
        if (promptContainer) {
          const footer = promptContainer.createDiv({ cls: "prompt-instructions" });
          const instructions = [
            { command: "\u2191\u2193", action: "to navigate" },
            { command: "\u21B5", action: "to open" },
            { command: "ctrl \u21B5", action: "to open in new tab" },
            { command: "ctrl alt \u21B5", action: "to open to the right" },
            { command: "shift \u21B5", action: "to create" },
            { command: "esc", action: "to dismiss" }
          ];
          instructions.forEach(({ command, action }) => {
            const instruction = footer.createDiv({ cls: "prompt-instruction" });
            instruction.createSpan({ cls: "prompt-instruction-command", text: command });
            instruction.createSpan({ text: action });
          });
        }
      }
      async buildFileCache() {
        const files = this.getFilteredFiles();
        this.fileCache = await buildFileCache(
          files,
          this.app.metadataCache,
          this.app,
          this.plugin.settings.propertyKey,
          this.plugin.settings
        );
      }
      async updateFileCache(file) {
        const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
        if (!isFileTypeSupported2(file.extension, this.plugin.settings)) {
          return;
        }
        const frontmatter = await getFrontmatter2(this.app, file, this.plugin.settings);
        let displayName = file.basename;
        let isCustomDisplay = false;
        let aliases = [];
        if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
          const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
          if (propertyValue !== "") {
            displayName = propertyValue;
            isCustomDisplay = true;
          }
        }
        if (frontmatter == null ? void 0 : frontmatter.aliases) {
          const aliasesRaw = frontmatter.aliases;
          aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
          aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
        }
        this.fileCache.set(file.path, {
          file,
          displayName,
          aliases,
          lastModified: file.stat.mtime,
          isCustomDisplay
        });
      }
      updateRecentFiles() {
        var _a, _b;
        let recentFiles = [];
        const workspace = this.app.workspace;
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        const showAttachments = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showAttachments) != null ? _a : true;
        if ((_b = workspace.recentFileTracker) == null ? void 0 : _b.getLastOpenFiles) {
          const lastOpenFiles = workspace.recentFileTracker.getLastOpenFiles();
          recentFiles = lastOpenFiles.map((filePath) => this.app.vault.getAbstractFileByPath(filePath)).filter((file) => file instanceof import_obsidian5.TFile);
        }
        if (recentFiles.length === 0) {
          const openFiles = this.app.workspace.getLeavesOfType("markdown").map((leaf) => leaf.view).filter((view) => view instanceof import_obsidian5.MarkdownView).map((view) => view.file).filter((file) => file !== null).filter((file, index, self) => self.indexOf(file) === index);
          recentFiles = [...openFiles];
        }
        const behavior = this.plugin.settings.quickSwitcherExcludedBehavior;
        if (behavior !== "ignore") {
          recentFiles = recentFiles.filter((file) => !isExcluded(file, this.app));
        }
        if (!showAttachments) {
          recentFiles = recentFiles.filter(
            (file) => file.extension === "md" || file.extension === "mdx" && this.plugin.settings.enableMdxSupport
          );
        }
        const targetCount = 8;
        const existingPaths = new Set(recentFiles.map((f) => f.path));
        if (recentFiles.length < targetCount) {
          if (showAttachments) {
            const allFiles = this.app.vault.getFiles().filter((file) => file instanceof import_obsidian5.TFile);
            const additionalFiles = allFiles.filter((file) => !existingPaths.has(file.path)).slice(0, targetCount - recentFiles.length);
            recentFiles.push(...additionalFiles);
          } else {
            const allMarkdownFiles = this.app.vault.getMarkdownFiles();
            const mdxFiles = this.plugin.settings.enableMdxSupport ? this.app.vault.getFiles().filter(
              (f) => f instanceof import_obsidian5.TFile && f.extension === "mdx"
            ) : [];
            const allSupportedFiles = [...allMarkdownFiles, ...mdxFiles];
            const behavior2 = this.plugin.settings.quickSwitcherExcludedBehavior;
            const additionalFiles = allSupportedFiles.filter((file) => !existingPaths.has(file.path)).filter((file) => behavior2 === "ignore" || !isExcluded(file, this.app)).slice(0, targetCount - recentFiles.length);
            recentFiles.push(...additionalFiles);
          }
        }
        this.recentFiles = recentFiles.slice(0, targetCount);
      }
      getItems() {
        return this.getFilteredFiles();
      }
      getFilteredFiles() {
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        let files = this.app.vault.getMarkdownFiles();
        if (this.plugin.settings.enableMdxSupport) {
          const mdxFiles = this.app.vault.getFiles().filter(
            (f) => f instanceof import_obsidian5.TFile && f.extension === "mdx"
          );
          files = [...files, ...mdxFiles];
        }
        if (quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showAttachments) {
          const allFiles = this.app.vault.getFiles().filter((file) => file instanceof import_obsidian5.TFile);
          files = allFiles.filter(
            (file) => file instanceof import_obsidian5.TFile && (file.extension === "md" || file.extension === "mdx" && this.plugin.settings.enableMdxSupport || this.isAttachment(file))
          );
        }
        return files;
      }
      isAttachment(file) {
        const attachmentExtensions = ["png", "jpg", "jpeg", "gif", "svg", "webp", "pdf", "mp4", "mp3", "wav", "ogg", "webm"];
        return attachmentExtensions.includes(file.extension.toLowerCase());
      }
      getQuickSwitcherOptions() {
        var _a;
        try {
          const internalPlugins = this.app.internalPlugins;
          if (!internalPlugins) return null;
          const switcherPlugin = (_a = internalPlugins.getPluginById) == null ? void 0 : _a.call(internalPlugins, "switcher");
          if (!switcherPlugin || !switcherPlugin.instance) {
            return null;
          }
          return switcherPlugin.instance.options || null;
        } catch (e) {
          return null;
        }
      }
      getItemText(item) {
        if ("isNewNote" in item) {
          return item.newName;
        }
        if ("isUnresolved" in item) {
          return item.unresolvedText;
        }
        if (!this.plugin.settings.enableForQuickSwitcher) {
          return item.basename;
        }
        const display = this.getDisplayName(item);
        return display;
      }
      getDisplayName(file) {
        const cached = this.fileCache.get(file.path);
        if (cached) {
          return cached.displayName;
        }
        const frontmatter = getFrontmatterSync(this.app, file, this.plugin.settings);
        if (frontmatter) {
          const propertyValue = frontmatter[this.plugin.settings.propertyKey];
          if (propertyValue !== void 0 && propertyValue !== null) {
            const trimmed = typeof propertyValue === "string" ? propertyValue.trim() : (typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "").trim();
            if (trimmed !== "") {
              return trimmed;
            }
          }
        }
        return file.basename;
      }
      getSuggestions(query) {
        var _a;
        if (!this.plugin.settings.enableForQuickSwitcher) {
          const searchQuery2 = query.trim();
          if (!searchQuery2) {
            return this.getRecentFilesResults();
          }
          const files = this.getFilteredFiles();
          const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian5.prepareSimpleSearch)(searchQuery2) : (0, import_obsidian5.prepareFuzzySearch)(searchQuery2);
          const results = [];
          for (const file of files) {
            const match = (_a = search(file.basename)) != null ? _a : { score: 0, matches: [] };
            if (match.matches.length > 0) {
              results.push({ item: file, match });
            }
          }
          (0, import_obsidian5.sortSearchResults)(results);
          if (results.length === 0) {
            const newItem = { isNewNote: true, newName: searchQuery2 };
            results.push({
              item: newItem,
              match: { score: 1e3, matches: [[0, searchQuery2.length]] }
            });
          }
          return results.slice(0, this.limit);
        }
        const searchQuery = query.trim();
        if (this.searchTimeout) {
          clearTimeout(this.searchTimeout);
        }
        if (!searchQuery) {
          return this.getRecentFilesResults();
        }
        return this.performSearch(searchQuery);
      }
      getRecentFilesResults() {
        this.updateRecentFiles();
        this.matchReasons.clear();
        return this.recentFiles.map((file) => ({
          item: file,
          match: { score: 1e3, matches: [] }
        }));
      }
      performSearch(searchQuery) {
        var _a;
        const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian5.prepareSimpleSearch)(searchQuery) : (0, import_obsidian5.prepareFuzzySearch)(searchQuery);
        const results = [];
        this.matchReasons.clear();
        for (const cachedData of this.fileCache.values()) {
          const { file, displayName, aliases, isCustomDisplay } = cachedData;
          const matchReason = {
            matchedInTitle: false,
            matchedInFilename: false,
            matchedInAlias: false
          };
          let primaryMatch = null;
          let bestMatch = null;
          let matchType = null;
          if (isCustomDisplay) {
            primaryMatch = search(displayName);
            if (primaryMatch && primaryMatch.matches.length > 0) {
              matchReason.matchedInTitle = true;
              bestMatch = primaryMatch;
              matchType = "title";
            }
          }
          if (!matchType) {
            if (this.plugin.settings.includeFilenameInSearch && file.basename !== displayName) {
              const filenameMatch = search(file.basename);
              if (filenameMatch && filenameMatch.matches.length > 0) {
                matchReason.matchedInFilename = true;
                bestMatch = { ...filenameMatch, score: filenameMatch.score - 1 };
                matchType = "filename";
              }
            } else if (!isCustomDisplay) {
              const filenameMatch = search(file.basename);
              if (filenameMatch && filenameMatch.matches.length > 0) {
                matchReason.matchedInFilename = true;
                bestMatch = filenameMatch;
                matchType = "filename";
              }
            }
          }
          if (!matchType && this.plugin.settings.includeAliasesInSearch && aliases.length > 0) {
            for (const alias of aliases) {
              const aliasMatch = search(alias);
              if (aliasMatch && aliasMatch.matches.length > 0) {
                matchReason.matchedInAlias = true;
                matchReason.matchedAliasText = alias;
                bestMatch = { ...aliasMatch, score: aliasMatch.score - 1 };
                matchType = "alias";
                break;
              }
            }
          }
          if (bestMatch && bestMatch.matches.length > 0) {
            if (!searchQuery) {
              const behavior = this.plugin.settings.quickSwitcherExcludedBehavior;
              if (behavior !== "ignore" && isExcluded(file, this.app)) {
                continue;
              }
            }
            results.push({ item: file, match: bestMatch });
            this.matchReasons.set(file.path, matchReason);
          }
        }
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        const showExistingOnly = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showExistingOnly) != null ? _a : false;
        if (!showExistingOnly) {
          const { unresolvedLinks } = this.app.metadataCache;
          const unresolvedSet = /* @__PURE__ */ new Set();
          for (const sourcePath in unresolvedLinks) {
            const links = Object.keys(unresolvedLinks[sourcePath]);
            links.forEach((link) => unresolvedSet.add(link));
          }
          for (const unresolved of unresolvedSet) {
            const unresolvedMatch = search(unresolved);
            if (unresolvedMatch && unresolvedMatch.matches.length > 0) {
              const unresolvedItem = { isUnresolved: true, unresolvedText: unresolved };
              results.push({
                item: unresolvedItem,
                match: unresolvedMatch
              });
            }
          }
        }
        try {
          (0, import_obsidian5.sortSearchResults)(results);
          const behavior = this.plugin.settings.quickSwitcherExcludedBehavior;
          if (behavior !== "ignore") {
            results.sort((a, b) => {
              const aFile = a.item instanceof import_obsidian5.TFile ? a.item : null;
              const bFile = b.item instanceof import_obsidian5.TFile ? b.item : null;
              const aExcluded = aFile ? isExcluded(aFile, this.app) : false;
              const bExcluded = bFile ? isExcluded(bFile, this.app) : false;
              if (aExcluded && !bExcluded) return 1;
              if (!aExcluded && bExcluded) return -1;
              return 0;
            });
          }
          let filteredResults = results;
          if (behavior === "hide") {
            filteredResults = filteredResults.filter((r) => {
              return !(r.item instanceof import_obsidian5.TFile && isExcluded(r.item, this.app));
            });
          }
          if (showExistingOnly) {
            filteredResults = filteredResults.filter((r) => {
              return r.item instanceof import_obsidian5.TFile || "isNewNote" in r.item && r.item.isNewNote === true;
            });
          }
          const lowerQuery = searchQuery.toLowerCase();
          let exactMatch = filteredResults.some(
            (r) => {
              var _a2;
              return r.item instanceof import_obsidian5.TFile && (this.getDisplayName(r.item).toLowerCase() === lowerQuery || this.plugin.settings.includeFilenameInSearch && r.item.basename.toLowerCase() === lowerQuery || this.plugin.settings.includeAliasesInSearch && ((_a2 = this.fileCache.get(r.item.path)) == null ? void 0 : _a2.aliases.some((alias) => alias.toLowerCase() === lowerQuery)));
            }
          );
          if (!showExistingOnly && !exactMatch) {
            const { unresolvedLinks } = this.app.metadataCache;
            const unresolvedSet = /* @__PURE__ */ new Set();
            for (const sourcePath in unresolvedLinks) {
              const links = Object.keys(unresolvedLinks[sourcePath]);
              links.forEach((link) => unresolvedSet.add(link));
            }
            exactMatch = Array.from(unresolvedSet).some((link) => link.toLowerCase() === lowerQuery);
          }
          if (filteredResults.length === 0 && searchQuery) {
            const newItem = { isNewNote: true, newName: searchQuery };
            filteredResults.push({
              item: newItem,
              match: { score: 1e3, matches: [[0, searchQuery.length]] }
            });
          }
          return filteredResults.slice(0, this.limit);
        } catch (e) {
          new import_obsidian5.Notice("Error updating quick switcher suggestions. Please check console for details.");
          return [];
        }
      }
      renderSuggestion(suggestion, el) {
        var _a;
        const { item } = suggestion;
        if (item instanceof import_obsidian5.TFile && this.plugin.settings.quickSwitcherExcludedBehavior === "deemphasize" && isExcluded(item, this.app)) {
          el.addClass("mod-excluded");
        }
        if ("isUnresolved" in item && item.isUnresolved) {
          const unresolvedText = item.unresolvedText;
          el.empty();
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const suggestionTitle = suggestionContent.createDiv({ cls: "suggestion-title" });
          suggestionTitle.setText(unresolvedText);
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionFlair = suggestionAux.createSpan({
            cls: "suggestion-flair",
            attr: { "aria-label": "Unresolved link - Enter to create" }
          });
          this.createFilePlusIcon(suggestionFlair);
          return;
        }
        const text = this.getItemText(item);
        if ("isNewNote" in item) {
          el.empty();
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const suggestionTitle = suggestionContent.createDiv({ cls: "suggestion-title" });
          suggestionTitle.setText(text);
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionAction = suggestionAux.createSpan({ cls: "suggestion-action" });
          suggestionAction.setText("Enter to create");
          return;
        }
        if (!this.plugin.settings.enableForQuickSwitcher) {
          if (item instanceof import_obsidian5.TFile) {
            el.setText(item.path.replace(".md", ""));
          } else {
            el.setText(text);
          }
        } else {
          if (!(item instanceof import_obsidian5.TFile)) {
            el.setText(text);
            return;
          }
          const cachedData = this.fileCache.get(item.path);
          const isCustomDisplay = (_a = cachedData == null ? void 0 : cachedData.isCustomDisplay) != null ? _a : false;
          const matchReason = this.matchReasons.get(item.path);
          if (!isCustomDisplay && (matchReason == null ? void 0 : matchReason.matchedInAlias) && matchReason.matchedAliasText) {
            el.addClass("mod-complex");
            const suggestionContent = el.createDiv({ cls: "suggestion-content" });
            const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
            titleEl.setText(matchReason.matchedAliasText);
            const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
            pathEl.setText(item.path.replace(".md", ""));
            const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
            const suggestionFlair = suggestionAux.createSpan({
              cls: "suggestion-flair",
              attr: { "aria-label": "Alias Match" }
            });
            this.createForwardIcon(suggestionFlair);
          } else if (isCustomDisplay) {
            const shouldShowIcon = matchReason && (matchReason.matchedInTitle || matchReason.matchedInFilename || matchReason.matchedInAlias);
            if (shouldShowIcon) {
              el.addClass("mod-complex");
              const suggestionContent = el.createDiv({ cls: "suggestion-content" });
              const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
              titleEl.setText(text);
              const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
              pathEl.setText(item.path.replace(".md", ""));
              const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
              const suggestionFlair = suggestionAux.createSpan({
                cls: "suggestion-flair",
                attr: { "aria-label": this.getIconLabel(matchReason) }
              });
              if (matchReason.matchedInTitle) {
                this.createTypeIcon(suggestionFlair);
              } else if (matchReason.matchedInFilename) {
                this.createFileIcon(suggestionFlair);
              } else if (matchReason.matchedInAlias) {
                this.createForwardIcon(suggestionFlair);
              }
            } else {
              el.addClass("mod-complex");
              const suggestionContent = el.createDiv({ cls: "suggestion-content" });
              const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
              titleEl.setText(text);
              const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
              pathEl.setText(item.path.replace(".md", ""));
              const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
              const suggestionFlair = suggestionAux.createSpan({
                cls: "suggestion-flair",
                attr: { "aria-label": "Property-based title" }
              });
              this.createTypeIcon(suggestionFlair);
            }
          } else {
            el.setText(text);
          }
        }
      }
      getIconLabel(matchReason) {
        if (matchReason.matchedInTitle) {
          return "Title/Property Match";
        } else if (matchReason.matchedInFilename) {
          return "File Name Match";
        } else if (matchReason.matchedInAlias) {
          return "Alias Match";
        }
        return "Match";
      }
      createTypeIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-type");
        const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline1.setAttribute("points", "4 7 4 4 20 4 20 7");
        svg.appendChild(polyline1);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "9");
        line1.setAttribute("y1", "20");
        line1.setAttribute("x2", "15");
        line1.setAttribute("y2", "20");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "12");
        line2.setAttribute("y1", "4");
        line2.setAttribute("x2", "12");
        line2.setAttribute("y2", "20");
        svg.appendChild(line2);
        container.appendChild(svg);
      }
      createFileIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-file-text");
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
        svg.appendChild(path);
        const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline1.setAttribute("points", "14,2 14,8 20,8");
        svg.appendChild(polyline1);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "16");
        line1.setAttribute("y1", "13");
        line1.setAttribute("x2", "8");
        line1.setAttribute("y2", "13");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "16");
        line2.setAttribute("y1", "17");
        line2.setAttribute("x2", "8");
        line2.setAttribute("y2", "17");
        svg.appendChild(line2);
        const polyline2 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline2.setAttribute("points", "10,9 9,9 8,9");
        svg.appendChild(polyline2);
        container.appendChild(svg);
      }
      createForwardIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-forward");
        const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline.setAttribute("points", "15 17 20 12 15 7");
        svg.appendChild(polyline);
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M4 18v-2a4 4 0 0 1 4-4h12");
        svg.appendChild(path);
        container.appendChild(svg);
      }
      createFilePlusIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-file-plus");
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
        svg.appendChild(path);
        const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline.setAttribute("points", "14,2 14,8 20,8");
        svg.appendChild(polyline);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "12");
        line1.setAttribute("y1", "18");
        line1.setAttribute("x2", "12");
        line1.setAttribute("y2", "12");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "9");
        line2.setAttribute("y1", "15");
        line2.setAttribute("x2", "15");
        line2.setAttribute("y2", "15");
        svg.appendChild(line2);
        container.appendChild(svg);
      }
      isUsingCustomProperty(file) {
        const cache = this.app.metadataCache.getFileCache(file);
        const frontmatter = cache == null ? void 0 : cache.frontmatter;
        const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
        if (propertyValue === void 0 || propertyValue === null) {
          return false;
        }
        const strValue = typeof propertyValue === "string" ? propertyValue : typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "";
        return strValue.trim() !== "";
      }
      isUsingAlias(file) {
        const cache = this.app.metadataCache.getFileCache(file);
        const frontmatter = cache == null ? void 0 : cache.frontmatter;
        const aliases = frontmatter == null ? void 0 : frontmatter.aliases;
        if (!aliases) return false;
        const isUsingCustomProperty = this.isUsingCustomProperty(file);
        return !isUsingCustomProperty && Boolean(aliases);
      }
      onChooseItem(item, evt) {
        var _a, _b, _c;
        if ("isUnresolved" in item && item.isUnresolved) {
          const unresolvedText = item.unresolvedText;
          const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
          const sourcePath = ((_a = activeView == null ? void 0 : activeView.file) == null ? void 0 : _a.path) || "";
          void this.app.workspace.openLinkText(unresolvedText, sourcePath).catch((err) => {
            const message = err instanceof Error ? err.message : String(err);
            new import_obsidian5.Notice(`Error creating note: ${message}`);
          });
          return;
        }
        if ("isNewNote" in item) {
          const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
          const sourcePath = ((_b = activeView == null ? void 0 : activeView.file) == null ? void 0 : _b.path) || "";
          void this.app.workspace.openLinkText(item.newName, sourcePath).catch((err) => {
            const message = err instanceof Error ? err.message : String(err);
            new import_obsidian5.Notice(`Error creating note: ${message}`);
          });
        } else if (item instanceof import_obsidian5.TFile) {
          if (evt instanceof KeyboardEvent) {
            if (evt.ctrlKey && evt.altKey) {
              const leaf = this.app.workspace.getLeaf(true);
              void leaf.openFile(item);
            } else if (evt.ctrlKey) {
              void this.app.workspace.getLeaf().openFile(item);
            } else if (evt.shiftKey) {
              const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
              const sourcePath = ((_c = activeView == null ? void 0 : activeView.file) == null ? void 0 : _c.path) || "";
              const currentQuery = this.inputEl.value.trim();
              if (currentQuery) {
                void this.app.workspace.openLinkText(currentQuery, sourcePath).catch((err) => {
                  const message = err instanceof Error ? err.message : String(err);
                  new import_obsidian5.Notice(`Error creating note: ${message}`);
                });
              } else {
                void this.app.workspace.getLeaf().openFile(item);
              }
            } else {
              void this.app.workspace.getLeaf().openFile(item);
            }
          } else {
            void this.app.workspace.getLeaf().openFile(item);
          }
        }
      }
    };
  }
});

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => PropertyOverFileNamePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian13 = require("obsidian");

// src/settings.ts
var DEFAULT_SETTINGS = {
  propertyKey: "title",
  enableForLinking: true,
  enableForQuickSwitcher: true,
  includeFilenameInSearch: true,
  includeAliasesInSearch: true,
  enableForDragDrop: true,
  useSimpleSearch: false,
  enableForGraphView: true,
  enableForBacklinks: true,
  enableForTabs: true,
  enableForExplorer: false,
  folderNoteFilename: "",
  enableForWindowFrame: true,
  enableForBookmarks: true,
  enableMdxSupport: false,
  quickSwitcherExcludedBehavior: "deemphasize",
  linkSuggesterExcludedBehavior: "deemphasize"
};

// src/ui/LinkTitleSuggest.ts
var import_obsidian2 = require("obsidian");
init_search();
var LinkTitleSuggest = class extends import_obsidian2.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.fileCache = /* @__PURE__ */ new Map();
    this.searchTimeout = null;
    this.matchReasons = /* @__PURE__ */ new Map();
    this.plugin = plugin;
    void this.buildFileCache();
  }
  open() {
    super.open();
    const el = this.suggestEl;
    if (el) {
      el.addClass("property-over-filename-suggestion");
      if (!el.querySelector(".prompt-instructions")) {
        const instructions = el.createDiv({ cls: "prompt-instructions" });
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type # to link heading");
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type ^ to link blocks");
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type | to change display text");
      }
    }
    this.addKeyboardNavigation();
  }
  addKeyboardNavigation() {
    const el = this.suggestEl;
    if (!el) return;
    el.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        this.close();
        e.preventDefault();
        e.stopPropagation();
      }
    });
  }
  onTrigger(cursor, editor, file) {
    if (!this.plugin.settings.enableForLinking) return null;
    const line = editor.getLine(cursor.line).substring(0, cursor.ch);
    const match = /\[\[([^#^|\]]*)$/.exec(line);
    if (match) {
      return {
        start: { line: cursor.line, ch: line.lastIndexOf("[[") },
        end: cursor,
        query: match[1]
      };
    }
    return null;
  }
  async buildFileCache() {
    const mdFiles = this.app.vault.getMarkdownFiles();
    const allFiles = [...mdFiles];
    if (this.plugin.settings.enableMdxSupport) {
      const mdxFiles = this.app.vault.getFiles().filter(
        (f) => f instanceof import_obsidian2.TFile && f.extension === "mdx"
      );
      allFiles.push(...mdxFiles);
    }
    this.fileCache = await buildFileCache(
      allFiles,
      this.app.metadataCache,
      this.app,
      this.plugin.settings.propertyKey,
      this.plugin.settings
    );
  }
  async updateFileCache(file) {
    const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
    if (!isFileTypeSupported2(file.extension, this.plugin.settings)) {
      return;
    }
    const frontmatter = await getFrontmatter2(this.app, file, this.plugin.settings);
    let displayName = file.basename;
    let isCustomDisplay = false;
    let aliases = [];
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        displayName = propertyValue;
        isCustomDisplay = true;
      }
    }
    if (frontmatter == null ? void 0 : frontmatter.aliases) {
      const aliasesRaw = frontmatter.aliases;
      aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
      aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
    }
    this.fileCache.set(file.path, {
      file,
      displayName,
      aliases,
      lastModified: file.stat.mtime,
      isCustomDisplay
    });
  }
  getSuggestions(context) {
    const query = context.query.trim();
    return this.performSearch(query);
  }
  performSearch(query) {
    var _a;
    if (!query || query.trim() === "") {
      const behavior2 = this.plugin.settings.linkSuggesterExcludedBehavior;
      const suggestions2 = Array.from(this.fileCache.values()).filter((cached) => behavior2 === "ignore" || !isExcluded(cached.file, this.app)).sort((a, b) => b.lastModified - a.lastModified).slice(0, 10).map((cached) => ({
        file: cached.file,
        display: cached.displayName,
        isCustomDisplay: cached.isCustomDisplay
      }));
      return suggestions2;
    }
    const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian2.prepareSimpleSearch)(query) : (0, import_obsidian2.prepareFuzzySearch)(query);
    const searchableSuggestions = [];
    this.matchReasons.clear();
    for (const cachedData of this.fileCache.values()) {
      const { file, displayName, aliases, isCustomDisplay } = cachedData;
      const matchReason = {
        matchedInTitle: false,
        matchedInFilename: false,
        matchedInAlias: false
      };
      let primaryMatch = null;
      let bestMatch = null;
      let matchType = null;
      if (isCustomDisplay) {
        primaryMatch = search(displayName);
        if (primaryMatch && primaryMatch.matches.length > 0) {
          matchReason.matchedInTitle = true;
          bestMatch = primaryMatch;
          matchType = "title";
        }
      }
      if (!matchType) {
        if (this.plugin.settings.includeFilenameInSearch && file.basename !== displayName) {
          const filenameMatch = search(file.basename);
          if (filenameMatch && filenameMatch.matches.length > 0) {
            matchReason.matchedInFilename = true;
            bestMatch = { ...filenameMatch, score: filenameMatch.score - 1 };
            matchType = "filename";
          }
        } else if (!isCustomDisplay) {
          const filenameMatch = search(file.basename);
          if (filenameMatch && filenameMatch.matches.length > 0) {
            matchReason.matchedInFilename = true;
            bestMatch = filenameMatch;
            matchType = "filename";
          }
        }
      }
      if (!matchType && this.plugin.settings.includeAliasesInSearch && aliases.length > 0) {
        for (const alias of aliases) {
          const aliasMatch = search(alias);
          if (aliasMatch && aliasMatch.matches.length > 0) {
            matchReason.matchedInAlias = true;
            matchReason.matchedAliasText = alias;
            bestMatch = { ...aliasMatch, score: aliasMatch.score - 1 };
            matchType = "alias";
            break;
          }
        }
      }
      if (bestMatch && bestMatch.matches.length > 0) {
        if (!query) {
          const behavior2 = this.plugin.settings.linkSuggesterExcludedBehavior;
          if (behavior2 !== "ignore" && isExcluded(file, this.app)) {
            continue;
          }
        }
        const suggestion = {
          file,
          display: displayName,
          isCustomDisplay
        };
        searchableSuggestions.push({ item: suggestion, match: bestMatch });
        this.matchReasons.set(file.path, matchReason);
      }
    }
    const quickSwitcherOptions = this.getQuickSwitcherOptions();
    const showExistingOnly = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showExistingOnly) != null ? _a : false;
    if (!showExistingOnly) {
      const { unresolvedLinks } = this.app.metadataCache;
      const unresolvedSet = /* @__PURE__ */ new Set();
      for (const sourcePath in unresolvedLinks) {
        const links = Object.keys(unresolvedLinks[sourcePath]);
        links.forEach((link) => unresolvedSet.add(link));
      }
      for (const unresolved of unresolvedSet) {
        const unresolvedMatch = search(unresolved);
        if (unresolvedMatch && unresolvedMatch.matches.length > 0) {
          searchableSuggestions.push({
            item: {
              display: unresolved,
              isCustomDisplay: false
              // No file property means it's unresolved
            },
            match: unresolvedMatch
          });
        }
      }
    }
    const behavior = this.plugin.settings.linkSuggesterExcludedBehavior;
    if (behavior !== "ignore") {
      searchableSuggestions.sort((a, b) => {
        const aFile = a.item.file;
        const bFile = b.item.file;
        const aExcluded = aFile ? isExcluded(aFile, this.app) : false;
        const bExcluded = bFile ? isExcluded(bFile, this.app) : false;
        if (aExcluded && !bExcluded) return 1;
        if (!aExcluded && bExcluded) return -1;
        return 0;
      });
    }
    let suggestions = searchableSuggestions.map((s) => s.item);
    if (behavior === "hide") {
      suggestions = suggestions.filter((s) => {
        return !(s.file && isExcluded(s.file, this.app));
      });
    }
    if (showExistingOnly) {
      suggestions = suggestions.filter((s) => s.file !== void 0);
    }
    if (suggestions.length === 0 && query) {
      suggestions.push({
        display: "No match found",
        isCustomDisplay: false,
        isNoMatch: true
      });
    }
    return suggestions;
  }
  renderSuggestion(suggestion, el) {
    el.empty();
    if (suggestion.file && this.plugin.settings.linkSuggesterExcludedBehavior === "deemphasize" && isExcluded(suggestion.file, this.app)) {
      el.addClass("mod-excluded");
    }
    if (suggestion.isNoMatch) {
      el.setText(suggestion.display);
      return;
    }
    if (suggestion.file) {
      const matchReason = this.matchReasons.get(suggestion.file.path);
      if (!suggestion.isCustomDisplay && (matchReason == null ? void 0 : matchReason.matchedInAlias) && matchReason.matchedAliasText) {
        el.addClass("mod-complex");
        const suggestionContent = el.createDiv({ cls: "suggestion-content" });
        const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
        titleEl.setText(matchReason.matchedAliasText);
        const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
        pathEl.setText(suggestion.file.path.replace(".md", ""));
        const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
        const suggestionFlair = suggestionAux.createSpan({
          cls: "suggestion-flair",
          attr: { "aria-label": "Alias Match" }
        });
        this.createForwardIcon(suggestionFlair);
      } else if (suggestion.isCustomDisplay) {
        const shouldShowIcon = matchReason && (matchReason.matchedInTitle || matchReason.matchedInFilename || matchReason.matchedInAlias);
        if (shouldShowIcon) {
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
          titleEl.setText(suggestion.display);
          const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
          pathEl.setText(suggestion.file.path.replace(".md", ""));
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionFlair = suggestionAux.createSpan({
            cls: "suggestion-flair",
            attr: { "aria-label": this.getIconLabel(matchReason) }
          });
          if (matchReason.matchedInTitle) {
            this.createTypeIcon(suggestionFlair);
          } else if (matchReason.matchedInFilename) {
            this.createFileIcon(suggestionFlair);
          } else if (matchReason.matchedInAlias) {
            this.createForwardIcon(suggestionFlair);
          }
        } else {
          el.setText(suggestion.display);
        }
      } else {
        el.setText(suggestion.display);
      }
    }
  }
  getIconLabel(matchReason) {
    if (matchReason.matchedInTitle) {
      return "Title/Property Match";
    } else if (matchReason.matchedInFilename) {
      return "File Name Match";
    } else if (matchReason.matchedInAlias) {
      return "Alias Match";
    }
    return "Match";
  }
  createTypeIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-type");
    const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline1.setAttribute("points", "4 7 4 4 20 4 20 7");
    svg.appendChild(polyline1);
    const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line1.setAttribute("x1", "9");
    line1.setAttribute("y1", "20");
    line1.setAttribute("x2", "15");
    line1.setAttribute("y2", "20");
    svg.appendChild(line1);
    const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line2.setAttribute("x1", "12");
    line2.setAttribute("y1", "4");
    line2.setAttribute("x2", "12");
    line2.setAttribute("y2", "20");
    svg.appendChild(line2);
    container.appendChild(svg);
  }
  createFileIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-file-text");
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
    svg.appendChild(path);
    const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline1.setAttribute("points", "14,2 14,8 20,8");
    svg.appendChild(polyline1);
    const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line1.setAttribute("x1", "16");
    line1.setAttribute("y1", "13");
    line1.setAttribute("x2", "8");
    line1.setAttribute("y2", "13");
    svg.appendChild(line1);
    const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line2.setAttribute("x1", "16");
    line2.setAttribute("y1", "17");
    line2.setAttribute("x2", "8");
    line2.setAttribute("y2", "17");
    svg.appendChild(line2);
    const polyline2 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline2.setAttribute("points", "10,9 9,9 8,9");
    svg.appendChild(polyline2);
    container.appendChild(svg);
  }
  createForwardIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-forward");
    const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline.setAttribute("points", "15 17 20 12 15 7");
    svg.appendChild(polyline);
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", "M4 18v-2a4 4 0 0 1 4-4h12");
    svg.appendChild(path);
    container.appendChild(svg);
  }
  isUsingCustomProperty(file) {
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
    if (propertyValue === void 0 || propertyValue === null) {
      return false;
    }
    const strValue = typeof propertyValue === "string" ? propertyValue : typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "";
    return strValue.trim() !== "";
  }
  isUsingAlias(file) {
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    const aliases = frontmatter == null ? void 0 : frontmatter.aliases;
    if (!aliases) return false;
    const isUsingCustomProperty = this.isUsingCustomProperty(file);
    return !isUsingCustomProperty && Boolean(aliases);
  }
  selectSuggestion(suggestion, evt) {
    var _a, _b;
    if (suggestion.isNoMatch) {
      return;
    }
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    if (!activeView || !this.context) return;
    const editor = activeView.editor;
    const { start, end } = this.context;
    const line = editor.getLine(start.line);
    let endPos = end;
    if (line.slice(end.ch, end.ch + 2) === "]]") {
      endPos = { line: end.line, ch: end.ch + 2 };
    }
    if (!suggestion.file) {
      return;
    }
    const vault = this.app.vault;
    const useMarkdownLinks = (_b = (_a = vault.getConfig) == null ? void 0 : _a.call(vault, "useMarkdownLinks")) != null ? _b : false;
    let linkText;
    if (suggestion.isCustomDisplay) {
      if (useMarkdownLinks) {
        linkText = `[${suggestion.display}](${encodeURI(suggestion.file.path)})`;
      } else {
        const linkPath = suggestion.file.path.replace(".md", "");
        linkText = `[[${linkPath}|${suggestion.display}]]`;
      }
    } else {
      if (useMarkdownLinks) {
        linkText = `[${suggestion.file.path.replace(".md", "")}](${encodeURI(suggestion.file.path)})`;
      } else {
        const linkPath = suggestion.file.path.replace(".md", "");
        linkText = `[[${linkPath}]]`;
      }
    }
    editor.replaceRange(linkText, { line: start.line, ch: start.ch }, endPos);
    const newCursorPos = start.ch + linkText.length;
    try {
      editor.setCursor({ line: start.line, ch: newCursorPos });
    } catch (e) {
      new import_obsidian2.Notice("Error setting cursor position. Please check console for details.");
    }
  }
  getQuickSwitcherOptions() {
    var _a;
    try {
      const internalPlugins = this.app.internalPlugins;
      if (!internalPlugins) return null;
      const switcherPlugin = (_a = internalPlugins.getPluginById) == null ? void 0 : _a.call(internalPlugins, "switcher");
      if (!switcherPlugin || !switcherPlugin.instance) {
        return null;
      }
      return switcherPlugin.instance.options || null;
    } catch (e) {
      return null;
    }
  }
};

// src/ui/SettingTab.ts
var import_obsidian4 = require("obsidian");

// src/utils/settings-compat.ts
var import_obsidian3 = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"), 1);
function createSettingsGroup(containerEl, heading, manifestId) {
  if ((0, import_obsidian3.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  if (manifestId) {
    containerEl.addClass(`${manifestId}-settings-compat`);
  }
  {
    if (heading) {
      const headingEl = containerEl.createDiv("setting-group-heading");
      headingEl.createEl("h3", { text: heading });
    }
    return {
      addSetting(cb) {
        const setting = new import_obsidian3.Setting(containerEl);
        cb(setting);
      }
    };
  }
}

// src/ui/SettingTab.ts
var SettingTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.icon = "lucide-type";
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass("property-over-filename-settings");
    const generalGroup = createSettingsGroup(containerEl, void 0, "property-over-file-name");
    generalGroup.addSetting((setting) => {
      setting.setName("Property key").setDesc("The property to use as the display title. Falls back to the file name when no property is set for that item.").addText(
        (text) => text.setPlaceholder("Title").setValue(this.plugin.settings.propertyKey).onChange(async (value) => {
          this.plugin.settings.propertyKey = value.trim() || "title";
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateLinkSuggester();
          this.plugin.updateGraphView();
          this.plugin.updateBacklinks();
          this.plugin.updateTabs();
          this.plugin.updateExplorer();
          this.plugin.updateWindowFrame();
          this.plugin.updateBookmarks();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("When linking notes").setDesc("Enable property-based titles in the link suggester.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForLinking).onChange(async (value) => {
          this.plugin.settings.enableForLinking = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateLinkSuggester();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In quick switcher").setDesc("Enable property-based titles in the quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForQuickSwitcher).onChange(async (value) => {
          const prevQuickSwitcherState = this.plugin.settings.enableForQuickSwitcher;
          this.plugin.settings.enableForQuickSwitcher = value;
          await this.plugin.saveSettings(prevQuickSwitcherState);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Include file name in fuzzy searches").setDesc("Include note file names in fuzzy search results for link suggester and quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.includeFilenameInSearch).onChange(async (value) => {
          this.plugin.settings.includeFilenameInSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Include aliases in fuzzy searches").setDesc("Include property aliases in fuzzy search results for link suggester and quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.includeAliasesInSearch).onChange(async (value) => {
          this.plugin.settings.includeAliasesInSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("When dragging notes").setDesc("Use property-based titles when dragging notes from the file explorer.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForDragDrop).onChange(async (value) => {
          this.plugin.settings.enableForDragDrop = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("When naming bookmarks").setDesc("Automatically use the configured property value as the default name when creating a bookmark.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForBookmarks).onChange(async (value) => {
          this.plugin.settings.enableForBookmarks = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateBookmarks();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In graph view").setDesc("Use the property instead of the file name as the note's title in graph view.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForGraphView).onChange(async (value) => {
          this.plugin.settings.enableForGraphView = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In backlinks and outgoing links").setDesc("Use the property instead of the file name in the linked mentions footer, dedicated backlinks panel, and outgoing links.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForBacklinks).onChange(async (value) => {
          this.plugin.settings.enableForBacklinks = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateBacklinks();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In tab titles").setDesc("Use the property instead of the file name in tab titles.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForTabs).onChange(async (value) => {
          const prevTabState = this.plugin.settings.enableForTabs;
          this.plugin.settings.enableForTabs = value;
          await this.plugin.saveSettings(void 0, prevTabState);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In window frame title").setDesc("Use the property instead of the file name in the browser window title bar.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForWindowFrame).onChange(async (value) => {
          this.plugin.settings.enableForWindowFrame = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateWindowFrame();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In file explorer").setDesc("Use the property instead of the file name in the file explorer.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForExplorer).onChange(async (value) => {
          this.plugin.settings.enableForExplorer = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateExplorer();
          this.display();
        })
      );
    });
    if (this.plugin.settings.enableForExplorer) {
      generalGroup.addSetting((setting) => {
        setting.setName("Folder note file name").setDesc("If a folder contains a file with this name that has the configured property, the folder will display that property value instead. This ensures compatibility with folder notes plugins. Leave blank to disable.").addText(
          (text) => text.setPlaceholder("Index").setValue(this.plugin.settings.folderNoteFilename).onChange(async (value) => {
            this.plugin.settings.folderNoteFilename = value.trim();
            await this.plugin.saveData(this.plugin.settings);
            this.plugin.updateExplorer();
          })
        );
      });
    }
    generalGroup.addSetting((setting) => {
      setting.setName("Use simple search").setDesc("Instead of using fuzzy search, simple search provides better performance with very large vaults (thousands of files).").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.useSimpleSearch).onChange(async (value) => {
          this.plugin.settings.useSimpleSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Excluded files in quick switcher").setDesc(`How files in Obsidian's "Excluded files" list should behave in the quick switcher.`).addDropdown(
        (dropdown) => dropdown.addOptions({
          deemphasize: "Deemphasize (move to bottom & gray out)",
          hide: "Hide entirely",
          ignore: "Ignore (treat as normal files)"
        }).setValue(this.plugin.settings.quickSwitcherExcludedBehavior).onChange(async (value) => {
          this.plugin.settings.quickSwitcherExcludedBehavior = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateQuickSwitcher();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Excluded files in link suggester").setDesc(`How files in Obsidian's "Excluded files" list should behave in the link suggester.`).addDropdown(
        (dropdown) => dropdown.addOptions({
          deemphasize: "Deemphasize (move to bottom & gray out)",
          hide: "Hide entirely",
          ignore: "Ignore (treat as normal files)"
        }).setValue(this.plugin.settings.linkSuggesterExcludedBehavior).onChange(async (value) => {
          this.plugin.settings.linkSuggesterExcludedBehavior = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateLinkSuggester();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Enable MDX file support").setDesc("Enable support for .mdx files. When enabled, the plugin will read properties from Mdx files manually (Obsidian's metadata cache only works for .md files). Note: Mdx support is partial - graph view is not supported due to technical limitations.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableMdxSupport).onChange(async (value) => {
          this.plugin.settings.enableMdxSupport = value;
          await this.plugin.saveSettings();
          this.plugin.rebuildCache();
          this.plugin.updateLinkSuggester();
          this.plugin.updateQuickSwitcher();
          this.plugin.updateGraphView();
          this.plugin.updateBacklinks();
          this.plugin.updateTabs();
          this.plugin.updateExplorer();
          this.plugin.updateWindowFrame();
          this.plugin.updateBookmarks();
        })
      );
    });
  }
};

// src/commands/index.ts
var import_obsidian6 = require("obsidian");
function registerCommands(plugin) {
  plugin.addCommand({
    id: "open-quick-switcher",
    name: "Open quick switcher (property-based)",
    callback: async () => {
      const { QuickSwitchModal: QuickSwitchModal2 } = await Promise.resolve().then(() => (init_QuickSwitchModal(), QuickSwitchModal_exports));
      new QuickSwitchModal2(plugin.app, plugin).open();
    }
  });
  plugin.addCommand({
    id: "toggle-linking",
    name: "Toggle property-based linking",
    callback: async () => {
      plugin.settings.enableForLinking = !plugin.settings.enableForLinking;
      await plugin.saveData(plugin.settings);
      plugin.updateLinkSuggester();
      new import_obsidian6.Notice(`Property-based linking ${plugin.settings.enableForLinking ? "enabled" : "disabled"}`);
    }
  });
  plugin.addCommand({
    id: "toggle-quick-switcher",
    name: "Toggle property-based quick switcher",
    callback: async () => {
      const prevState = plugin.settings.enableForQuickSwitcher;
      plugin.settings.enableForQuickSwitcher = !plugin.settings.enableForQuickSwitcher;
      await plugin.saveSettings(prevState);
      new import_obsidian6.Notice(`Property-based Quick Switcher ${plugin.settings.enableForQuickSwitcher ? "enabled" : "disabled"}`);
    }
  });
  plugin.addCommand({
    id: "rebuild-cache",
    name: "Rebuild file cache",
    callback: () => {
      plugin.rebuildCache();
      new import_obsidian6.Notice("File cache rebuilt");
    }
  });
  plugin.addCommand({
    id: "toggle-drag-drop",
    name: "Toggle property-based drag and drop",
    callback: async () => {
      plugin.settings.enableForDragDrop = !plugin.settings.enableForDragDrop;
      await plugin.saveData(plugin.settings);
      new import_obsidian6.Notice(`Property-based drag and drop ${plugin.settings.enableForDragDrop ? "enabled" : "disabled"}`);
    }
  });
}

// src/services/QuickSwitcherService.ts
var QuickSwitcherService = class {
  constructor(plugin) {
    this.isCommandOverridden = false;
    this.plugin = plugin;
  }
  updateQuickSwitcher() {
    if (this.plugin.settings.enableForQuickSwitcher && !this.isCommandOverridden) {
      this.overrideQuickSwitcherCommand();
    } else if (!this.plugin.settings.enableForQuickSwitcher && this.isCommandOverridden) {
      this.restoreOriginalCommand();
    }
  }
  overrideQuickSwitcherCommand() {
    var _a;
    const commands = this.plugin.app.commands.commands;
    if (commands["switcher:open"] && !this.originalSwitcherCommand) {
      const originalCmd = commands["switcher:open"];
      this.originalSwitcherCommand = {
        id: originalCmd.id || "switcher:open",
        name: originalCmd.name || "Quick Switcher",
        icon: originalCmd.icon,
        hotkeys: originalCmd.hotkeys ? [...originalCmd.hotkeys] : [],
        callback: originalCmd.callback
      };
    }
    if (commands["switcher:open"]) {
      delete commands["switcher:open"];
    }
    const customCommand = {
      id: "switcher:open",
      name: "Quick Switcher",
      icon: (_a = this.originalSwitcherCommand) == null ? void 0 : _a.icon,
      hotkeys: [{ modifiers: ["Mod"], key: "o" }],
      callback: () => {
        const workspace = this.plugin.app.workspace;
        if (workspace.switcher && typeof workspace.switcher.close === "function") {
          workspace.switcher.close();
        }
        const existingModals = document.querySelectorAll(".modal");
        existingModals.forEach((modal) => {
          if (modal instanceof HTMLElement && !modal.classList.contains("hidden")) {
            modal.addClass("hidden");
          }
        });
        try {
          Promise.resolve().then(() => (init_QuickSwitchModal(), QuickSwitchModal_exports)).then(({ QuickSwitchModal: QuickSwitchModal2 }) => {
            const modal = new QuickSwitchModal2(this.plugin.app, this.plugin);
            modal.open();
          }).catch(() => {
            if (this.originalSwitcherCommand && this.originalSwitcherCommand.callback) {
              this.originalSwitcherCommand.callback();
            }
          });
        } catch (e) {
          if (this.originalSwitcherCommand && this.originalSwitcherCommand.callback) {
            this.originalSwitcherCommand.callback();
          }
        }
      }
    };
    commands["switcher:open"] = customCommand;
    this.isCommandOverridden = true;
  }
  restoreOriginalCommand() {
    if (!this.originalSwitcherCommand) {
      return;
    }
    const commands = this.plugin.app.commands.commands;
    if (commands["switcher:open"]) {
      delete commands["switcher:open"];
    }
    commands["switcher:open"] = {
      id: this.originalSwitcherCommand.id,
      name: this.originalSwitcherCommand.name,
      icon: this.originalSwitcherCommand.icon,
      hotkeys: this.originalSwitcherCommand.hotkeys,
      callback: this.originalSwitcherCommand.callback
    };
    this.isCommandOverridden = false;
  }
};

// src/services/DragDropService.ts
var import_obsidian7 = require("obsidian");
init_frontmatter();
var DragDropService = class {
  // Prevent duplicate processing within 100ms
  constructor(plugin) {
    this.lastDropTime = 0;
    this.lastDropData = null;
    this.DROP_DEBOUNCE_MS = 100;
    this.plugin = plugin;
  }
  handleDragDrop(event, editor) {
    const dataTransfer = event.dataTransfer;
    if (!dataTransfer) {
      return;
    }
    const filePath = dataTransfer.getData("text/plain");
    if (!filePath || !filePath.endsWith(".md") && !(filePath.endsWith(".mdx") && this.plugin.settings.enableMdxSupport)) {
      return;
    }
    const now = Date.now();
    if (now - this.lastDropTime < this.DROP_DEBOUNCE_MS && this.lastDropData === filePath) {
      return;
    }
    this.lastDropTime = now;
    this.lastDropData = filePath;
    const file = this.plugin.app.vault.getAbstractFileByPath(filePath);
    if (!file || !(file instanceof import_obsidian7.TFile)) {
      return;
    }
    if (file.extension === "md") {
      const displayName = this.getDisplayNameSync(file);
      if (displayName !== null) {
        setTimeout(() => {
          this.replaceLastInsertedLink(file, displayName, editor);
        }, 50);
      }
    } else if (file.extension === "mdx" && this.plugin.settings.enableMdxSupport) {
      void (async () => {
        const displayName = await this.getDisplayName(file);
        if (displayName !== null) {
          let attempts = 0;
          const maxAttempts = 5;
          const attemptReplace = () => {
            attempts++;
            const replaced = this.replaceLastInsertedLink(file, displayName, editor);
            if (!replaced && attempts < maxAttempts) {
              setTimeout(attemptReplace, 50 * attempts);
            }
          };
          setTimeout(attemptReplace, 150);
        }
      })();
    }
  }
  handleDOMDrop(event) {
    const target = event.target;
    const editorElement = target == null ? void 0 : target.closest(".cm-editor");
    const activeView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
    const hasActiveEditor = activeView && activeView.editor;
    if (!editorElement && !hasActiveEditor) {
      return;
    }
    const dataTransfer = event.dataTransfer;
    if (!dataTransfer) {
      return;
    }
    const filePath = dataTransfer.getData("text/plain");
    if (!filePath) {
      return;
    }
    let actualFilePath = filePath;
    if (filePath.startsWith("obsidian://open?")) {
      try {
        const url = new URL(filePath);
        const fileParam = url.searchParams.get("file");
        if (fileParam) {
          const decodedPath = decodeURIComponent(fileParam);
          if (decodedPath.endsWith(".mdx")) {
            actualFilePath = decodedPath;
          } else if (decodedPath.endsWith(".md")) {
            actualFilePath = decodedPath;
          } else {
            if (this.plugin.settings.enableMdxSupport) {
              const mdxFile = this.plugin.app.vault.getAbstractFileByPath(decodedPath + ".mdx");
              if (mdxFile) {
                actualFilePath = decodedPath + ".mdx";
              } else {
                actualFilePath = decodedPath + ".md";
              }
            } else {
              actualFilePath = decodedPath + ".md";
            }
          }
        } else {
          return;
        }
      } catch (e) {
        return;
      }
    } else if (!filePath.endsWith(".md") && !(filePath.endsWith(".mdx") && this.plugin.settings.enableMdxSupport)) {
      return;
    }
    const now = Date.now();
    if (now - this.lastDropTime < this.DROP_DEBOUNCE_MS && this.lastDropData === actualFilePath) {
      return;
    }
    this.lastDropTime = now;
    this.lastDropData = actualFilePath;
    const file = this.plugin.app.vault.getAbstractFileByPath(actualFilePath);
    if (!file || !(file instanceof import_obsidian7.TFile)) {
      return;
    }
    (() => {
      if (file.extension === "md") {
        const displayName = this.getDisplayNameSync(file);
        if (displayName !== null) {
          setTimeout(() => {
            const activeView2 = this.plugin.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
            if (activeView2 && activeView2.editor) {
              this.replaceLastInsertedLink(file, displayName, activeView2.editor);
            }
          }, 50);
        }
      } else if (file.extension === "mdx" && this.plugin.settings.enableMdxSupport) {
        void (async () => {
          const displayName = await this.getDisplayName(file);
          if (displayName !== null) {
            let attempts = 0;
            const maxAttempts = 5;
            const attemptReplace = () => {
              attempts++;
              const activeView2 = this.plugin.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
              if (activeView2 && activeView2.editor) {
                const replaced = this.replaceLastInsertedLink(file, displayName, activeView2.editor);
                if (!replaced && attempts < maxAttempts) {
                  setTimeout(attemptReplace, 50 * attempts);
                }
              } else if (attempts < maxAttempts) {
                setTimeout(attemptReplace, 50 * attempts);
              }
            };
            setTimeout(attemptReplace, 150);
          }
        })();
      }
    })();
  }
  /**
   * Synchronous version for .md files (fast, immediate)
   */
  getDisplayNameSync(file) {
    if (file.extension !== "md") {
      return null;
    }
    const frontmatter = getFrontmatterSync(this.plugin.app, file, this.plugin.settings);
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        return propertyValue;
      }
    }
    return null;
  }
  /**
   * Async version for .mdx files (needs file reading)
   */
  async getDisplayName(file) {
    const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
    if (!isFileTypeSupported2(file.extension, this.plugin.settings)) {
      return null;
    }
    const frontmatter = await getFrontmatter2(this.plugin.app, file, this.plugin.settings);
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        return propertyValue;
      }
    }
    return null;
  }
  replaceLastInsertedLink(file, displayName, editor) {
    var _a, _b;
    const content = editor.getValue();
    const cursor = editor.getCursor();
    const lines = content.split("\n");
    const currentLine = lines[cursor.line];
    const wikiLinkRegex = /\[\[([^\]]+)\]\]/g;
    const markdownLinkRegex = /\[([^\]]*)\]\(([^)]+)\)/g;
    let match;
    let lastMatch = null;
    while ((match = wikiLinkRegex.exec(currentLine)) !== null) {
      lastMatch = match;
    }
    if (lastMatch) {
      const linkPath = lastMatch[1];
      const filePathWithoutExt = file.path.replace(/\.(md|mdx)$/, "");
      const linkPathWithoutExt = linkPath.replace(/\.(md|mdx)$/, "");
      if (filePathWithoutExt === linkPathWithoutExt || file.path === linkPath || file.path.replace(/\.mdx$/, ".md") === linkPath) {
        const newLinkText = `[[${linkPath}|${displayName}]]`;
        const startPos = { line: cursor.line, ch: lastMatch.index };
        const endPos = { line: cursor.line, ch: lastMatch.index + lastMatch[0].length };
        editor.replaceRange(newLinkText, startPos, endPos);
        return true;
      }
    }
    markdownLinkRegex.lastIndex = 0;
    lastMatch = null;
    while ((match = markdownLinkRegex.exec(currentLine)) !== null) {
      lastMatch = match;
    }
    if (lastMatch) {
      const linkUrl = lastMatch[2];
      const linkUrlDecoded = decodeURIComponent(linkUrl);
      const filePathEncoded = encodeURI(file.path);
      const filePathWithoutExt = file.path.replace(/\.(md|mdx)$/, "");
      const linkUrlWithoutExt = linkUrlDecoded.replace(/\.(md|mdx)$/, "");
      const matches = file.path === linkUrlDecoded || filePathEncoded === linkUrl || filePathWithoutExt === linkUrlWithoutExt || file.path.replace(/\.mdx$/, ".md") === linkUrlDecoded || file.path.replace(/\.md$/, ".mdx") === linkUrlDecoded || // Handle relative paths - check if link URL matches file basename
      file.basename === linkUrlDecoded.replace(/\.(md|mdx)$/, "") || file.basename + ".mdx" === linkUrlDecoded || file.basename + ".md" === linkUrlDecoded || // Handle paths with directory
      file.path.endsWith(linkUrlDecoded) || linkUrlDecoded.endsWith(file.path);
      if (matches) {
        const newLinkText = `[${displayName}](${linkUrl})`;
        const startPos = { line: cursor.line, ch: lastMatch.index };
        const endPos = { line: cursor.line, ch: lastMatch.index + lastMatch[0].length };
        editor.replaceRange(newLinkText, startPos, endPos);
        return true;
      }
    } else {
      const searchRange = 3;
      for (let i = Math.max(0, cursor.line - searchRange); i <= Math.min(lines.length - 1, cursor.line + searchRange); i++) {
        const line = lines[i];
        const wikiMatches = [...line.matchAll(/\[\[([^\]]+)\]\]/g)];
        const markdownMatches = [...line.matchAll(/\[([^\]]*)\]\(([^)]+)\)/g)];
        for (const wikiMatch of wikiMatches) {
          const linkPath = wikiMatch[1];
          const filePathWithoutExt = file.path.replace(/\.(md|mdx)$/, "");
          const linkPathWithoutExt = linkPath.replace(/\.(md|mdx)$/, "");
          if (filePathWithoutExt === linkPathWithoutExt || file.path === linkPath || file.path.replace(/\.mdx$/, ".md") === linkPath) {
            const newLinkText = `[[${linkPath}|${displayName}]]`;
            const matchIndex = (_a = wikiMatch.index) != null ? _a : 0;
            const startPos = { line: i, ch: matchIndex };
            const endPos = { line: i, ch: matchIndex + wikiMatch[0].length };
            editor.replaceRange(newLinkText, startPos, endPos);
            return true;
          }
        }
        for (const mdMatch of markdownMatches) {
          const linkUrl = mdMatch[2];
          const linkUrlDecoded = decodeURIComponent(linkUrl);
          const filePathWithoutExt = file.path.replace(/\.(md|mdx)$/, "");
          const linkUrlWithoutExt = linkUrlDecoded.replace(/\.(md|mdx)$/, "");
          const matches = file.path === linkUrlDecoded || encodeURI(file.path) === linkUrl || file.path.replace(/\.mdx$/, ".md") === linkUrlDecoded || file.path.replace(/\.md$/, ".mdx") === linkUrlDecoded || filePathWithoutExt === linkUrlWithoutExt || // Handle relative paths - check if link URL matches file basename
          file.basename === linkUrlDecoded.replace(/\.(md|mdx)$/, "") || file.basename + ".mdx" === linkUrlDecoded || file.basename + ".md" === linkUrlDecoded || // Handle paths with directory
          file.path.endsWith(linkUrlDecoded) || linkUrlDecoded.endsWith(file.path);
          if (matches) {
            const newLinkText = `[${displayName}](${linkUrl})`;
            const matchIndex = (_b = mdMatch.index) != null ? _b : 0;
            const startPos = { line: i, ch: matchIndex };
            const endPos = { line: i, ch: matchIndex + mdMatch[0].length };
            editor.replaceRange(newLinkText, startPos, endPos);
            return true;
          }
        }
      }
    }
    return false;
  }
};

// src/services/CacheService.ts
var CacheService = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  setSuggest(suggest) {
    this.suggest = suggest;
  }
  invalidateCache(file) {
    if (this.suggest) {
      void this.suggest.updateFileCache(file);
    }
  }
  rebuildCache() {
    if (this.suggest) {
      void this.suggest.buildFileCache();
    }
  }
};

// src/services/GraphViewService.ts
var import_obsidian8 = require("obsidian");

// src/utils/frontmatter-cache.ts
init_frontmatter();
var FrontmatterCache = class {
  constructor() {
    this.cache = /* @__PURE__ */ new Map();
    this.pending = /* @__PURE__ */ new Map();
  }
  async get(app, file, settings) {
    var _a;
    const key = file.path;
    if (this.cache.has(key)) {
      return (_a = this.cache.get(key)) != null ? _a : null;
    }
    if (this.pending.has(key)) {
      return await this.pending.get(key);
    }
    const promise = getFrontmatter(app, file, settings);
    this.pending.set(key, promise);
    try {
      const result = await promise;
      this.cache.set(key, result);
      return result;
    } finally {
      this.pending.delete(key);
    }
  }
  getSync(key) {
    return this.cache.get(key);
  }
  invalidate(key) {
    this.cache.delete(key);
    this.pending.delete(key);
  }
  clear() {
    this.cache.clear();
    this.pending.clear();
  }
};
var frontmatterCache = new FrontmatterCache();

// src/services/GraphViewService.ts
var graphDisplaySettings = null;
function createGetDisplayText(app) {
  return function getDisplayText() {
    if (!(graphDisplaySettings == null ? void 0 : graphDisplaySettings.enableForGraphView)) {
      if (this.pov_originalGetDisplayText) {
        return this.pov_originalGetDisplayText();
      }
      throw new Error("pov_originalGetDisplayText does not exist on node");
    }
    const file = app.vault.getFileByPath(this.id);
    if (file) {
      if (file.extension === "md" || file.extension === "mdx" && graphDisplaySettings.enableMdxSupport) {
        if (file.extension === "md") {
          const fileCache = app.metadataCache.getFileCache(file);
          const mdFrontmatter = fileCache == null ? void 0 : fileCache.frontmatter;
          if (mdFrontmatter && mdFrontmatter[graphDisplaySettings.propertyKey] !== void 0 && mdFrontmatter[graphDisplaySettings.propertyKey] !== null) {
            const propertyValue = String(mdFrontmatter[graphDisplaySettings.propertyKey]).trim();
            if (propertyValue !== "") {
              return propertyValue;
            }
          }
        } else if (file.extension === "mdx") {
          const cached = frontmatterCache.getSync(file.path);
          if (cached !== void 0) {
            if (cached && cached[graphDisplaySettings.propertyKey] !== void 0 && cached[graphDisplaySettings.propertyKey] !== null) {
              const propertyValue = String(cached[graphDisplaySettings.propertyKey]).trim();
              if (propertyValue !== "") {
                return propertyValue;
              }
            }
          } else {
            void frontmatterCache.get(app, file, { enableMdxSupport: graphDisplaySettings.enableMdxSupport, propertyKey: graphDisplaySettings.propertyKey });
          }
        }
      }
    }
    if (this.pov_originalGetDisplayText) {
      return this.pov_originalGetDisplayText();
    }
    throw new Error("pov_originalGetDisplayText does not exist on node");
  };
}
var GraphViewService = class {
  constructor(plugin) {
    this.modifiedPrototypes = [];
    this.observer = null;
    this.timer = null;
    this.plugin = plugin;
    graphDisplaySettings = {
      enableForGraphView: plugin.settings.enableForGraphView,
      propertyKey: plugin.settings.propertyKey,
      enableMdxSupport: plugin.settings.enableMdxSupport,
      app: plugin.app
    };
  }
  getGraphLeaves() {
    const leaves = [];
    leaves.push(...this.plugin.app.workspace.getLeavesOfType("graph"));
    leaves.push(...this.plugin.app.workspace.getLeavesOfType("localgraph"));
    return [...new Set(leaves)];
  }
  async overridePrototypes() {
    const leaves = this.getGraphLeaves();
    for (const leaf of leaves) {
      if (!(leaf.view instanceof import_obsidian8.View) || leaf.isDeferred) continue;
      const view = leaf.view;
      await this.overridePrototype(view);
    }
  }
  async overridePrototype(view) {
    let nodeCount = 0;
    for (const graphNode of view.renderer.nodes) {
      nodeCount++;
    }
    if (nodeCount === 0) {
      setTimeout(() => {
        void this.overridePrototype(view);
      }, 1e3);
      return;
    }
    if (graphDisplaySettings == null ? void 0 : graphDisplaySettings.enableMdxSupport) {
      const mdxPromises = [];
      for (const graphNode of view.renderer.nodes) {
        const file = graphDisplaySettings.app.vault.getFileByPath(graphNode.id);
        if (file && file.extension === "mdx") {
          const promise = frontmatterCache.get(graphDisplaySettings.app, file, { enableMdxSupport: graphDisplaySettings.enableMdxSupport, propertyKey: graphDisplaySettings.propertyKey });
          mdxPromises.push(promise.then(() => {
          }));
        }
      }
      if (mdxPromises.length > 0) {
        await Promise.all(mdxPromises);
      }
    }
    const node = view.renderer.nodes.first();
    if (node) {
      const proto = node.constructor.prototype;
      if (!proto.hasOwnProperty("pov_originalGetDisplayText") && !this.modifiedPrototypes.contains(proto)) {
        proto.pov_originalGetDisplayText = proto.getDisplayText;
        proto.getDisplayText = createGetDisplayText(this.plugin.app);
        let updatedCount = 0;
        for (const node2 of view.renderer.nodes) {
          if (node2.text) {
            node2.text.text = node2.getDisplayText();
            updatedCount++;
          }
        }
        view.renderer.changed();
        this.modifiedPrototypes.push(proto);
      }
    }
  }
  restorePrototypes() {
    for (const proto of this.modifiedPrototypes) {
      if (typeof proto.pov_originalGetDisplayText === "function") {
        proto.getDisplayText = proto.pov_originalGetDisplayText;
        delete proto.pov_originalGetDisplayText;
      }
    }
    this.modifiedPrototypes = [];
    this.rewriteNames();
  }
  rewriteNames() {
    const leaves = this.getGraphLeaves();
    for (const leaf of leaves) {
      if (!(leaf.view instanceof import_obsidian8.View) || leaf.isDeferred) continue;
      const view = leaf.view;
      for (const node of view.renderer.nodes) {
        if (node.text) node.text.text = node.getDisplayText();
      }
      view.renderer.changed();
    }
  }
  onLayoutChange() {
    var _a;
    this.cleanupObserver();
    if (!this.plugin.settings.enableForGraphView) {
      this.restorePrototypes();
      return;
    }
    const appInternal = this.plugin.app;
    const isGraphLoaded = (_a = appInternal.internalPlugins.getPluginById("graph")) == null ? void 0 : _a._loaded;
    if (!isGraphLoaded) return;
    this.setupObserver();
    void this.overridePrototypes();
  }
  setupObserver() {
    const leaves = this.getGraphLeaves();
    for (const leaf of leaves) {
      const container = leaf.view.containerEl;
      if (!container) continue;
      if (!this.observer) {
        this.observer = new MutationObserver(() => {
          if (this.timer) window.clearTimeout(this.timer);
          this.timer = window.setTimeout(() => {
            void this.overridePrototypes();
          }, 500);
        });
      }
      this.observer.observe(container, {
        childList: true,
        subtree: true
      });
    }
  }
  cleanupObserver() {
    if (this.observer) {
      this.observer.disconnect();
      this.observer = null;
    }
    if (this.timer) {
      window.clearTimeout(this.timer);
      this.timer = null;
    }
  }
  updateGraphView() {
    if (graphDisplaySettings) {
      graphDisplaySettings.enableForGraphView = this.plugin.settings.enableForGraphView;
      graphDisplaySettings.propertyKey = this.plugin.settings.propertyKey;
      graphDisplaySettings.enableMdxSupport = this.plugin.settings.enableMdxSupport;
    }
    if (this.plugin.settings.enableForGraphView) {
      void this.overridePrototypes();
    } else {
      this.restorePrototypes();
    }
  }
  refreshGraphView() {
    if (this.plugin.settings.enableForGraphView) {
      this.rewriteNames();
    }
  }
  onunload() {
    this.cleanupObserver();
    this.restorePrototypes();
  }
};

// src/services/BacklinkService.ts
var import_obsidian9 = require("obsidian");
var BacklinkService = class {
  constructor(plugin) {
    this.processedElements = /* @__PURE__ */ new WeakSet();
    this.modifiedElements = /* @__PURE__ */ new WeakSet();
    this.originalTextContentDescriptors = /* @__PURE__ */ new Map();
    this.plugin = plugin;
  }
  /**
   * Get display name from file's frontmatter property
   */
  async getDisplayName(file) {
    if (!this.plugin.settings.enableForBacklinks) {
      return null;
    }
    const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
    if (!isFileTypeSupported2(file.extension, this.plugin.settings)) {
      return null;
    }
    const frontmatter = await getFrontmatter2(this.plugin.app, file, this.plugin.settings);
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        return propertyValue;
      }
    }
    return null;
  }
  /**
   * Update all backlink displays
   */
  updateBacklinks() {
    if (!this.plugin.settings.enableForBacklinks) {
      this.stopObserving();
      return;
    }
    this.updateEmbeddedBacklinks();
    void this.updateDedicatedBacklinksPanel();
    this.startObserving();
  }
  /**
   * Update embedded backlinks in markdown views
   */
  updateEmbeddedBacklinks() {
    for (const leaf of this.plugin.app.workspace.getLeavesOfType("markdown")) {
      if (!(leaf.view instanceof import_obsidian9.MarkdownView)) {
        continue;
      }
      const embeddedBacklinks = leaf.view.containerEl.querySelector(".embedded-backlinks");
      if (embeddedBacklinks) {
        this.updateBacklinkContainer(embeddedBacklinks);
      }
    }
  }
  /**
   * Update dedicated backlinks panel
   */
  async updateDedicatedBacklinksPanel() {
    const backlinksLeaves = this.plugin.app.workspace.getLeavesOfType("backlink");
    for (const leaf of backlinksLeaves) {
      await leaf.loadIfDeferred();
      if (leaf.view) {
        const container = leaf.view.containerEl;
        if (container) {
          const backlinksContainer = container.querySelector(".backlinks-pane") || container.querySelector(".backlink-pane");
          if (backlinksContainer) {
            this.updateBacklinkContainer(backlinksContainer);
          }
          const outgoingLinksContainer = container.querySelector(".outgoing-link-pane") || container.querySelector(".outgoing-links");
          if (outgoingLinksContainer) {
            this.updateBacklinkContainer(outgoingLinksContainer);
          }
        }
      }
    }
  }
  /**
   * Extract file path from an element or its parent link
   */
  extractFilePathFromElement(element) {
    var _a;
    const dataPath = element.getAttribute("data-path");
    if (dataPath) {
      const file = this.plugin.app.vault.getAbstractFileByPath(dataPath);
      if (file instanceof import_obsidian9.TFile) {
        return file;
      }
    }
    const link = element.closest("a") || element.querySelector("a");
    if (link) {
      const href = link instanceof HTMLAnchorElement ? link.href : link.getAttribute("href");
      if (href) {
        if (href.startsWith("obsidian://")) {
          try {
            const url = new URL(href);
            const fileParam = url.searchParams.get("file");
            if (fileParam) {
              const decodedPath = decodeURIComponent(fileParam);
              const file = this.plugin.app.vault.getAbstractFileByPath(decodedPath + ".md");
              if (file instanceof import_obsidian9.TFile) {
                return file;
              }
            }
          } catch (e) {
          }
        }
        const internalLinkMatch = href.match(/#file\/(.+)/);
        if (internalLinkMatch) {
          const filePath = decodeURIComponent(internalLinkMatch[1]);
          const file = this.plugin.app.vault.getAbstractFileByPath(filePath);
          if (file instanceof import_obsidian9.TFile) {
            return file;
          }
        }
        const dataHref = link.getAttribute("data-href");
        if (dataHref) {
          const file = this.plugin.app.vault.getAbstractFileByPath(dataHref);
          if (file instanceof import_obsidian9.TFile) {
            return file;
          }
        }
      }
    }
    const textContent = (_a = element.textContent) == null ? void 0 : _a.trim();
    if (textContent) {
      const allFiles = this.plugin.app.vault.getMarkdownFiles();
      const matchingFile = allFiles.find((f) => f.basename === textContent);
      if (matchingFile) {
        return matchingFile;
      }
    }
    return null;
  }
  /**
   * Update a backlink container by replacing file names with property titles
   */
  updateBacklinkContainer(container) {
    const selectors = [
      ".tree-item-inner",
      ".backlink-title",
      ".backlink-file-link",
      ".outgoing-link-file-link",
      ".tree-item-self",
      ".nav-file-title",
      "[data-path]",
      "a.internal-link"
    ];
    const fileElements = /* @__PURE__ */ new Set();
    selectors.forEach((selector) => {
      try {
        container.querySelectorAll(selector).forEach((el) => {
          fileElements.add(el);
        });
      } catch (e) {
      }
    });
    fileElements.forEach((element) => {
      if (this.processedElements.has(element)) {
        return;
      }
      const file = this.extractFilePathFromElement(element);
      if (file && file instanceof import_obsidian9.TFile) {
        this.updateElementWithFile(element, file);
      }
    });
  }
  /**
   * Update an element with file's display name
   */
  updateElementWithFile(element, file) {
    void (async () => {
      var _a;
      const displayName = await this.getDisplayName(file);
      if (displayName === null) {
        return;
      }
      this.processedElements.add(element);
      element.setAttribute("data-pov-processed", "true");
      const currentText = ((_a = element.textContent) == null ? void 0 : _a.trim()) || "";
      const basename = file.basename;
      if (currentText === basename || currentText === file.name || currentText.endsWith(basename)) {
        const link = element.closest("a") || element.querySelector("a");
        const targetElement = link || element;
        const updateTextInElement = (el) => {
          var _a2, _b;
          if (el.childNodes.length === 1 && el.childNodes[0].nodeType === Node.TEXT_NODE) {
            el.textContent = displayName;
            return true;
          }
          const textNodes = Array.from(el.childNodes).filter((node) => node.nodeType === Node.TEXT_NODE);
          if (textNodes.length > 0) {
            textNodes[0].textContent = displayName;
            for (let i = 1; i < textNodes.length; i++) {
              textNodes[i].remove();
            }
            return true;
          }
          if (((_a2 = el.textContent) == null ? void 0 : _a2.trim()) === basename || ((_b = el.textContent) == null ? void 0 : _b.trim()) === file.name) {
            el.textContent = displayName;
            return true;
          }
          return false;
        };
        if (!updateTextInElement(targetElement)) {
          updateTextInElement(element);
        }
      }
    })();
  }
  /**
   * Start observing DOM changes for backlinks
   */
  startObserving() {
    if (this.observer) {
      return;
    }
    this.overrideBacklinkElements();
    let updateTimeout = null;
    this.observer = new MutationObserver((mutations) => {
      let shouldUpdate = false;
      const newElements = [];
      for (const mutation of mutations) {
        if (mutation.type === "childList") {
          for (const node of Array.from(mutation.addedNodes)) {
            if (node instanceof HTMLElement) {
              const embeddedBacklinks = node.closest(".embedded-backlinks");
              const backlinksPanel = node.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
              if (embeddedBacklinks || backlinksPanel) {
                shouldUpdate = true;
                const selectors = [".tree-item-inner", ".backlink-title", ".backlink-file-link", ".outgoing-link-file-link", ".tree-item-self", ".nav-file-title", "[data-path]", "a.internal-link"];
                selectors.forEach((selector) => {
                  var _a;
                  try {
                    const elements = (_a = node.querySelectorAll) == null ? void 0 : _a.call(node, selector);
                    elements == null ? void 0 : elements.forEach((el) => {
                      if (el instanceof HTMLElement) {
                        newElements.push(el);
                      }
                    });
                  } catch (e) {
                  }
                });
              }
            }
          }
        } else if (mutation.type === "characterData") {
          const target = mutation.target;
          if (target instanceof HTMLElement) {
            const embeddedBacklinks = target.closest(".embedded-backlinks");
            const backlinksPanel = target.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
            if (embeddedBacklinks || backlinksPanel) {
              shouldUpdate = true;
            }
          } else if (target.parentElement) {
            const embeddedBacklinks = target.parentElement.closest(".embedded-backlinks");
            const backlinksPanel = target.parentElement.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
            if (embeddedBacklinks || backlinksPanel) {
              shouldUpdate = true;
            }
          }
        }
      }
      newElements.forEach((el) => {
        this.overrideElementTextContent(el);
        const file = this.extractFilePathFromElement(el);
        if (file && file instanceof import_obsidian9.TFile) {
          void (async () => {
            var _a;
            const displayName = await this.getDisplayName(file);
            if (displayName) {
              const currentText = ((_a = el.textContent) == null ? void 0 : _a.trim()) || "";
              if (currentText === file.basename || currentText === file.name) {
                el.textContent = displayName;
                el.setAttribute("data-pov-processed", "true");
                this.processedElements.add(el);
              }
            }
          })();
        }
      });
      if (shouldUpdate) {
        this.processedElements = /* @__PURE__ */ new WeakSet();
        if (updateTimeout) {
          clearTimeout(updateTimeout);
        }
        updateTimeout = setTimeout(() => {
          this.updateBacklinks();
          this.overrideBacklinkElements();
          updateTimeout = null;
        }, 10);
      }
    });
    this.observer.observe(document.body, {
      childList: true,
      subtree: true,
      characterData: true
    });
  }
  /**
   * Override textContent on all backlink elements
   */
  overrideBacklinkElements() {
    const selectors = [
      ".tree-item-inner",
      ".backlink-title",
      ".backlink-file-link",
      ".outgoing-link-file-link",
      ".tree-item-self",
      ".nav-file-title",
      "[data-path]",
      "a.internal-link"
    ];
    const containers = [
      ...Array.from(document.querySelectorAll(".embedded-backlinks")),
      ...Array.from(document.querySelectorAll(".backlinks-pane")),
      ...Array.from(document.querySelectorAll(".backlink-pane")),
      ...Array.from(document.querySelectorAll(".outgoing-link-pane")),
      ...Array.from(document.querySelectorAll(".outgoing-links")),
      ...Array.from(document.querySelectorAll(".backlink-container"))
    ];
    containers.forEach((container) => {
      selectors.forEach((selector) => {
        try {
          container.querySelectorAll(selector).forEach((el) => {
            if (el instanceof HTMLElement) {
              this.overrideElementTextContent(el);
            }
          });
        } catch (e) {
        }
      });
    });
  }
  /**
   * Override textContent setter on an element to intercept Obsidian's updates
   */
  overrideElementTextContent(element) {
    if (this.modifiedElements.has(element)) {
      return;
    }
    const proto = Object.getPrototypeOf(element);
    const originalDescriptor = Object.getOwnPropertyDescriptor(proto, "textContent");
    if (originalDescriptor && originalDescriptor.set) {
      this.originalTextContentDescriptors.set(element, originalDescriptor);
      try {
        Object.defineProperty(element, "textContent", {
          set: (value) => {
            const file = this.extractFilePathFromElement(element);
            if (file && file instanceof import_obsidian9.TFile) {
              void (async () => {
                const displayName = await this.getDisplayName(file);
                if (displayName && (value === file.basename || value === file.name || value.endsWith(file.basename))) {
                  originalDescriptor.set.call(element, displayName);
                  element.setAttribute("data-pov-processed", "true");
                  this.processedElements.add(element);
                  return;
                }
                originalDescriptor.set.call(element, value);
              })();
              return;
            }
            originalDescriptor.set.call(element, value);
            element.setAttribute("data-pov-processed", "true");
          },
          // eslint-disable-next-line @typescript-eslint/unbound-method -- accessing property descriptor original setter
          get: originalDescriptor.get || (() => {
            var _a, _b;
            return ((_b = (_a = Object.getOwnPropertyDescriptor(HTMLElement.prototype, "textContent")) == null ? void 0 : _a.get) == null ? void 0 : _b.call(element)) || "";
          }),
          configurable: true,
          enumerable: true
        });
      } catch (e) {
        element.setAttribute("data-pov-processed", "true");
      }
    } else {
      element.setAttribute("data-pov-processed", "true");
    }
    this.modifiedElements.add(element);
  }
  /**
   * Stop observing DOM changes
   */
  stopObserving() {
    if (this.observer) {
      this.observer.disconnect();
      this.observer = void 0;
    }
  }
  /**
   * Handle layout changes
   */
  onLayoutChange() {
    if (this.plugin.settings.enableForBacklinks) {
      setTimeout(() => {
        this.updateBacklinks();
      }, 100);
    } else {
      this.stopObserving();
    }
  }
  /**
   * Handle file open events
   */
  onFileOpen() {
    if (this.plugin.settings.enableForBacklinks) {
      setTimeout(() => {
        this.updateEmbeddedBacklinks();
      }, 200);
    }
  }
  /**
   * Clean up on unload
   */
  onunload() {
    this.stopObserving();
    this.originalTextContentDescriptors.forEach((descriptor, element) => {
      try {
        Object.defineProperty(element, "textContent", descriptor);
      } catch (e) {
      }
    });
    this.originalTextContentDescriptors.clear();
    this.modifiedElements = /* @__PURE__ */ new WeakSet();
  }
};

// src/services/TabService.ts
init_frontmatter();
var TabService = class {
  constructor(plugin) {
    this.leafEventRefs = /* @__PURE__ */ new Map();
    this.plugin = plugin;
  }
  /**
   * Renames all markdown tabs to use the configured property value
   * Falls back to file basename if property is not found
   * EXACT copy of the working implementation from obsidian-title-only-tab
   */
  renameTabs() {
    const leaves = this.plugin.app.workspace.getLeavesOfType("markdown");
    leaves.forEach((leaf) => {
      var _a;
      const view = leaf.view;
      const state = leaf.getViewState();
      if (((_a = state.state) == null ? void 0 : _a.file) && !(view == null ? void 0 : view.file)) {
        void leaf.setViewState({ type: state.type, state: state.state });
      }
      if (view == null ? void 0 : view.file) {
        const file = view.file;
        void (async () => {
          const frontmatter = await getFrontmatter(this.plugin.app, file, this.plugin.settings);
          const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
          const tabHeaderEl = leaf.tabHeaderEl;
          if (tabHeaderEl) {
            tabHeaderEl.setAttribute("data-pov-title-set", "true");
            if (this.plugin.settings.enableForTabs) {
              const titleEl = tabHeaderEl.querySelector(".workspace-tab-header-inner-title");
              const displayText = propertyValue ? String(propertyValue) : file.basename;
              if (titleEl) {
                titleEl.setText(displayText);
              }
              tabHeaderEl.setAttribute("aria-label", displayText);
              tabHeaderEl.setAttribute("title", displayText);
            }
          }
        })();
      }
    });
  }
  /**
   * Register pinned-change event listeners on all markdown leaves
   * This ensures tab titles are re-applied when tabs are pinned/unpinned
   */
  registerLeafListeners() {
    const currentLeaves = this.plugin.app.workspace.getLeavesOfType("markdown");
    const currentLeafSet = new Set(currentLeaves);
    currentLeaves.forEach((leaf) => {
      if (!this.leafEventRefs.has(leaf)) {
        const eventRef = leaf.on("pinned-change", () => {
          requestAnimationFrame(() => {
            setTimeout(() => {
              void this.renameTabs();
            }, 50);
          });
        });
        this.leafEventRefs.set(leaf, eventRef);
      }
    });
    for (const [leaf, eventRef] of this.leafEventRefs.entries()) {
      if (!currentLeafSet.has(leaf)) {
        leaf.offref(eventRef);
        this.leafEventRefs.delete(leaf);
      }
    }
  }
  /**
   * Register event listeners for tab renaming
   * EXACT copy of the working implementation from obsidian-title-only-tab
   */
  registerEvents() {
    this.renameTabs();
    this.registerLeafListeners();
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("layout-change", () => {
        void this.renameTabs();
        this.registerLeafListeners();
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("active-leaf-change", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("file-open", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.vault.on("rename", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => this.renameTabs())
    );
  }
  /**
   * Update tabs (public method for manual updates)
   */
  updateTabs() {
    void this.renameTabs();
  }
  /**
   * Cleanup on unload
   */
  onunload() {
    for (const [leaf, eventRef] of this.leafEventRefs.entries()) {
      leaf.offref(eventRef);
    }
    this.leafEventRefs.clear();
  }
};

// src/services/ExplorerService.ts
var import_obsidian10 = require("obsidian");
var ExplorerService = class {
  constructor(plugin) {
    // Public so ExplorerFileItemMutator can access it
    this.explorerView = null;
    this.modified = /* @__PURE__ */ new WeakMap();
    this.plugin = plugin;
  }
  /**
   * Get the file explorer view
   */
  getExplorerView() {
    if (this.explorerView === null) {
      const leaves = this.plugin.app.workspace.getLeavesOfType("file-explorer");
      if (leaves.length === 0) {
        return null;
      }
      const leaf = leaves[0];
      if (leaf && leaf.view) {
        this.explorerView = leaf.view;
      }
    }
    return this.explorerView;
  }
  /**
   * Get folder note title for a folder
   * Returns the frontmatter title property from the folder note file if it exists
   */
  getFolderNoteTitle(folder) {
    var _a;
    if (!this.plugin.settings.folderNoteFilename || this.plugin.settings.folderNoteFilename.trim() === "") {
      return null;
    }
    const folderNoteFilename = this.plugin.settings.folderNoteFilename.trim();
    const folderNotePath = `${folder.path}/${folderNoteFilename}.md`;
    const folderNoteFile = this.plugin.app.vault.getAbstractFileByPath(folderNotePath);
    if (folderNoteFile instanceof import_obsidian10.TFile) {
      const cache = this.plugin.app.metadataCache.getFileCache(folderNoteFile);
      const propertyValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[this.plugin.settings.propertyKey];
      if (propertyValue) {
        return String(propertyValue);
      }
    }
    return null;
  }
  /**
   * Resolve title for a file or folder
   * Public so ExplorerFileItemMutator can access it
   */
  async resolveTitle(item) {
    if (item.file instanceof import_obsidian10.TFile) {
      const { getFrontmatter: getFrontmatter2, isFileTypeSupported: isFileTypeSupported2 } = await Promise.resolve().then(() => (init_frontmatter(), frontmatter_exports));
      if (!isFileTypeSupported2(item.file.extension, this.plugin.settings)) {
        return null;
      }
      const frontmatter = await getFrontmatter2(this.plugin.app, item.file, this.plugin.settings);
      const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
      return propertyValue ? String(propertyValue) : null;
    } else if (item.file instanceof import_obsidian10.TFolder) {
      return this.getFolderNoteTitle(item.file);
    }
    return null;
  }
  /**
   * Update all file explorer items
   */
  updateAllItems() {
    const view = this.getExplorerView();
    if (!view || !view.fileItems) {
      return;
    }
    const items = Object.values(view.fileItems);
    for (const item of items) {
      if (!this.modified.has(item)) {
        this.modified.set(item, new ExplorerFileItemMutator(item, this));
      }
      item.updateTitle();
    }
  }
  /**
   * Restore all original titles
   */
  restoreAllItems() {
    const view = this.getExplorerView();
    if (!view || !view.fileItems) {
      return;
    }
    const items = Object.values(view.fileItems);
    for (const item of items) {
      if (this.modified.has(item)) {
        const mutator = this.modified.get(item);
        mutator == null ? void 0 : mutator.destroy();
        this.modified.delete(item);
        item.updateTitle();
      }
    }
  }
  /**
   * Register events and initialize
   */
  registerEvents() {
    if (!this.plugin.settings.enableForExplorer) {
      return;
    }
    this.plugin.app.workspace.onLayoutReady(() => {
      this.explorerView = null;
      this.updateAllItems();
    });
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("layout-change", () => {
        this.explorerView = null;
        if (this.plugin.settings.enableForExplorer) {
          this.updateAllItems();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => {
        if (this.plugin.settings.enableForExplorer) {
          this.updateAllItems();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.vault.on("rename", () => {
        if (this.plugin.settings.enableForExplorer) {
          this.explorerView = null;
          setTimeout(() => this.updateAllItems(), 100);
        }
      })
    );
  }
  /**
   * Update explorer when settings change
   */
  updateExplorer() {
    if (this.plugin.settings.enableForExplorer) {
      this.explorerView = null;
      this.registerEvents();
      setTimeout(() => this.updateAllItems(), 100);
    } else {
      this.restoreAllItems();
    }
  }
  /**
   * Cleanup on unload
   */
  onunload() {
    this.restoreAllItems();
    this.explorerView = null;
  }
};
var ExplorerFileItemMutator = class {
  constructor(item, service) {
    this.item = item;
    this.service = service;
    const proto = Object.getPrototypeOf(item);
    this.originalUpdateTitle = proto.updateTitle.bind(item);
    this.originalStartRename = proto.startRename ? proto.startRename.bind(item) : void 0;
    item.updateTitle = this.updateTitle.bind(this);
    if (proto.startRename) {
      item.startRename = this.startRename.bind(this);
    }
  }
  updateTitle() {
    this.originalUpdateTitle();
    if (this.service.plugin.settings.enableForExplorer) {
      void (async () => {
        const title = await this.service.resolveTitle(this.item);
        if (title && title.length > 0) {
          this.item.innerEl.setText(title);
        }
      })();
    }
  }
  startRename() {
    var _a;
    this.item.innerEl.setText(this.item.getTitle());
    return (_a = this.originalStartRename) == null ? void 0 : _a.call(this);
  }
  destroy() {
    const proto = Object.getPrototypeOf(this.item);
    this.item.updateTitle = this.originalUpdateTitle;
    if (proto.startRename && this.originalStartRename) {
      this.item.startRename = this.originalStartRename;
    }
  }
};

// src/services/WindowFrameService.ts
var import_obsidian11 = require("obsidian");
init_frontmatter();
var WindowFrameService = class {
  constructor(plugin) {
    this.originalUpdateTitle = null;
    this.enabled = false;
    this.plugin = plugin;
  }
  /**
   * Get the title for the active file
   */
  getActiveFileTitle() {
    var _a;
    const activeFile = this.plugin.app.workspace.getActiveFile();
    if (activeFile instanceof import_obsidian11.TFile) {
      if (activeFile.extension === "md") {
        const fileCache = this.plugin.app.metadataCache.getFileCache(activeFile);
        const propertyValue = (_a = fileCache == null ? void 0 : fileCache.frontmatter) == null ? void 0 : _a[this.plugin.settings.propertyKey];
        if (propertyValue) {
          return String(propertyValue);
        }
        return activeFile.basename;
      }
      if (activeFile.extension === "mdx" && this.plugin.settings.enableMdxSupport) {
        void (async () => {
          const frontmatter = await getFrontmatter(this.plugin.app, activeFile, this.plugin.settings);
          const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
          if (propertyValue) {
            const app = this.plugin.app;
            if (typeof app.getAppTitle === "function") {
              document.title = app.getAppTitle(String(propertyValue));
            } else {
              const vaultName = this.plugin.app.vault.getName();
              document.title = `${String(propertyValue)} - ${vaultName}`;
            }
          }
        })();
        return activeFile.basename;
      }
      return activeFile.basename;
    }
    return "";
  }
  /**
   * Override updateTitle to use property-based title
   */
  updateTitle() {
    if (!this.enabled) {
      if (this.originalUpdateTitle) {
        this.originalUpdateTitle();
      }
      return;
    }
    const title = this.getActiveFileTitle();
    if (title) {
      const app = this.plugin.app;
      if (typeof app.getAppTitle === "function") {
        document.title = app.getAppTitle(title);
      } else {
        const vaultName = this.plugin.app.vault.getName();
        document.title = `${title} - ${vaultName}`;
      }
    } else {
      if (this.originalUpdateTitle) {
        this.originalUpdateTitle();
      }
    }
  }
  /**
   * Enable the window frame feature
   */
  enable() {
    if (this.enabled) {
      return;
    }
    const workspace = this.plugin.app.workspace;
    if (workspace.updateTitle) {
      this.originalUpdateTitle = workspace.updateTitle.bind(workspace);
      workspace.updateTitle = this.updateTitle.bind(this);
      this.updateTitle();
      this.enabled = true;
    }
  }
  /**
   * Disable the window frame feature
   */
  disable() {
    if (!this.enabled) {
      return;
    }
    const workspace = this.plugin.app.workspace;
    if (workspace.updateTitle && this.originalUpdateTitle) {
      workspace.updateTitle = this.originalUpdateTitle;
      workspace.updateTitle();
      this.originalUpdateTitle = null;
      this.enabled = false;
    }
  }
  /**
   * Register events for window frame updates
   */
  registerEvents() {
    if (!this.plugin.settings.enableForWindowFrame) {
      return;
    }
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("file-open", () => {
        if (this.enabled) {
          this.updateTitle();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => {
        if (this.enabled) {
          this.updateTitle();
        }
      })
    );
  }
  /**
   * Update window frame when settings change
   */
  updateWindowFrame() {
    if (this.plugin.settings.enableForWindowFrame) {
      this.enable();
      this.registerEvents();
    } else {
      this.disable();
    }
  }
  /**
   * Cleanup on unload
   */
  onunload() {
    this.disable();
  }
};

// src/services/BookmarkService.ts
var import_obsidian12 = require("obsidian");
init_frontmatter();
var BookmarkService = class {
  constructor(plugin) {
    this.isHooked = false;
    this.plugin = plugin;
  }
  /**
   * Update bookmarks hook based on settings
   */
  updateBookmarks() {
    if (this.plugin.settings.enableForBookmarks && !this.isHooked) {
      this.hookBookmarks();
    } else if (!this.plugin.settings.enableForBookmarks && this.isHooked) {
      this.unhookBookmarks();
    }
  }
  /**
   * Hook into bookmark functionality using DOM observation
   */
  hookBookmarks() {
    const existingModal = document.querySelector(".modal");
    if (existingModal instanceof HTMLElement) {
      this.handleModalAppearance(existingModal);
    }
    this.mutationObserver = new MutationObserver((mutations) => {
      for (const mutation of mutations) {
        mutation.addedNodes.forEach((node) => {
          if (node instanceof HTMLElement) {
            const modalEl = node.classList.contains("modal") ? node : node.querySelector(".modal");
            if (modalEl) {
              this.handleModalAppearance(modalEl);
            }
          }
        });
      }
    });
    this.mutationObserver.observe(document.body, {
      childList: true,
      subtree: true
    });
    this.isHooked = true;
  }
  /**
   * Handle when a modal appears
   */
  handleModalAppearance(modalEl) {
    let attempts = 0;
    const maxAttempts = 30;
    const tryIdentifyAndPopulate = async () => {
      var _a;
      const titleEl = modalEl.querySelector(".modal-title");
      const titleText = ((_a = titleEl == null ? void 0 : titleEl.textContent) == null ? void 0 : _a.toLowerCase()) || "";
      const isBookmarkModal = titleText.includes("bookmark") || modalEl.querySelector('input[placeholder*="bookmark"]') !== null || modalEl.querySelector('input[placeholder*="Bookmark"]') !== null;
      if (isBookmarkModal) {
        const settingItems = modalEl.querySelectorAll(".setting-item");
        let titleInput = null;
        let pathInput = null;
        settingItems.forEach((item) => {
          var _a2;
          const nameEl = item.querySelector(".setting-item-name");
          const nameText = ((_a2 = nameEl == null ? void 0 : nameEl.textContent) == null ? void 0 : _a2.toLowerCase().trim()) || "";
          if (nameText === "title") {
            titleInput = item.querySelector('input[type="text"]');
          } else if (nameText === "path") {
            pathInput = item.querySelector('input[type="text"]');
          }
        });
        if (!titleInput) {
          const allInputs = modalEl.querySelectorAll('input[type="text"]');
          if (allInputs.length >= 2) {
            pathInput = allInputs[0];
            titleInput = allInputs[1];
          }
        }
        if (titleInput) {
          let file = this.plugin.app.workspace.getActiveFile();
          if (pathInput && pathInput.value) {
            const path = pathInput.value;
            const abstractFile = this.plugin.app.vault.getAbstractFileByPath(path) || this.plugin.app.vault.getAbstractFileByPath(path + ".md") || this.plugin.app.vault.getAbstractFileByPath(path + ".mdx");
            if (abstractFile instanceof import_obsidian12.TFile) {
              file = abstractFile;
            }
          }
          if (file) {
            const frontmatter = await getFrontmatter(this.plugin.app, file, this.plugin.settings);
            const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
            if (propertyValue !== void 0 && propertyValue !== null) {
              let displayValue = "";
              if (typeof propertyValue === "string") {
                displayValue = propertyValue;
              } else if (typeof propertyValue === "number" || typeof propertyValue === "boolean") {
                displayValue = String(propertyValue);
              }
              if (displayValue && displayValue.trim() !== "") {
                const currentValue = titleInput.value;
                const isDefault = currentValue === "" || currentValue === file.basename || currentValue === file.name;
                if (isDefault) {
                  titleInput.value = displayValue;
                  titleInput.dispatchEvent(new Event("input", { bubbles: true }));
                  titleInput.select();
                  return true;
                }
              }
            }
          }
        }
      }
      attempts++;
      if (attempts < maxAttempts) {
        setTimeout(() => void tryIdentifyAndPopulate(), 50);
      }
      return false;
    };
    void tryIdentifyAndPopulate();
  }
  /**
   * Stop observing for bookmark modals
   */
  unhookBookmarks() {
    if (this.mutationObserver) {
      this.mutationObserver.disconnect();
      this.mutationObserver = void 0;
    }
    this.isHooked = false;
  }
  /**
   * Cleanup on unload
   */
  onunload() {
    this.unhookBookmarks();
  }
};

// src/main.ts
var PropertyOverFileNamePlugin = class extends import_obsidian13.Plugin {
  constructor(app, manifest) {
    super(app, manifest);
    try {
      this.registerExtensions(["mdx"], "markdown");
    } catch (error) {
      const errorMsg = error.message;
      if (!errorMsg.includes("existing file extension")) {
        console.error("[POV] Unexpected MDX registration error in constructor:", errorMsg);
      }
    }
  }
  async onload() {
    await this.loadSettings();
    if (this.settings.enableMdxSupport) {
      try {
        this.registerExtensions(["mdx"], "markdown");
      } catch (error) {
        const errorMsg = error.message;
        if (!errorMsg.includes("existing file extension")) {
          console.error("Unexpected MDX registration error:", errorMsg);
          this.settings.enableMdxSupport = false;
        }
      }
      const mdxFiles = this.app.vault.getFiles().filter((f) => f.extension === "mdx");
      for (const file of mdxFiles) {
        this.app.metadataCache.trigger("changed", file);
      }
    }
    this.quickSwitcherService = new QuickSwitcherService(this);
    this.dragDropService = new DragDropService(this);
    this.cacheService = new CacheService(this);
    this.graphViewService = new GraphViewService(this);
    this.backlinkService = new BacklinkService(this);
    this.tabService = new TabService(this);
    this.explorerService = new ExplorerService(this);
    this.windowFrameService = new WindowFrameService(this);
    this.bookmarkService = new BookmarkService(this);
    this.tabService.registerEvents();
    this.explorerService.registerEvents();
    this.windowFrameService.registerEvents();
    this.bookmarkService.updateBookmarks();
    if (this.settings.enableMdxSupport) {
      (() => {
        const mdxFiles = this.app.vault.getFiles().filter(
          (f) => f instanceof import_obsidian13.TFile && f.extension === "mdx"
        );
        for (const file of mdxFiles) {
          void frontmatterCache.get(this.app, file, this.settings);
        }
      })();
    }
    setTimeout(() => {
      this.updateLinkSuggester();
      this.updateQuickSwitcher();
      this.updateGraphView();
      this.updateBacklinks();
      this.updateTabs();
      this.updateExplorer();
      this.updateWindowFrame();
      this.updateBookmarks();
    }, 1e3);
    this.app.workspace.onLayoutReady(() => {
      this.graphViewService.onLayoutChange();
      this.backlinkService.onLayoutChange();
      void this.tabService.renameTabs();
      this.updateExplorer();
      this.updateWindowFrame();
      this.updateBookmarks();
      setTimeout(() => {
        this.graphViewService.refreshGraphView();
      }, 500);
    });
    this.registerEvent(
      this.app.workspace.on("layout-change", () => {
        this.graphViewService.onLayoutChange();
        this.backlinkService.onLayoutChange();
      })
    );
    this.registerEvent(
      this.app.workspace.on("file-open", () => {
        this.backlinkService.onFileOpen();
      })
    );
    this.registerEvent(
      this.app.vault.on("modify", (file) => {
        if (file instanceof import_obsidian13.TFile && (file.extension === "md" || file.extension === "mdx" && this.settings.enableMdxSupport)) {
          this.cacheService.invalidateCache(file);
          frontmatterCache.invalidate(file.path);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian13.TFile && (file.extension === "md" || file.extension === "mdx" && this.settings.enableMdxSupport)) {
          this.cacheService.invalidateCache(file);
          frontmatterCache.invalidate(file.path);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("delete", (file) => {
        if (file instanceof import_obsidian13.TFile && (file.extension === "md" || file.extension === "mdx" && this.settings.enableMdxSupport)) {
          this.cacheService.invalidateCache(file);
          frontmatterCache.invalidate(file.path);
        }
      })
    );
    this.registerEvent(
      this.app.metadataCache.on("changed", (file) => {
        if (file instanceof import_obsidian13.TFile && (file.extension === "md" || file.extension === "mdx" && this.settings.enableMdxSupport)) {
          this.cacheService.rebuildCache();
          if (this.settings.enableForGraphView) {
            this.graphViewService.refreshGraphView();
          }
          if (this.settings.enableForBacklinks) {
            this.backlinkService.updateBacklinks();
          }
          if (this.settings.enableForExplorer) {
            this.explorerService.updateExplorer();
          }
          if (this.settings.enableForWindowFrame) {
            this.windowFrameService.updateWindowFrame();
          }
          if (this.settings.enableForBookmarks) {
            this.updateBookmarks();
          }
        }
      })
    );
    this.registerEvent(
      this.app.metadataCache.on("resolved", () => {
        this.cacheService.rebuildCache();
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-drop", (event, editor) => {
        if (this.settings.enableForDragDrop) {
          this.dragDropService.handleDragDrop(event, editor);
        }
      })
    );
    this.registerDomEvent(document, "drop", (event) => {
      if (this.settings.enableForDragDrop) {
        this.dragDropService.handleDOMDrop(event);
      }
    });
    registerCommands(this);
    this.addSettingTab(new SettingTab(this.app, this));
  }
  updateLinkSuggester() {
    const editorSuggest = this.app.workspace.editorSuggest;
    if (!editorSuggest) return;
    if (this.suggest) {
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => s !== this.suggest);
      this.suggest = void 0;
    }
    if (this.settings.enableForLinking) {
      this.suggest = new LinkTitleSuggest(this);
      this.registerEditorSuggest(this.suggest);
      this.cacheService.setSuggest(this.suggest);
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => !s.constructor.name.includes("LinkSuggest"));
      editorSuggest.suggests.unshift(this.suggest);
    }
  }
  updateQuickSwitcher() {
    this.quickSwitcherService.updateQuickSwitcher();
  }
  updateGraphView() {
    this.graphViewService.updateGraphView();
  }
  updateBacklinks() {
    this.backlinkService.updateBacklinks();
  }
  updateTabs() {
    this.tabService.updateTabs();
  }
  updateExplorer() {
    this.explorerService.updateExplorer();
  }
  updateWindowFrame() {
    this.windowFrameService.updateWindowFrame();
  }
  updateBookmarks() {
    this.bookmarkService.updateBookmarks();
  }
  rebuildCache() {
    this.cacheService.rebuildCache();
  }
  onunload() {
    const editorSuggest = this.app.workspace.editorSuggest;
    if (editorSuggest && this.suggest) {
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => s !== this.suggest);
    }
    this.quickSwitcherService.restoreOriginalCommand();
    this.graphViewService.onunload();
    this.backlinkService.onunload();
    this.tabService.onunload();
    this.explorerService.onunload();
    this.windowFrameService.onunload();
    this.bookmarkService.onunload();
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData != null ? loadedData : {});
  }
  async saveSettings(prevQuickSwitcherState, prevTabState) {
    await this.saveData(this.settings);
    if (prevQuickSwitcherState !== void 0 && prevQuickSwitcherState !== this.settings.enableForQuickSwitcher) {
      this.updateQuickSwitcher();
    }
    if (prevTabState !== void 0 && prevTabState !== this.settings.enableForTabs) {
      void this.tabService.registerEvents();
      this.updateTabs();
    }
    this.updateGraphView();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL3V0aWxzL2Zyb250bWF0dGVyLnRzIiwgInNyYy91dGlscy9zZWFyY2gudHMiLCAic3JjL3VpL1F1aWNrU3dpdGNoTW9kYWwudHMiLCAic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91aS9MaW5rVGl0bGVTdWdnZXN0LnRzIiwgInNyYy91aS9TZXR0aW5nVGFiLnRzIiwgInNyYy91dGlscy9zZXR0aW5ncy1jb21wYXQudHMiLCAic3JjL2NvbW1hbmRzL2luZGV4LnRzIiwgInNyYy9zZXJ2aWNlcy9RdWlja1N3aXRjaGVyU2VydmljZS50cyIsICJzcmMvc2VydmljZXMvRHJhZ0Ryb3BTZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9DYWNoZVNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL0dyYXBoVmlld1NlcnZpY2UudHMiLCAic3JjL3V0aWxzL2Zyb250bWF0dGVyLWNhY2hlLnRzIiwgInNyYy9zZXJ2aWNlcy9CYWNrbGlua1NlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL1RhYlNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL0V4cGxvcmVyU2VydmljZS50cyIsICJzcmMvc2VydmljZXMvV2luZG93RnJhbWVTZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9Cb29rbWFya1NlcnZpY2UudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFRGaWxlLCBBcHAsIHBhcnNlWWFtbCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFBsdWdpblNldHRpbmdzIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEdldCBmcm9udG1hdHRlciBmcm9tIGEgZmlsZSwgc3VwcG9ydGluZyBib3RoIC5tZCAodmlhIG1ldGFkYXRhIGNhY2hlKSBhbmQgLm1keCAodmlhIG1hbnVhbCBwYXJzaW5nKVxuICogXG4gKiBUaGlzIHV0aWxpdHkgZnVuY3Rpb24gaGFuZGxlcyB0aGUgZmFjdCB0aGF0IE9ic2lkaWFuJ3MgbWV0YWRhdGFDYWNoZSBvbmx5IHdvcmtzIGZvciAubWQgZmlsZXMuXG4gKiBGb3IgLm1keCBmaWxlcyAod2hlbiBNRFggc3VwcG9ydCBpcyBlbmFibGVkKSwgd2UgcmVhZCB0aGUgcmF3IGZpbGUgY29udGVudCBhbmQgcGFyc2UgdGhlIGZyb250bWF0dGVyIG1hbnVhbGx5LlxuICogXG4gKiBAcGFyYW0gYXBwIC0gT2JzaWRpYW4gYXBwIGluc3RhbmNlXG4gKiBAcGFyYW0gZmlsZSAtIFRoZSBmaWxlIHRvIGdldCBmcm9udG1hdHRlciBmcm9tXG4gKiBAcGFyYW0gc2V0dGluZ3MgLSBQbHVnaW4gc2V0dGluZ3MgKHRvIGNoZWNrIGVuYWJsZU1keFN1cHBvcnQpXG4gKiBAcmV0dXJucyBUaGUgZnJvbnRtYXR0ZXIgb2JqZWN0LCBvciBudWxsIGlmIG5vdCBmb3VuZC9ub3Qgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRGcm9udG1hdHRlcihcbiAgYXBwOiBBcHAsXG4gIGZpbGU6IFRGaWxlLFxuICBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3Ncbik6IFByb21pc2U8UmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCBudWxsPiB7XG4gIC8vIEZvciAubWQgZmlsZXMsIHVzZSBPYnNpZGlhbidzIG1ldGFkYXRhIGNhY2hlIChmYXN0IGFuZCByZWxpYWJsZSlcbiAgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgY29uc3QgZmlsZUNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgIHJldHVybiBmaWxlQ2FjaGU/LmZyb250bWF0dGVyIHx8IG51bGw7XG4gIH1cblxuICAvLyBGb3IgLm1keCBmaWxlcywgb25seSBwcm9jZXNzIGlmIE1EWCBzdXBwb3J0IGlzIGVuYWJsZWRcbiAgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiBzZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlYWQgcmF3IGZpbGUgY29udGVudCAod29ya3MgZm9yIGFueSBmaWxlIHR5cGUpXG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cbiAgICAgIC8vIEV4dHJhY3QgZnJvbnRtYXR0ZXIgdXNpbmcgcmVnZXggKHNhbWUgZm9ybWF0IGFzIC5tZCBmaWxlcylcbiAgICAgIC8vIE1hdGNoIHBhdHRlcm46IC0tLVxcbi4uLmNvbnRlbnQuLi5cXG4tLS0gKHdpdGggb3Igd2l0aG91dCB0cmFpbGluZyBuZXdsaW5lKVxuICAgICAgY29uc3QgZnJvbnRtYXR0ZXJSZWdleCA9IC9eLS0tXFxuKFtcXHNcXFNdKj8pXFxuLS0tLztcbiAgICAgIGNvbnN0IG1hdGNoID0gY29udGVudC5tYXRjaChmcm9udG1hdHRlclJlZ2V4KTtcblxuICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyVGV4dCA9IG1hdGNoWzFdO1xuICAgICAgICAvLyBQYXJzZSBZQU1MIHVzaW5nIE9ic2lkaWFuJ3MgcGFyc2VZYW1sIHV0aWxpdHlcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZVlhbWwoZnJvbnRtYXR0ZXJUZXh0KSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGwgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgcmV0dXJuIHBhcnNlZCAmJiB0eXBlb2YgcGFyc2VkID09PSAnb2JqZWN0JyA/IHBhcnNlZCA6IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdNRFggWUFNTCBwYXJzZSBlcnJvcjonLCBwYXJzZUVycm9yKTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9IGNhdGNoIChyZWFkRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgTURYIGZpbGU6JywgcmVhZEVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8vIEZvciBvdGhlciBmaWxlIHR5cGVzIG9yIE1EWCB3aGVuIHN1cHBvcnQgaXMgZGlzYWJsZWQsIHJldHVybiBudWxsXG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIFN5bmNocm9ub3VzIHZlcnNpb24gdGhhdCB1c2VzIG1ldGFkYXRhIGNhY2hlIGZvciAubWQgZmlsZXNcbiAqIEZvciAubWR4IGZpbGVzLCByZXR1cm5zIG51bGwgKHVzZSBhc3luYyB2ZXJzaW9uIGluc3RlYWQpXG4gKiBcbiAqIEBwYXJhbSBhcHAgLSBPYnNpZGlhbiBhcHAgaW5zdGFuY2VcbiAqIEBwYXJhbSBmaWxlIC0gVGhlIGZpbGUgdG8gZ2V0IGZyb250bWF0dGVyIGZyb21cbiAqIEBwYXJhbSBzZXR0aW5ncyAtIFBsdWdpbiBzZXR0aW5ncyAodG8gY2hlY2sgZW5hYmxlTWR4U3VwcG9ydClcbiAqIEByZXR1cm5zIFRoZSBmcm9udG1hdHRlciBvYmplY3QsIG9yIG51bGwgaWYgbm90IGZvdW5kL25vdCBzdXBwb3J0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZyb250bWF0dGVyU3luYyhcbiAgYXBwOiBBcHAsXG4gIGZpbGU6IFRGaWxlLFxuICBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3Ncbik6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgbnVsbCB7XG4gIC8vIEZvciAubWQgZmlsZXMsIHVzZSBPYnNpZGlhbidzIG1ldGFkYXRhIGNhY2hlXG4gIGlmIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgIGNvbnN0IGZpbGVDYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICByZXR1cm4gZmlsZUNhY2hlPy5mcm9udG1hdHRlciB8fCBudWxsO1xuICB9XG5cbiAgLy8gRm9yIC5tZHggZmlsZXMsIHdlIGNhbid0IHVzZSBzeW5jIHZlcnNpb24gKG5lZWQgdG8gcmVhZCBmaWxlKVxuICAvLyBSZXR1cm4gbnVsbCAtIGNhbGxlciBzaG91bGQgdXNlIGFzeW5jIHZlcnNpb24gaWYgTURYIHN1cHBvcnQgaXMgbmVlZGVkXG4gIGlmIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcgJiYgc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCkge1xuICAgIHJldHVybiBudWxsOyAvLyBJbmRpY2F0ZXMgYXN5bmMgdmVyc2lvbiBzaG91bGQgYmUgdXNlZFxuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBmaWxlIGV4dGVuc2lvbiBpcyBzdXBwb3J0ZWQgYmFzZWQgb24gc2V0dGluZ3NcbiAqIFxuICogQHBhcmFtIGV4dGVuc2lvbiAtIEZpbGUgZXh0ZW5zaW9uICh3aXRob3V0IGRvdClcbiAqIEBwYXJhbSBzZXR0aW5ncyAtIFBsdWdpbiBzZXR0aW5nc1xuICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgZmlsZSB0eXBlIGlzIHN1cHBvcnRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGaWxlVHlwZVN1cHBvcnRlZChleHRlbnNpb246IHN0cmluZywgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKTogYm9vbGVhbiB7XG4gIGlmIChleHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICByZXR1cm4gdHJ1ZTsgLy8gQWx3YXlzIHN1cHBvcnRlZFxuICB9XG4gIGlmIChleHRlbnNpb24gPT09ICdtZHgnKSB7XG4gICAgcmV0dXJuIHNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQ7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuIiwgImltcG9ydCB7IFRGaWxlLCBNZXRhZGF0YUNhY2hlLCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDYWNoZWRGaWxlRGF0YSwgUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBpc0ZpbGVUeXBlU3VwcG9ydGVkIH0gZnJvbSAnLi9mcm9udG1hdHRlcic7XG5cbmV4cG9ydCBmdW5jdGlvbiBmdXp6eU1hdGNoKHN0cjogc3RyaW5nLCBxdWVyeTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGxldCBpID0gMDtcbiAgY29uc3QgbG93ZXJTdHIgPSBzdHIudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gIGZvciAoY29uc3QgY2hhciBvZiBsb3dlclF1ZXJ5KSB7XG4gICAgaSA9IGxvd2VyU3RyLmluZGV4T2YoY2hhciwgaSkgKyAxO1xuICAgIGlmIChpID09PSAwKSByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXRjaFNjb3JlKGRpc3BsYXk6IHN0cmluZywgcXVlcnk6IHN0cmluZywgYmFzZW5hbWU6IHN0cmluZywgaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2g6IGJvb2xlYW4pOiBudW1iZXIge1xuICBsZXQgc2NvcmUgPSAwO1xuICBjb25zdCBsb3dlckRpc3BsYXkgPSBkaXNwbGF5LnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGxvd2VyQmFzZW5hbWUgPSBiYXNlbmFtZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcblxuICAvLyBFeGFjdCBtYXRjaGVzIGdldCBoaWdoZXN0IHNjb3JlXG4gIGlmIChsb3dlckRpc3BsYXkgPT09IGxvd2VyUXVlcnkpIHNjb3JlICs9IDEwMDA7XG4gIGVsc2UgaWYgKGxvd2VyQmFzZW5hbWUgPT09IGxvd2VyUXVlcnkpIHNjb3JlICs9IDkwMDtcblxuICAvLyBTdGFydHMgd2l0aCBxdWVyeSBnZXRzIGhpZ2ggc2NvcmVcbiAgZWxzZSBpZiAobG93ZXJEaXNwbGF5LnN0YXJ0c1dpdGgobG93ZXJRdWVyeSkpIHNjb3JlICs9IDEwMDtcbiAgZWxzZSBpZiAoaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2ggJiYgbG93ZXJCYXNlbmFtZS5zdGFydHNXaXRoKGxvd2VyUXVlcnkpKSBzY29yZSArPSA4MDtcblxuICAvLyBDb250YWlucyBxdWVyeSBnZXRzIG1lZGl1bSBzY29yZVxuICBlbHNlIGlmIChsb3dlckRpc3BsYXkuaW5jbHVkZXMobG93ZXJRdWVyeSkpIHNjb3JlICs9IDUwO1xuICBlbHNlIGlmIChpbmNsdWRlRmlsZW5hbWVJblNlYXJjaCAmJiBsb3dlckJhc2VuYW1lLmluY2x1ZGVzKGxvd2VyUXVlcnkpKSBzY29yZSArPSAzMDtcblxuICAvLyBXb3JkIGJvdW5kYXJ5IG1hdGNoZXMgZ2V0IGJvbnVzXG4gIGNvbnN0IHdvcmRCb3VuZGFyeVJlZ2V4ID0gbmV3IFJlZ0V4cChgXFxcXGIke2xvd2VyUXVlcnl9YCwgJ2knKTtcbiAgaWYgKHdvcmRCb3VuZGFyeVJlZ2V4LnRlc3QobG93ZXJEaXNwbGF5KSkgc2NvcmUgKz0gMjA7XG4gIGlmIChpbmNsdWRlRmlsZW5hbWVJblNlYXJjaCAmJiB3b3JkQm91bmRhcnlSZWdleC50ZXN0KGxvd2VyQmFzZW5hbWUpKSBzY29yZSArPSAxNTtcblxuICAvLyBQZW5hbHR5IGZvciB2ZXJ5IGxvbmcgbmFtZXNcbiAgY29uc3QgbGVuZ3RoUGVuYWx0eSA9IE1hdGgubWF4KDAsIChkaXNwbGF5Lmxlbmd0aCAtIHF1ZXJ5Lmxlbmd0aCkgKiAwLjEpO1xuICBzY29yZSAtPSBsZW5ndGhQZW5hbHR5O1xuXG4gIHJldHVybiBNYXRoLm1heCgwLCBzY29yZSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZEZpbGVDYWNoZShcbiAgZmlsZXM6IFRGaWxlW10sXG4gIG1ldGFkYXRhQ2FjaGU6IE1ldGFkYXRhQ2FjaGUsXG4gIGFwcDogQXBwLFxuICBwcm9wZXJ0eUtleTogc3RyaW5nLFxuICBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3Ncbik6IFByb21pc2U8TWFwPHN0cmluZywgQ2FjaGVkRmlsZURhdGE+PiB7XG4gIGNvbnN0IGNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIENhY2hlZEZpbGVEYXRhPigpO1xuICBjb25zdCB7IGdldEZyb250bWF0dGVyIH0gPSBhd2FpdCBpbXBvcnQoJy4vZnJvbnRtYXR0ZXInKTtcblxuICAvLyBQcm9jZXNzIGZpbGVzIGluIHBhcmFsbGVsIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2VcbiAgYXdhaXQgUHJvbWlzZS5hbGwoZmlsZXMubWFwKGFzeW5jIChmaWxlKSA9PiB7XG4gICAgLy8gU2tpcCB1bnN1cHBvcnRlZCBmaWxlIHR5cGVzXG4gICAgaWYgKCFpc0ZpbGVUeXBlU3VwcG9ydGVkKGZpbGUuZXh0ZW5zaW9uLCBzZXR0aW5ncykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBVc2Ugc3luYyB2ZXJzaW9uIGZvciAubWQgZmlsZXMsIGFzeW5jIGZvciAubWR4IGZpbGVzXG4gICAgbGV0IGZyb250bWF0dGVyOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGw7XG4gICAgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAvLyBGb3IgLm1kIGZpbGVzLCB1c2UgbWV0YWRhdGEgY2FjaGUgKGZhc3Qgc3luYyBhY2Nlc3MpXG4gICAgICBjb25zdCBmaWxlQ2FjaGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICBmcm9udG1hdHRlciA9IGZpbGVDYWNoZT8uZnJvbnRtYXR0ZXIgfHwgbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gTURYIGZpbGVzIG5lZWQgYXN5bmMgcmVhZGluZ1xuICAgICAgZnJvbnRtYXR0ZXIgPSBhd2FpdCBnZXRGcm9udG1hdHRlcihhcHAsIGZpbGUsIHNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBsZXQgZGlzcGxheU5hbWUgPSBmaWxlLmJhc2VuYW1lO1xuICAgIGxldCBpc0N1c3RvbURpc3BsYXkgPSBmYWxzZTtcbiAgICBsZXQgYWxpYXNlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlcltwcm9wZXJ0eUtleV0gIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlcltwcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWVSYXcgPSBmcm9udG1hdHRlcltwcm9wZXJ0eUtleV07XG4gICAgICBsZXQgcHJvcGVydHlWYWx1ZTogc3RyaW5nO1xuICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0eVZhbHVlUmF3ID09PSAnc3RyaW5nJykge1xuICAgICAgICBwcm9wZXJ0eVZhbHVlID0gcHJvcGVydHlWYWx1ZVJhdy50cmltKCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9wZXJ0eVZhbHVlUmF3ID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgcHJvcGVydHlWYWx1ZVJhdyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgIHByb3BlcnR5VmFsdWUgPSBTdHJpbmcocHJvcGVydHlWYWx1ZVJhdykudHJpbSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gU2tpcCBvYmplY3RzL2FycmF5cyAtIHRoZXkgY2FuJ3QgYmUgdXNlZCBhcyBkaXNwbGF5IG5hbWVzXG4gICAgICAgIHByb3BlcnR5VmFsdWUgPSAnJztcbiAgICAgIH1cbiAgICAgIGlmIChwcm9wZXJ0eVZhbHVlICYmIHByb3BlcnR5VmFsdWUgIT09ICcnKSB7XG4gICAgICAgIGRpc3BsYXlOYW1lID0gcHJvcGVydHlWYWx1ZTtcbiAgICAgICAgaXNDdXN0b21EaXNwbGF5ID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZnJvbnRtYXR0ZXI/LmFsaWFzZXMpIHtcbiAgICAgIGNvbnN0IGFsaWFzZXNSYXcgPSBmcm9udG1hdHRlci5hbGlhc2VzIGFzIHVua25vd247XG4gICAgICBhbGlhc2VzID0gQXJyYXkuaXNBcnJheShhbGlhc2VzUmF3KSA/IGFsaWFzZXNSYXcubWFwKGEgPT4gU3RyaW5nKGEpKSA6IFtTdHJpbmcoYWxpYXNlc1JhdyldO1xuICAgICAgYWxpYXNlcyA9IGFsaWFzZXMubWFwKGFsaWFzID0+IGFsaWFzLnRyaW0oKSkuZmlsdGVyKGFsaWFzID0+IGFsaWFzICE9PSAnJyk7XG4gICAgfVxuXG4gICAgY2FjaGUuc2V0KGZpbGUucGF0aCwge1xuICAgICAgZmlsZSxcbiAgICAgIGRpc3BsYXlOYW1lLFxuICAgICAgYWxpYXNlcyxcbiAgICAgIGxhc3RNb2RpZmllZDogZmlsZS5zdGF0Lm10aW1lLFxuICAgICAgaXNDdXN0b21EaXNwbGF5XG4gICAgfSk7XG4gIH0pKTtcblxuICByZXR1cm4gY2FjaGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0V4Y2x1ZGVkKGZpbGU6IFRGaWxlLCBhcHA6IEFwcCk6IGJvb2xlYW4ge1xuICBjb25zdCBtZXRhZGF0YUNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUgYXMgYW55O1xuXG4gIC8vIDEuIFRyeSB0aGUgb2ZmaWNpYWwtaXNoIGJ1dCBpbnRlcm5hbCBBUElcbiAgaWYgKHR5cGVvZiBtZXRhZGF0YUNhY2hlLmlzRXhjbHVkZWRGaWxlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFNvbWUgdmVyc2lvbnMgZXhwZWN0IFRGaWxlLCBzb21lIGV4cGVjdCBwYXRoIHN0cmluZ1xuICAgICAgaWYgKG1ldGFkYXRhQ2FjaGUuaXNFeGNsdWRlZEZpbGUoZmlsZSkpIHJldHVybiB0cnVlO1xuICAgICAgaWYgKG1ldGFkYXRhQ2FjaGUuaXNFeGNsdWRlZEZpbGUoZmlsZS5wYXRoKSkgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gSWdub3JlIGVycm9ycyBhbmQgbW92ZSB0byBmYWxsYmFja1xuICAgIH1cbiAgfVxuXG4gIC8vIDIuIE1hbnVhbCBmYWxsYmFjayB1c2luZyB1c2VySWdub3JlRmlsdGVyc1xuICB0cnkge1xuICAgIGNvbnN0IGZpbHRlcnMgPSAoYXBwLnZhdWx0IGFzIGFueSkuZ2V0Q29uZmlnKCd1c2VySWdub3JlRmlsdGVycycpO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGZpbHRlcnMpKSB7XG4gICAgICBjb25zdCBwYXRoID0gZmlsZS5wYXRoO1xuICAgICAgZm9yIChjb25zdCBmaWx0ZXIgb2YgZmlsdGVycykge1xuICAgICAgICBpZiAoIWZpbHRlcikgY29udGludWU7XG4gICAgICAgIC8vIEZvbGRlciBmaWx0ZXJzIG9mdGVuIGVuZCB3aXRoIC9cbiAgICAgICAgaWYgKGZpbHRlci5lbmRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgaWYgKHBhdGguc3RhcnRzV2l0aChmaWx0ZXIpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBFeGFjdCBtYXRjaCBvciBtYXRjaGVzIGEgcGFyZW50IGZvbGRlclxuICAgICAgICAgIGlmIChwYXRoID09PSBmaWx0ZXIgfHwgcGF0aC5zdGFydHNXaXRoKGZpbHRlciArICcvJykpIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gSWdub3JlIGVycm9yc1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuIiwgImltcG9ydCB7IEFwcCwgRnV6enlTdWdnZXN0TW9kYWwsIE1hcmtkb3duVmlldywgTm90aWNlLCBURmlsZSwgcHJlcGFyZUZ1enp5U2VhcmNoLCBwcmVwYXJlU2ltcGxlU2VhcmNoLCBGdXp6eU1hdGNoLCBzb3J0U2VhcmNoUmVzdWx0cywgU2VhcmNoUmVzdWx0IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgUXVpY2tTd2l0Y2hJdGVtLCBDYWNoZWRGaWxlRGF0YSwgU2VhcmNoTWF0Y2hSZWFzb24sIFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luLCBXb3Jrc3BhY2VJbnRlcm5hbCwgUXVpY2tTd2l0Y2hlclBsdWdpbkluc3RhbmNlLCBVbnJlc29sdmVkTGlua0l0ZW0sIE5ld05vdGVJdGVtLCBBcHBJbnRlcm5hbCwgTWV0YWRhdGFDYWNoZUludGVybmFsIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgYnVpbGRGaWxlQ2FjaGUsIGlzRXhjbHVkZWQgfSBmcm9tICcuLi91dGlscy9zZWFyY2gnO1xuaW1wb3J0IHsgZ2V0RnJvbnRtYXR0ZXJTeW5jIH0gZnJvbSAnLi4vdXRpbHMvZnJvbnRtYXR0ZXInO1xuXG5leHBvcnQgY2xhc3MgUXVpY2tTd2l0Y2hNb2RhbCBleHRlbmRzIEZ1enp5U3VnZ2VzdE1vZGFsPFF1aWNrU3dpdGNoSXRlbVsnaXRlbSddPiB7XG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcbiAgcHJpdmF0ZSBmaWxlQ2FjaGU6IE1hcDxzdHJpbmcsIENhY2hlZEZpbGVEYXRhPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSByZWNlbnRGaWxlczogVEZpbGVbXSA9IFtdO1xuICBwcml2YXRlIHNlYXJjaFRpbWVvdXQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIG1hdGNoUmVhc29uczogTWFwPHN0cmluZywgU2VhcmNoTWF0Y2hSZWFzb24+ID0gbmV3IE1hcCgpO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB0aGlzLmxpbWl0ID0gODsgLy8gTGltaXQgdG8gOCBpdGVtcyBmb3IgY29tZm9ydGFibGUgZGlzcGxheVxuXG4gICAgLy8gU2V0IHBsYWNlaG9sZGVyIGJhc2VkIG9uIHNldHRpbmdcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcikge1xuICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcignVHlwZSB0byBzZWFyY2ggbm90ZXMgYnkgdGl0bGUgb3IgZmlsZSBuYW1lLi4uJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ1R5cGUgdG8gc2VhcmNoIGZpbGVzLi4uJyk7XG4gICAgfVxuXG4gICAgdm9pZCB0aGlzLmJ1aWxkRmlsZUNhY2hlKCk7XG4gICAgdGhpcy51cGRhdGVSZWNlbnRGaWxlcygpO1xuICAgIHRoaXMuYWRkS2V5Ym9hcmROYXZpZ2F0aW9uKCk7XG4gICAgdGhpcy5hZGRGb290ZXIoKTtcblxuICAgIC8vIE9ubHkgYWRkIHNjb3BpbmcgY2xhc3Mgd2hlbiBlbmFibGVkXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIpIHtcbiAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoJ3Byb3BlcnR5LW92ZXItZmlsZW5hbWUtbW9kYWwnKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFkZEtleWJvYXJkTmF2aWdhdGlvbigpOiB2b2lkIHtcbiAgICAvLyBBZGQgZXNjYXBlIGtleSBoYW5kbGluZ1xuICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFkZEZvb3RlcigpOiB2b2lkIHtcbiAgICAvLyBGaW5kIHRoZSAucHJvbXB0IGNvbnRhaW5lciBhbmQgYWRkIGZvb3RlciBpbnNpZGUgaXRcbiAgICBjb25zdCBwcm9tcHRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5wcm9tcHQnKTtcbiAgICBpZiAocHJvbXB0Q29udGFpbmVyKSB7XG4gICAgICBjb25zdCBmb290ZXIgPSBwcm9tcHRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9ucycgfSk7XG4gICAgICAvLyBDcmVhdGUgbmF2aWdhdGlvbiBpbnN0cnVjdGlvbnMgdXNpbmcgRE9NIEFQSVxuICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zID0gW1xuICAgICAgICB7IGNvbW1hbmQ6ICdcdTIxOTFcdTIxOTMnLCBhY3Rpb246ICd0byBuYXZpZ2F0ZScgfSxcbiAgICAgICAgeyBjb21tYW5kOiAnXHUyMUI1JywgYWN0aW9uOiAndG8gb3BlbicgfSxcbiAgICAgICAgeyBjb21tYW5kOiAnY3RybCBcdTIxQjUnLCBhY3Rpb246ICd0byBvcGVuIGluIG5ldyB0YWInIH0sXG4gICAgICAgIHsgY29tbWFuZDogJ2N0cmwgYWx0IFx1MjFCNScsIGFjdGlvbjogJ3RvIG9wZW4gdG8gdGhlIHJpZ2h0JyB9LFxuICAgICAgICB7IGNvbW1hbmQ6ICdzaGlmdCBcdTIxQjUnLCBhY3Rpb246ICd0byBjcmVhdGUnIH0sXG4gICAgICAgIHsgY29tbWFuZDogJ2VzYycsIGFjdGlvbjogJ3RvIGRpc21pc3MnIH1cbiAgICAgIF07XG5cbiAgICAgIGluc3RydWN0aW9ucy5mb3JFYWNoKCh7IGNvbW1hbmQsIGFjdGlvbiB9KSA9PiB7XG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9uID0gZm9vdGVyLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbicgfSk7XG4gICAgICAgIGluc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb24tY29tbWFuZCcsIHRleHQ6IGNvbW1hbmQgfSk7XG4gICAgICAgIGluc3RydWN0aW9uLmNyZWF0ZVNwYW4oeyB0ZXh0OiBhY3Rpb24gfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBidWlsZEZpbGVDYWNoZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBmaWxlcyA9IHRoaXMuZ2V0RmlsdGVyZWRGaWxlcygpO1xuICAgIHRoaXMuZmlsZUNhY2hlID0gYXdhaXQgYnVpbGRGaWxlQ2FjaGUoXG4gICAgICBmaWxlcyxcbiAgICAgIHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUsXG4gICAgICB0aGlzLmFwcCxcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5LFxuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVGaWxlQ2FjaGUoZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IGdldEZyb250bWF0dGVyLCBpc0ZpbGVUeXBlU3VwcG9ydGVkIH0gPSBhd2FpdCBpbXBvcnQoJy4uL3V0aWxzL2Zyb250bWF0dGVyJyk7XG5cbiAgICAvLyBTa2lwIHVuc3VwcG9ydGVkIGZpbGUgdHlwZXNcbiAgICBpZiAoIWlzRmlsZVR5cGVTdXBwb3J0ZWQoZmlsZS5leHRlbnNpb24sIHRoaXMucGx1Z2luLnNldHRpbmdzKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gYXdhaXQgZ2V0RnJvbnRtYXR0ZXIodGhpcy5hcHAsIGZpbGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcbiAgICBsZXQgZGlzcGxheU5hbWUgPSBmaWxlLmJhc2VuYW1lO1xuICAgIGxldCBpc0N1c3RvbURpc3BsYXkgPSBmYWxzZTtcbiAgICBsZXQgYWxpYXNlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcoZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldKS50cmltKCk7XG4gICAgICBpZiAocHJvcGVydHlWYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgZGlzcGxheU5hbWUgPSBwcm9wZXJ0eVZhbHVlO1xuICAgICAgICBpc0N1c3RvbURpc3BsYXkgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmcm9udG1hdHRlcj8uYWxpYXNlcykge1xuICAgICAgY29uc3QgYWxpYXNlc1JhdyA9IGZyb250bWF0dGVyLmFsaWFzZXMgYXMgdW5rbm93bjtcbiAgICAgIGFsaWFzZXMgPSBBcnJheS5pc0FycmF5KGFsaWFzZXNSYXcpID8gYWxpYXNlc1Jhdy5tYXAoYSA9PiBTdHJpbmcoYSkpIDogW1N0cmluZyhhbGlhc2VzUmF3KV07XG4gICAgICBhbGlhc2VzID0gYWxpYXNlcy5tYXAoYWxpYXMgPT4gYWxpYXMudHJpbSgpKS5maWx0ZXIoYWxpYXMgPT4gYWxpYXMgIT09ICcnKTtcbiAgICB9XG5cbiAgICB0aGlzLmZpbGVDYWNoZS5zZXQoZmlsZS5wYXRoLCB7XG4gICAgICBmaWxlLFxuICAgICAgZGlzcGxheU5hbWUsXG4gICAgICBhbGlhc2VzLFxuICAgICAgbGFzdE1vZGlmaWVkOiBmaWxlLnN0YXQubXRpbWUsXG4gICAgICBpc0N1c3RvbURpc3BsYXlcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlUmVjZW50RmlsZXMoKTogdm9pZCB7XG4gICAgLy8gVXNlIE9ic2lkaWFuJ3MgaW50ZXJuYWwgcmVjZW50IGZpbGVzIG1lY2hhbmlzbSBmb3IgcGVyZmVjdCBjb21wYXRpYmlsaXR5XG4gICAgbGV0IHJlY2VudEZpbGVzOiBURmlsZVtdID0gW107XG5cbiAgICBjb25zdCB3b3Jrc3BhY2UgPSB0aGlzLmFwcC53b3Jrc3BhY2UgYXMgdW5rbm93biBhcyBXb3Jrc3BhY2VJbnRlcm5hbCAmIHsgcmVjZW50RmlsZVRyYWNrZXI/OiB7IGdldExhc3RPcGVuRmlsZXMoKTogc3RyaW5nW10gfSB9O1xuXG4gICAgLy8gQ2hlY2sgUXVpY2sgU3dpdGNoZXIgc2V0dGluZ3MgdG8gZGV0ZXJtaW5lIHdoYXQgZmlsZSB0eXBlcyB0byBpbmNsdWRlXG4gICAgY29uc3QgcXVpY2tTd2l0Y2hlck9wdGlvbnMgPSB0aGlzLmdldFF1aWNrU3dpdGNoZXJPcHRpb25zKCk7XG4gICAgY29uc3Qgc2hvd0F0dGFjaG1lbnRzID0gcXVpY2tTd2l0Y2hlck9wdGlvbnM/LnNob3dBdHRhY2htZW50cyA/PyB0cnVlO1xuXG4gICAgLy8gQWNjZXNzIE9ic2lkaWFuJ3MgcmVjZW50RmlsZVRyYWNrZXIgdG8gZ2V0IHRoZSBzYW1lIGZpbGVzIGFzIGRlZmF1bHQgcXVpY2sgc3dpdGNoZXJcbiAgICBpZiAod29ya3NwYWNlLnJlY2VudEZpbGVUcmFja2VyPy5nZXRMYXN0T3BlbkZpbGVzKSB7XG4gICAgICBjb25zdCBsYXN0T3BlbkZpbGVzID0gd29ya3NwYWNlLnJlY2VudEZpbGVUcmFja2VyLmdldExhc3RPcGVuRmlsZXMoKTtcblxuICAgICAgLy8gQ29udmVydCBmaWxlIHBhdGhzIHRvIFRGaWxlIG9iamVjdHNcbiAgICAgIHJlY2VudEZpbGVzID0gbGFzdE9wZW5GaWxlc1xuICAgICAgICAubWFwKChmaWxlUGF0aDogc3RyaW5nKSA9PiB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpKVxuICAgICAgICAuZmlsdGVyKChmaWxlOiB1bmtub3duKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xuICAgIH1cblxuICAgIC8vIEZhbGxiYWNrIGlmIHJlY2VudEZpbGVUcmFja2VyIGlzIG5vdCBhdmFpbGFibGVcbiAgICBpZiAocmVjZW50RmlsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zdCBvcGVuRmlsZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpXG4gICAgICAgIC5tYXAobGVhZiA9PiBsZWFmLnZpZXcpXG4gICAgICAgIC5maWx0ZXIoKHZpZXcpOiB2aWV3IGlzIE1hcmtkb3duVmlldyA9PiB2aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KVxuICAgICAgICAubWFwKHZpZXcgPT4gdmlldy5maWxlKVxuICAgICAgICAuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlICE9PSBudWxsKVxuICAgICAgICAuZmlsdGVyKChmaWxlLCBpbmRleCwgc2VsZikgPT4gc2VsZi5pbmRleE9mKGZpbGUpID09PSBpbmRleCk7XG5cbiAgICAgIHJlY2VudEZpbGVzID0gWy4uLm9wZW5GaWxlc107XG4gICAgfVxuXG4gICAgLy8gRmlsdGVyIG91dCBleGNsdWRlZCBmaWxlcyB1bmxlc3MgYmVoYXZpb3IgaXMgJ2lnbm9yZSdcbiAgICBjb25zdCBiZWhhdmlvciA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnF1aWNrU3dpdGNoZXJFeGNsdWRlZEJlaGF2aW9yO1xuICAgIGlmIChiZWhhdmlvciAhPT0gJ2lnbm9yZScpIHtcbiAgICAgIHJlY2VudEZpbGVzID0gcmVjZW50RmlsZXMuZmlsdGVyKGZpbGUgPT4gIWlzRXhjbHVkZWQoZmlsZSwgdGhpcy5hcHApKTtcbiAgICB9XG5cbiAgICAvLyBGaWx0ZXIgYmFzZWQgb24gUXVpY2sgU3dpdGNoZXIgc2V0dGluZ3MgQkVGT1JFIGJhY2tmaWxsaW5nXG4gICAgaWYgKCFzaG93QXR0YWNobWVudHMpIHtcbiAgICAgIC8vIEZpbHRlciBvdXQgYXR0YWNobWVudHMgLSBvbmx5IHNob3cgbWFya2Rvd24gZmlsZXMgKGFuZCBNRFggaWYgZW5hYmxlZClcbiAgICAgIHJlY2VudEZpbGVzID0gcmVjZW50RmlsZXMuZmlsdGVyKGZpbGUgPT5cbiAgICAgICAgZmlsZS5leHRlbnNpb24gPT09ICdtZCcgfHxcbiAgICAgICAgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBBbHdheXMgYmFja2ZpbGwgdG8gOCBpdGVtcyAob3IgYXMgbWFueSBhcyBhdmFpbGFibGUpXG4gICAgY29uc3QgdGFyZ2V0Q291bnQgPSA4O1xuICAgIGNvbnN0IGV4aXN0aW5nUGF0aHMgPSBuZXcgU2V0KHJlY2VudEZpbGVzLm1hcChmID0+IGYucGF0aCkpO1xuXG4gICAgaWYgKHJlY2VudEZpbGVzLmxlbmd0aCA8IHRhcmdldENvdW50KSB7XG4gICAgICBpZiAoc2hvd0F0dGFjaG1lbnRzKSB7XG4gICAgICAgIC8vIEluY2x1ZGUgYWxsIGZpbGUgdHlwZXMgKG1hcmtkb3duICsgYXR0YWNobWVudHMpXG4gICAgICAgIGNvbnN0IGFsbEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGZpbGUpOiBmaWxlIGlzIFRGaWxlID0+IGZpbGUgaW5zdGFuY2VvZiBURmlsZSk7XG4gICAgICAgIGNvbnN0IGFkZGl0aW9uYWxGaWxlcyA9IGFsbEZpbGVzXG4gICAgICAgICAgLmZpbHRlcihmaWxlID0+ICFleGlzdGluZ1BhdGhzLmhhcyhmaWxlLnBhdGgpKVxuICAgICAgICAgIC5zbGljZSgwLCB0YXJnZXRDb3VudCAtIHJlY2VudEZpbGVzLmxlbmd0aCk7XG4gICAgICAgIHJlY2VudEZpbGVzLnB1c2goLi4uYWRkaXRpb25hbEZpbGVzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE9ubHkgbWFya2Rvd24gZmlsZXMgKGFuZCBNRFggaWYgZW5hYmxlZClcbiAgICAgICAgY29uc3QgYWxsTWFya2Rvd25GaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICAgICAgY29uc3QgbWR4RmlsZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0XG4gICAgICAgICAgPyB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcihcbiAgICAgICAgICAgIChmKTogZiBpcyBURmlsZSA9PiBmIGluc3RhbmNlb2YgVEZpbGUgJiYgZi5leHRlbnNpb24gPT09ICdtZHgnXG4gICAgICAgICAgKVxuICAgICAgICAgIDogW107XG4gICAgICAgIGNvbnN0IGFsbFN1cHBvcnRlZEZpbGVzID0gWy4uLmFsbE1hcmtkb3duRmlsZXMsIC4uLm1keEZpbGVzXTtcbiAgICAgICAgY29uc3QgYmVoYXZpb3IgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5xdWlja1N3aXRjaGVyRXhjbHVkZWRCZWhhdmlvcjtcbiAgICAgICAgY29uc3QgYWRkaXRpb25hbEZpbGVzID0gYWxsU3VwcG9ydGVkRmlsZXNcbiAgICAgICAgICAuZmlsdGVyKGZpbGUgPT4gIWV4aXN0aW5nUGF0aHMuaGFzKGZpbGUucGF0aCkpXG4gICAgICAgICAgLmZpbHRlcihmaWxlID0+IGJlaGF2aW9yID09PSAnaWdub3JlJyB8fCAhaXNFeGNsdWRlZChmaWxlLCB0aGlzLmFwcCkpXG4gICAgICAgICAgLnNsaWNlKDAsIHRhcmdldENvdW50IC0gcmVjZW50RmlsZXMubGVuZ3RoKTtcbiAgICAgICAgcmVjZW50RmlsZXMucHVzaCguLi5hZGRpdGlvbmFsRmlsZXMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIExpbWl0IHRvIDggZmlsZXNcbiAgICB0aGlzLnJlY2VudEZpbGVzID0gcmVjZW50RmlsZXMuc2xpY2UoMCwgdGFyZ2V0Q291bnQpO1xuICB9XG5cbiAgZ2V0SXRlbXMoKTogUXVpY2tTd2l0Y2hJdGVtWydpdGVtJ11bXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RmlsdGVyZWRGaWxlcygpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRGaWx0ZXJlZEZpbGVzKCk6IFRGaWxlW10ge1xuICAgIGNvbnN0IHF1aWNrU3dpdGNoZXJPcHRpb25zID0gdGhpcy5nZXRRdWlja1N3aXRjaGVyT3B0aW9ucygpO1xuXG4gICAgLy8gU3RhcnQgd2l0aCBtYXJrZG93biBmaWxlc1xuICAgIGxldCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblxuICAgIC8vIEFkZCBNRFggZmlsZXMgaWYgTURYIHN1cHBvcnQgaXMgZW5hYmxlZFxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XG4gICAgICBjb25zdCBtZHhGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKFxuICAgICAgICAoZik6IGYgaXMgVEZpbGUgPT4gZiBpbnN0YW5jZW9mIFRGaWxlICYmIGYuZXh0ZW5zaW9uID09PSAnbWR4J1xuICAgICAgKTtcbiAgICAgIGZpbGVzID0gWy4uLmZpbGVzLCAuLi5tZHhGaWxlc107XG4gICAgfVxuXG4gICAgLy8gSWYgd2UgY2FuIGFjY2VzcyBRdWljayBTd2l0Y2hlciBvcHRpb25zIGFuZCBhdHRhY2htZW50cyBhcmUgZW5hYmxlZCwgaW5jbHVkZSB0aGVtXG4gICAgaWYgKHF1aWNrU3dpdGNoZXJPcHRpb25zPy5zaG93QXR0YWNobWVudHMpIHtcbiAgICAgIGNvbnN0IGFsbEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGZpbGUpOiBmaWxlIGlzIFRGaWxlID0+IGZpbGUgaW5zdGFuY2VvZiBURmlsZSk7XG4gICAgICAvLyBJbmNsdWRlIG1hcmtkb3duIGZpbGVzLCBNRFggZmlsZXMgKGlmIGVuYWJsZWQpLCBhbmQgYXR0YWNobWVudHNcbiAgICAgIGZpbGVzID0gYWxsRmlsZXMuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PlxuICAgICAgICBmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgKFxuICAgICAgICAgIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnIHx8XG4gICAgICAgICAgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB8fFxuICAgICAgICAgIHRoaXMuaXNBdHRhY2htZW50KGZpbGUpXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICAgIC8vIElmIHNob3dBdHRhY2htZW50cyBpcyBmYWxzZSBvciB3ZSBjYW4ndCBhY2Nlc3Mgb3B0aW9ucywgb25seSBzaG93IG1hcmtkb3duIGZpbGVzIChhbmQgTURYIGlmIGVuYWJsZWQpXG5cbiAgICByZXR1cm4gZmlsZXM7XG4gIH1cblxuICBwcml2YXRlIGlzQXR0YWNobWVudChmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGF0dGFjaG1lbnRFeHRlbnNpb25zID0gWydwbmcnLCAnanBnJywgJ2pwZWcnLCAnZ2lmJywgJ3N2ZycsICd3ZWJwJywgJ3BkZicsICdtcDQnLCAnbXAzJywgJ3dhdicsICdvZ2cnLCAnd2VibSddO1xuICAgIHJldHVybiBhdHRhY2htZW50RXh0ZW5zaW9ucy5pbmNsdWRlcyhmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTogUXVpY2tTd2l0Y2hlclBsdWdpbkluc3RhbmNlWydvcHRpb25zJ10gfCBudWxsIHtcbiAgICB0cnkge1xuICAgICAgLy8gQWNjZXNzIHRoZSBpbnRlcm5hbCBRdWljayBTd2l0Y2hlciBwbHVnaW4gdGhlIHNhbWUgd2F5IFF1aWNrIFN3aXRjaCArKyBkb2VzXG4gICAgICBjb25zdCBpbnRlcm5hbFBsdWdpbnMgPSAodGhpcy5hcHAgYXMgdW5rbm93biBhcyBBcHBJbnRlcm5hbCkuaW50ZXJuYWxQbHVnaW5zO1xuICAgICAgaWYgKCFpbnRlcm5hbFBsdWdpbnMpIHJldHVybiBudWxsO1xuXG4gICAgICBjb25zdCBzd2l0Y2hlclBsdWdpbiA9IGludGVybmFsUGx1Z2lucy5nZXRQbHVnaW5CeUlkPy4oJ3N3aXRjaGVyJyk7XG4gICAgICBpZiAoIXN3aXRjaGVyUGx1Z2luIHx8ICFzd2l0Y2hlclBsdWdpbi5pbnN0YW5jZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHN3aXRjaGVyUGx1Z2luLmluc3RhbmNlLm9wdGlvbnMgfHwgbnVsbDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGdldEl0ZW1UZXh0KGl0ZW06IFF1aWNrU3dpdGNoSXRlbVsnaXRlbSddKTogc3RyaW5nIHtcbiAgICBpZiAoJ2lzTmV3Tm90ZScgaW4gaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0ubmV3TmFtZTsgLy8gSnVzdCByZXR1cm4gdGhlIG5hbWUsIE9ic2lkaWFuIHdpbGwgaGFuZGxlIHRoZSBcIkVudGVyIHRvIGNyZWF0ZVwiIHRleHRcbiAgICB9XG5cbiAgICBpZiAoJ2lzVW5yZXNvbHZlZCcgaW4gaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0udW5yZXNvbHZlZFRleHQ7XG4gICAgfVxuXG4gICAgLy8gV2hlbiBkaXNhYmxlZCwgc2hvdyBqdXN0IHRoZSBmaWxlIG5hbWUgbGlrZSBkZWZhdWx0IE9ic2lkaWFuXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyKSB7XG4gICAgICByZXR1cm4gaXRlbS5iYXNlbmFtZTtcbiAgICB9XG5cbiAgICBjb25zdCBkaXNwbGF5ID0gdGhpcy5nZXREaXNwbGF5TmFtZShpdGVtKTtcbiAgICByZXR1cm4gZGlzcGxheTtcbiAgfVxuXG4gIGdldERpc3BsYXlOYW1lKGZpbGU6IFRGaWxlKTogc3RyaW5nIHtcbiAgICAvLyBUcnkgdG8gZ2V0IGZyb20gY2FjaGUgZmlyc3QgKGZhc3QsIHdvcmtzIGZvciBib3RoIE1EIGFuZCBNRFggaWYgY2FjaGVkKVxuICAgIGNvbnN0IGNhY2hlZCA9IHRoaXMuZmlsZUNhY2hlLmdldChmaWxlLnBhdGgpO1xuICAgIGlmIChjYWNoZWQpIHtcbiAgICAgIHJldHVybiBjYWNoZWQuZGlzcGxheU5hbWU7XG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2s6IHVzZSBzeW5jIHZlcnNpb24gZm9yIC5tZCBmaWxlcywgb3IgcmV0dXJuIGJhc2VuYW1lIGZvciAubWR4ICh3aWxsIGJlIGNhY2hlZCBhc3luYylcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGdldEZyb250bWF0dGVyU3luYyh0aGlzLmFwcCwgZmlsZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXG4gICAgaWYgKGZyb250bWF0dGVyKSB7XG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldO1xuICAgICAgaWYgKHByb3BlcnR5VmFsdWUgIT09IHVuZGVmaW5lZCAmJiBwcm9wZXJ0eVZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHRyaW1tZWQgPSB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ3N0cmluZycgPyBwcm9wZXJ0eVZhbHVlLnRyaW0oKSA6ICh0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHByb3BlcnR5VmFsdWUgPT09ICdib29sZWFuJyA/IFN0cmluZyhwcm9wZXJ0eVZhbHVlKSA6ICcnKS50cmltKCk7XG4gICAgICAgIGlmICh0cmltbWVkICE9PSAnJykge1xuICAgICAgICAgIHJldHVybiB0cmltbWVkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbGUuYmFzZW5hbWU7XG4gIH1cblxuICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogRnV6enlNYXRjaDxRdWlja1N3aXRjaEl0ZW1bJ2l0ZW0nXT5bXSB7XG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyKSB7XG4gICAgICAvLyBXaGVuIGRpc2FibGVkLCB1c2UgZGVmYXVsdCBPYnNpZGlhbiBiZWhhdmlvciAtIHNob3cgYWxsIGZpbGVzIHdpdGggZGVmYXVsdCBzZWFyY2hcbiAgICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcXVlcnkudHJpbSgpO1xuXG4gICAgICBpZiAoIXNlYXJjaFF1ZXJ5KSB7XG4gICAgICAgIC8vIFNob3cgcmVjZW50IGZpbGVzIGxpa2UgZGVmYXVsdCBPYnNpZGlhblxuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZWNlbnRGaWxlc1Jlc3VsdHMoKTtcbiAgICAgIH1cblxuICAgICAgLy8gVXNlIGRlZmF1bHQgT2JzaWRpYW4gc2VhcmNoIC0ganVzdCBzaG93IGZpbGVzIHdpdGggZmlsZSBuYW1lIG1hdGNoaW5nXG4gICAgICBjb25zdCBmaWxlcyA9IHRoaXMuZ2V0RmlsdGVyZWRGaWxlcygpO1xuICAgICAgY29uc3Qgc2VhcmNoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlU2ltcGxlU2VhcmNoXG4gICAgICAgID8gcHJlcGFyZVNpbXBsZVNlYXJjaChzZWFyY2hRdWVyeSlcbiAgICAgICAgOiBwcmVwYXJlRnV6enlTZWFyY2goc2VhcmNoUXVlcnkpO1xuICAgICAgY29uc3QgcmVzdWx0czogRnV6enlNYXRjaDxRdWlja1N3aXRjaEl0ZW1bJ2l0ZW0nXT5bXSA9IFtdO1xuXG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBzZWFyY2goZmlsZS5iYXNlbmFtZSkgPz8geyBzY29yZTogMCwgbWF0Y2hlczogW10gfTtcbiAgICAgICAgaWYgKG1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJlc3VsdHMucHVzaCh7IGl0ZW06IGZpbGUsIG1hdGNoIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFVzZSBPYnNpZGlhbidzIG5hdGl2ZSBzb3J0aW5nIGZvciBleGFjdCB2YW5pbGxhIGNvbXBhdGliaWxpdHlcbiAgICAgIHNvcnRTZWFyY2hSZXN1bHRzKHJlc3VsdHMpO1xuXG4gICAgICAvLyBBbHdheXMgYWRkIG5ldyBub3RlIG9wdGlvbiBpZiBubyByZXN1bHRzXG4gICAgICAvLyBcIlNob3cgZXhpc3Rpbmcgb25seVwiIG9ubHkgYWZmZWN0cyBzaG93aW5nIHVucmVzb2x2ZWQgbGlua3MsIG5vdCBjcmVhdGluZyBuZXcgbm90ZXNcbiAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zdCBuZXdJdGVtOiBOZXdOb3RlSXRlbSA9IHsgaXNOZXdOb3RlOiB0cnVlLCBuZXdOYW1lOiBzZWFyY2hRdWVyeSB9O1xuICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgIGl0ZW06IG5ld0l0ZW0sXG4gICAgICAgICAgbWF0Y2g6IHsgc2NvcmU6IDEwMDAsIG1hdGNoZXM6IFtbMCwgc2VhcmNoUXVlcnkubGVuZ3RoXV0gfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXN1bHRzLnNsaWNlKDAsIHRoaXMubGltaXQpO1xuICAgIH1cblxuICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcXVlcnkudHJpbSgpO1xuXG4gICAgLy8gQ2xlYXIgcHJldmlvdXMgdGltZW91dFxuICAgIGlmICh0aGlzLnNlYXJjaFRpbWVvdXQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNlYXJjaFRpbWVvdXQpO1xuICAgIH1cblxuICAgIC8vIElmIG5vIHF1ZXJ5LCBzaG93IHJlY2VudCBmaWxlc1xuICAgIGlmICghc2VhcmNoUXVlcnkpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFJlY2VudEZpbGVzUmVzdWx0cygpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnBlcmZvcm1TZWFyY2goc2VhcmNoUXVlcnkpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRSZWNlbnRGaWxlc1Jlc3VsdHMoKTogRnV6enlNYXRjaDxRdWlja1N3aXRjaEl0ZW1bJ2l0ZW0nXT5bXSB7XG4gICAgLy8gVXBkYXRlIHJlY2VudCBmaWxlcyAodGhpcyBhbHJlYWR5IGhhbmRsZXMgZmlsdGVyaW5nIGFuZCBiYWNrZmlsbGluZylcbiAgICB0aGlzLnVwZGF0ZVJlY2VudEZpbGVzKCk7XG5cbiAgICAvLyBDbGVhciBtYXRjaCByZWFzb25zIGZvciByZWNlbnQgZmlsZXMgc2luY2UgdGhleSdyZSBub3Qgc2VhcmNoIHJlc3VsdHNcbiAgICB0aGlzLm1hdGNoUmVhc29ucy5jbGVhcigpO1xuXG4gICAgLy8gUmV0dXJuIHRoZSByZWNlbnQgZmlsZXMgKGFscmVhZHkgZmlsdGVyZWQgYW5kIGJhY2tmaWxsZWQgaW4gdXBkYXRlUmVjZW50RmlsZXMpXG4gICAgcmV0dXJuIHRoaXMucmVjZW50RmlsZXMubWFwKGZpbGUgPT4gKHtcbiAgICAgIGl0ZW06IGZpbGUsXG4gICAgICBtYXRjaDogeyBzY29yZTogMTAwMCwgbWF0Y2hlczogW10gfVxuICAgIH0pKTtcbiAgfVxuXG4gIHByaXZhdGUgcGVyZm9ybVNlYXJjaChzZWFyY2hRdWVyeTogc3RyaW5nKTogRnV6enlNYXRjaDxRdWlja1N3aXRjaEl0ZW1bJ2l0ZW0nXT5bXSB7XG4gICAgLy8gVXNlIHNpbXBsZSBzZWFyY2ggZm9yIGxhcmdlIHZhdWx0cyBpZiBlbmFibGVkLCBvdGhlcndpc2UgdXNlIGZ1enp5IHNlYXJjaFxuICAgIGNvbnN0IHNlYXJjaCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVNpbXBsZVNlYXJjaFxuICAgICAgPyBwcmVwYXJlU2ltcGxlU2VhcmNoKHNlYXJjaFF1ZXJ5KVxuICAgICAgOiBwcmVwYXJlRnV6enlTZWFyY2goc2VhcmNoUXVlcnkpO1xuICAgIGNvbnN0IHJlc3VsdHM6IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+W10gPSBbXTtcbiAgICB0aGlzLm1hdGNoUmVhc29ucy5jbGVhcigpOyAvLyBDbGVhciBwcmV2aW91cyBtYXRjaCByZWFzb25zXG5cbiAgICAvLyBVc2UgY2FjaGVkIGRhdGEgZm9yIG11Y2ggZmFzdGVyIHNlYXJjaFxuICAgIGZvciAoY29uc3QgY2FjaGVkRGF0YSBvZiB0aGlzLmZpbGVDYWNoZS52YWx1ZXMoKSkge1xuICAgICAgY29uc3QgeyBmaWxlLCBkaXNwbGF5TmFtZSwgYWxpYXNlcywgaXNDdXN0b21EaXNwbGF5IH0gPSBjYWNoZWREYXRhO1xuXG4gICAgICAvLyBUcmFjayB3aGljaCBmaWVsZHMgY2F1c2VkIHRoZSBtYXRjaFxuICAgICAgY29uc3QgbWF0Y2hSZWFzb246IFNlYXJjaE1hdGNoUmVhc29uID0ge1xuICAgICAgICBtYXRjaGVkSW5UaXRsZTogZmFsc2UsXG4gICAgICAgIG1hdGNoZWRJbkZpbGVuYW1lOiBmYWxzZSxcbiAgICAgICAgbWF0Y2hlZEluQWxpYXM6IGZhbHNlXG4gICAgICB9O1xuXG4gICAgICAvLyBQcmltYXJ5IG1hdGNoOiBzZWFyY2ggdGl0bGUvcHJvcGVydHkgZmlyc3QgKG9ubHkgaWYgbm90ZSBoYXMgY3VzdG9tIGRpc3BsYXkpXG4gICAgICBsZXQgcHJpbWFyeU1hdGNoOiBTZWFyY2hSZXN1bHQgfCBudWxsID0gbnVsbDtcbiAgICAgIGxldCBiZXN0TWF0Y2g6IFNlYXJjaFJlc3VsdCB8IG51bGwgPSBudWxsO1xuICAgICAgbGV0IG1hdGNoVHlwZTogJ3RpdGxlJyB8ICdmaWxlbmFtZScgfCAnYWxpYXMnIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgIGlmIChpc0N1c3RvbURpc3BsYXkpIHtcbiAgICAgICAgLy8gT25seSBzZWFyY2ggdGl0bGUvcHJvcGVydHkgaWYgbm90ZSBhY3R1YWxseSBoYXMgYSBjdXN0b20gcHJvcGVydHlcbiAgICAgICAgcHJpbWFyeU1hdGNoID0gc2VhcmNoKGRpc3BsYXlOYW1lKTtcbiAgICAgICAgaWYgKHByaW1hcnlNYXRjaCAmJiBwcmltYXJ5TWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEluVGl0bGUgPSB0cnVlO1xuICAgICAgICAgIGJlc3RNYXRjaCA9IHByaW1hcnlNYXRjaDtcbiAgICAgICAgICBtYXRjaFR5cGUgPSAndGl0bGUnO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIElmIG5vIHRpdGxlIG1hdGNoIChvciBub3RlIGRvZXNuJ3QgaGF2ZSBwcm9wZXJ0eSksIHNlYXJjaCBmaWxlbmFtZVxuICAgICAgaWYgKCFtYXRjaFR5cGUpIHtcbiAgICAgICAgLy8gU2VhcmNoIGZpbGVuYW1lIGlmIGl0J3MgZGlmZmVyZW50IGZyb20gZGlzcGxheU5hbWUsIG9yIGlmIG5vdGUgZG9lc24ndCBoYXZlIHByb3BlcnR5XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlRmlsZW5hbWVJblNlYXJjaCAmJiBmaWxlLmJhc2VuYW1lICE9PSBkaXNwbGF5TmFtZSkge1xuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lTWF0Y2ggPSBzZWFyY2goZmlsZS5iYXNlbmFtZSk7XG4gICAgICAgICAgaWYgKGZpbGVuYW1lTWF0Y2ggJiYgZmlsZW5hbWVNYXRjaC5tYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIERvd25yYW5rIGZpbGVuYW1lIG1hdGNoZXMgYnkgLTFcbiAgICAgICAgICAgIGJlc3RNYXRjaCA9IHsgLi4uZmlsZW5hbWVNYXRjaCwgc2NvcmU6IGZpbGVuYW1lTWF0Y2guc2NvcmUgLSAxIH07XG4gICAgICAgICAgICBtYXRjaFR5cGUgPSAnZmlsZW5hbWUnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghaXNDdXN0b21EaXNwbGF5KSB7XG4gICAgICAgICAgLy8gSWYgbm90ZSBkb2Vzbid0IGhhdmUgcHJvcGVydHksIGRpc3BsYXlOYW1lIGVxdWFscyBmaWxlbmFtZSwgc28gc2VhcmNoIGZpbGVuYW1lXG4gICAgICAgICAgY29uc3QgZmlsZW5hbWVNYXRjaCA9IHNlYXJjaChmaWxlLmJhc2VuYW1lKTtcbiAgICAgICAgICBpZiAoZmlsZW5hbWVNYXRjaCAmJiBmaWxlbmFtZU1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEluRmlsZW5hbWUgPSB0cnVlO1xuICAgICAgICAgICAgYmVzdE1hdGNoID0gZmlsZW5hbWVNYXRjaDtcbiAgICAgICAgICAgIG1hdGNoVHlwZSA9ICdmaWxlbmFtZSc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRlcnRpYXJ5IG1hdGNoOiBzZWFyY2ggYWxpYXNlcyAod2l0aCBkb3ducmFua2luZylcbiAgICAgIGlmICghbWF0Y2hUeXBlICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVBbGlhc2VzSW5TZWFyY2ggJiYgYWxpYXNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvciAoY29uc3QgYWxpYXMgb2YgYWxpYXNlcykge1xuICAgICAgICAgIGNvbnN0IGFsaWFzTWF0Y2ggPSBzZWFyY2goYWxpYXMpO1xuICAgICAgICAgIGlmIChhbGlhc01hdGNoICYmIGFsaWFzTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcyA9IHRydWU7XG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkQWxpYXNUZXh0ID0gYWxpYXM7IC8vIFN0b3JlIHdoaWNoIGFsaWFzIG1hdGNoZWRcbiAgICAgICAgICAgIC8vIERvd25yYW5rIGFsaWFzIG1hdGNoZXMgYnkgLTFcbiAgICAgICAgICAgIGJlc3RNYXRjaCA9IHsgLi4uYWxpYXNNYXRjaCwgc2NvcmU6IGFsaWFzTWF0Y2guc2NvcmUgLSAxIH07XG4gICAgICAgICAgICBtYXRjaFR5cGUgPSAnYWxpYXMnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIElmIHdlIGhhdmUgYW55IG1hdGNoLCBhZGQgdG8gcmVzdWx0c1xuICAgICAgaWYgKGJlc3RNYXRjaCAmJiBiZXN0TWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIElmIHF1ZXJ5IGlzIGVtcHR5LCBuZXZlciBzaG93IGV4Y2x1ZGVkIGZpbGVzIHVubGVzcyBiZWhhdmlvciBpcyAnaWdub3JlJ1xuICAgICAgICBpZiAoIXNlYXJjaFF1ZXJ5KSB7XG4gICAgICAgICAgY29uc3QgYmVoYXZpb3IgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5xdWlja1N3aXRjaGVyRXhjbHVkZWRCZWhhdmlvcjtcbiAgICAgICAgICBpZiAoYmVoYXZpb3IgIT09ICdpZ25vcmUnICYmIGlzRXhjbHVkZWQoZmlsZSwgdGhpcy5hcHApKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXN1bHRzLnB1c2goeyBpdGVtOiBmaWxlLCBtYXRjaDogYmVzdE1hdGNoIH0pO1xuICAgICAgICB0aGlzLm1hdGNoUmVhc29ucy5zZXQoZmlsZS5wYXRoLCBtYXRjaFJlYXNvbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWRkIHVucmVzb2x2ZWQgbGlua3MgaWYgXCJTaG93IGV4aXN0aW5nIG9ubHlcIiBpcyBkaXNhYmxlZFxuICAgIC8vIFRoaXMgbWF0Y2hlcyBRdWljayBTd2l0Y2ggKysgYmVoYXZpb3I6IHVucmVzb2x2ZWQ6ICFzZXR0aW5ncy5zaG93RXhpc3RpbmdPbmx5XG4gICAgY29uc3QgcXVpY2tTd2l0Y2hlck9wdGlvbnMgPSB0aGlzLmdldFF1aWNrU3dpdGNoZXJPcHRpb25zKCk7XG4gICAgY29uc3Qgc2hvd0V4aXN0aW5nT25seSA9IHF1aWNrU3dpdGNoZXJPcHRpb25zPy5zaG93RXhpc3RpbmdPbmx5ID8/IGZhbHNlO1xuXG4gICAgaWYgKCFzaG93RXhpc3RpbmdPbmx5KSB7XG4gICAgICAvLyBHZXQgdW5yZXNvbHZlZCBsaW5rcyBmcm9tIG1ldGFkYXRhIGNhY2hlIChsaWtlIFF1aWNrIFN3aXRjaCArKyBkb2VzKVxuICAgICAgY29uc3QgeyB1bnJlc29sdmVkTGlua3MgfSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGU7XG4gICAgICBjb25zdCB1bnJlc29sdmVkU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICAgIC8vIENvbGxlY3QgYWxsIHVucmVzb2x2ZWQgbGlua3MgZnJvbSBhbGwgZmlsZXNcbiAgICAgIGZvciAoY29uc3Qgc291cmNlUGF0aCBpbiB1bnJlc29sdmVkTGlua3MpIHtcbiAgICAgICAgY29uc3QgbGlua3MgPSBPYmplY3Qua2V5cyh1bnJlc29sdmVkTGlua3Nbc291cmNlUGF0aF0pO1xuICAgICAgICBsaW5rcy5mb3JFYWNoKGxpbmsgPT4gdW5yZXNvbHZlZFNldC5hZGQobGluaykpO1xuICAgICAgfVxuXG4gICAgICAvLyBTZWFyY2ggdW5yZXNvbHZlZCBsaW5rcyBhbmQgYWRkIG1hdGNoZXNcbiAgICAgIGZvciAoY29uc3QgdW5yZXNvbHZlZCBvZiB1bnJlc29sdmVkU2V0KSB7XG4gICAgICAgIGNvbnN0IHVucmVzb2x2ZWRNYXRjaCA9IHNlYXJjaCh1bnJlc29sdmVkKTtcbiAgICAgICAgaWYgKHVucmVzb2x2ZWRNYXRjaCAmJiB1bnJlc29sdmVkTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8gQWRkIGFzIGEgc3VnZ2VzdGlvbiB3aXRob3V0IGEgZmlsZSAodW5yZXNvbHZlZCBsaW5rKVxuICAgICAgICAgIC8vIFVzZSBhIHNwZWNpYWwgb2JqZWN0IHRvIHJlcHJlc2VudCB1bnJlc29sdmVkIGxpbmtzXG4gICAgICAgICAgY29uc3QgdW5yZXNvbHZlZEl0ZW06IFVucmVzb2x2ZWRMaW5rSXRlbSA9IHsgaXNVbnJlc29sdmVkOiB0cnVlLCB1bnJlc29sdmVkVGV4dDogdW5yZXNvbHZlZCB9O1xuICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICBpdGVtOiB1bnJlc29sdmVkSXRlbSxcbiAgICAgICAgICAgIG1hdGNoOiB1bnJlc29sdmVkTWF0Y2hcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgT2JzaWRpYW4ncyBuYXRpdmUgc29ydGluZyBmb3IgZXhhY3QgdmFuaWxsYSBjb21wYXRpYmlsaXR5XG4gICAgICBzb3J0U2VhcmNoUmVzdWx0cyhyZXN1bHRzKTtcblxuICAgICAgLy8gUG9zdC1zb3J0OiBtb3ZlIGV4Y2x1ZGVkIGZpbGVzIHRvIHRoZSBlbmQgKHN0YWJsZSBzb3J0KVxuICAgICAgY29uc3QgYmVoYXZpb3IgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5xdWlja1N3aXRjaGVyRXhjbHVkZWRCZWhhdmlvcjtcbiAgICAgIGlmIChiZWhhdmlvciAhPT0gJ2lnbm9yZScpIHtcbiAgICAgICAgcmVzdWx0cy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgY29uc3QgYUZpbGUgPSBhLml0ZW0gaW5zdGFuY2VvZiBURmlsZSA/IGEuaXRlbSA6IG51bGw7XG4gICAgICAgICAgY29uc3QgYkZpbGUgPSBiLml0ZW0gaW5zdGFuY2VvZiBURmlsZSA/IGIuaXRlbSA6IG51bGw7XG4gICAgICAgICAgY29uc3QgYUV4Y2x1ZGVkID0gYUZpbGUgPyBpc0V4Y2x1ZGVkKGFGaWxlLCB0aGlzLmFwcCkgOiBmYWxzZTtcbiAgICAgICAgICBjb25zdCBiRXhjbHVkZWQgPSBiRmlsZSA/IGlzRXhjbHVkZWQoYkZpbGUsIHRoaXMuYXBwKSA6IGZhbHNlO1xuXG4gICAgICAgICAgaWYgKGFFeGNsdWRlZCAmJiAhYkV4Y2x1ZGVkKSByZXR1cm4gMTtcbiAgICAgICAgICBpZiAoIWFFeGNsdWRlZCAmJiBiRXhjbHVkZWQpIHJldHVybiAtMTtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEZpbHRlciBvdXQgdW5yZXNvbHZlZCBsaW5rcyBpZiBcIlNob3cgZXhpc3Rpbmcgb25seVwiIGlzIGVuYWJsZWRcbiAgICAgIC8vIFVucmVzb2x2ZWQgbGlua3MgYXJlIGl0ZW1zIHdpdGggaXNVbnJlc29sdmVkIHByb3BlcnR5LCBidXQga2VlcCBcImNyZWF0ZSBuZXcgbm90ZVwiIG9wdGlvbnNcbiAgICAgIGxldCBmaWx0ZXJlZFJlc3VsdHMgPSByZXN1bHRzO1xuXG4gICAgICAvLyBGaWx0ZXIgb3V0IGV4Y2x1ZGVkIGZpbGVzIGlmIGJlaGF2aW9yIGlzICdoaWRlJ1xuICAgICAgaWYgKGJlaGF2aW9yID09PSAnaGlkZScpIHtcbiAgICAgICAgZmlsdGVyZWRSZXN1bHRzID0gZmlsdGVyZWRSZXN1bHRzLmZpbHRlcihyID0+IHtcbiAgICAgICAgICByZXR1cm4gIShyLml0ZW0gaW5zdGFuY2VvZiBURmlsZSAmJiBpc0V4Y2x1ZGVkKHIuaXRlbSwgdGhpcy5hcHApKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoc2hvd0V4aXN0aW5nT25seSkge1xuICAgICAgICBmaWx0ZXJlZFJlc3VsdHMgPSBmaWx0ZXJlZFJlc3VsdHMuZmlsdGVyKHIgPT4ge1xuICAgICAgICAgIC8vIEtlZXAgZmlsZXMgYW5kIG5ldyBub3RlIGl0ZW1zLCBmaWx0ZXIgb3V0IHVucmVzb2x2ZWQgbGlua3NcbiAgICAgICAgICByZXR1cm4gci5pdGVtIGluc3RhbmNlb2YgVEZpbGUgfHwgKCdpc05ld05vdGUnIGluIHIuaXRlbSAmJiByLml0ZW0uaXNOZXdOb3RlID09PSB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGZvciBleGFjdCBtYXRjaGVzIGluIGV4aXN0aW5nIGZpbGVzXG4gICAgICBjb25zdCBsb3dlclF1ZXJ5ID0gc2VhcmNoUXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICAgIGxldCBleGFjdE1hdGNoID0gZmlsdGVyZWRSZXN1bHRzLnNvbWUociA9PlxuICAgICAgICByLml0ZW0gaW5zdGFuY2VvZiBURmlsZSAmJiAoXG4gICAgICAgICAgdGhpcy5nZXREaXNwbGF5TmFtZShyLml0ZW0pLnRvTG93ZXJDYXNlKCkgPT09IGxvd2VyUXVlcnkgfHxcbiAgICAgICAgICAodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2ggJiYgci5pdGVtLmJhc2VuYW1lLnRvTG93ZXJDYXNlKCkgPT09IGxvd2VyUXVlcnkpIHx8XG4gICAgICAgICAgKHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVBbGlhc2VzSW5TZWFyY2ggJiYgdGhpcy5maWxlQ2FjaGUuZ2V0KHIuaXRlbS5wYXRoKT8uYWxpYXNlcy5zb21lKGFsaWFzID0+IGFsaWFzLnRvTG93ZXJDYXNlKCkgPT09IGxvd2VyUXVlcnkpKVxuICAgICAgICApXG4gICAgICApO1xuXG4gICAgICAvLyBBbHNvIGNoZWNrIHVucmVzb2x2ZWQgbGlua3MgaWYgdGhleSdyZSBiZWluZyBzaG93blxuICAgICAgaWYgKCFzaG93RXhpc3RpbmdPbmx5ICYmICFleGFjdE1hdGNoKSB7XG4gICAgICAgIGNvbnN0IHsgdW5yZXNvbHZlZExpbmtzIH0gPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlO1xuICAgICAgICBjb25zdCB1bnJlc29sdmVkU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICAgIGZvciAoY29uc3Qgc291cmNlUGF0aCBpbiB1bnJlc29sdmVkTGlua3MpIHtcbiAgICAgICAgICBjb25zdCBsaW5rcyA9IE9iamVjdC5rZXlzKHVucmVzb2x2ZWRMaW5rc1tzb3VyY2VQYXRoXSk7XG4gICAgICAgICAgbGlua3MuZm9yRWFjaChsaW5rID0+IHVucmVzb2x2ZWRTZXQuYWRkKGxpbmspKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDaGVjayBpZiBxdWVyeSBleGFjdGx5IG1hdGNoZXMgYW55IHVucmVzb2x2ZWQgbGlua1xuICAgICAgICBleGFjdE1hdGNoID0gQXJyYXkuZnJvbSh1bnJlc29sdmVkU2V0KS5zb21lKGxpbmsgPT4gbGluay50b0xvd2VyQ2FzZSgpID09PSBsb3dlclF1ZXJ5KTtcbiAgICAgIH1cblxuICAgICAgLy8gQWx3YXlzIGFkZCBuZXcgbm90ZSBvcHRpb24gaWYgbm8gcmVzdWx0c1xuICAgICAgLy8gXCJTaG93IGV4aXN0aW5nIG9ubHlcIiBvbmx5IGFmZmVjdHMgc2hvd2luZyB1bnJlc29sdmVkIGxpbmtzLCBub3QgY3JlYXRpbmcgbmV3IG5vdGVzXG4gICAgICBpZiAoZmlsdGVyZWRSZXN1bHRzLmxlbmd0aCA9PT0gMCAmJiBzZWFyY2hRdWVyeSkge1xuICAgICAgICBjb25zdCBuZXdJdGVtOiBOZXdOb3RlSXRlbSA9IHsgaXNOZXdOb3RlOiB0cnVlLCBuZXdOYW1lOiBzZWFyY2hRdWVyeSB9O1xuICAgICAgICBmaWx0ZXJlZFJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgaXRlbTogbmV3SXRlbSxcbiAgICAgICAgICBtYXRjaDogeyBzY29yZTogMTAwMCwgbWF0Y2hlczogW1swLCBzZWFyY2hRdWVyeS5sZW5ndGhdXSB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZpbHRlcmVkUmVzdWx0cy5zbGljZSgwLCB0aGlzLmxpbWl0KTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIHVwZGF0aW5nIHF1aWNrIHN3aXRjaGVyIHN1Z2dlc3Rpb25zLiBQbGVhc2UgY2hlY2sgY29uc29sZSBmb3IgZGV0YWlscy4nKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICByZW5kZXJTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+LCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICBjb25zdCB7IGl0ZW0gfSA9IHN1Z2dlc3Rpb247XG5cbiAgICAvLyBDaGVjayBpZiB0aGlzIGl0ZW0gaXMgYW4gZXhjbHVkZWQgZmlsZVxuICAgIGlmIChpdGVtIGluc3RhbmNlb2YgVEZpbGUgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MucXVpY2tTd2l0Y2hlckV4Y2x1ZGVkQmVoYXZpb3IgPT09ICdkZWVtcGhhc2l6ZScgJiYgaXNFeGNsdWRlZChpdGVtLCB0aGlzLmFwcCkpIHtcbiAgICAgIGVsLmFkZENsYXNzKCdtb2QtZXhjbHVkZWQnKTtcbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgdW5yZXNvbHZlZCBsaW5rcyAtIHNob3cgZmlsZS1wbHVzIGljb24gaW5zdGVhZCBvZiBcIkVudGVyIHRvIGNyZWF0ZVwiIHRleHRcbiAgICBpZiAoJ2lzVW5yZXNvbHZlZCcgaW4gaXRlbSAmJiBpdGVtLmlzVW5yZXNvbHZlZCkge1xuICAgICAgY29uc3QgdW5yZXNvbHZlZFRleHQgPSBpdGVtLnVucmVzb2x2ZWRUZXh0O1xuICAgICAgZWwuZW1wdHkoKTtcbiAgICAgIGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRlbnQgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWNvbnRlbnQnIH0pO1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvblRpdGxlID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScgfSk7XG4gICAgICBzdWdnZXN0aW9uVGl0bGUuc2V0VGV4dCh1bnJlc29sdmVkVGV4dCk7XG4gICAgICBjb25zdCBzdWdnZXN0aW9uQXV4ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvbkZsYWlyID0gc3VnZ2VzdGlvbkF1eC5jcmVhdGVTcGFuKHtcbiAgICAgICAgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicsXG4gICAgICAgIGF0dHI6IHsgJ2FyaWEtbGFiZWwnOiAnVW5yZXNvbHZlZCBsaW5rIC0gRW50ZXIgdG8gY3JlYXRlJyB9XG4gICAgICB9KTtcbiAgICAgIHRoaXMuY3JlYXRlRmlsZVBsdXNJY29uKHN1Z2dlc3Rpb25GbGFpcik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdGV4dCA9IHRoaXMuZ2V0SXRlbVRleHQoaXRlbSk7XG5cbiAgICBpZiAoJ2lzTmV3Tm90ZScgaW4gaXRlbSkge1xuICAgICAgLy8gRm9yIG5ldyBub3RlcywgdXNlIHRoZSBleGFjdCBIVE1MIHN0cnVjdHVyZSBmcm9tIGRlZmF1bHQgT2JzaWRpYW5cbiAgICAgIGVsLmVtcHR5KCk7XG4gICAgICBlbC5hZGRDbGFzcygnbW9kLWNvbXBsZXgnKTtcblxuICAgICAgLy8gTWFpbiBzdWdnZXN0aW9uIGNvbnRlbnRcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25UaXRsZSA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnIH0pO1xuICAgICAgc3VnZ2VzdGlvblRpdGxlLnNldFRleHQodGV4dCk7XG5cbiAgICAgIC8vIEFkZCBcIkVudGVyIHRvIGNyZWF0ZVwiIHRleHQgb24gdGhlIHJpZ2h0IHVzaW5nIHRoZSBjb3JyZWN0IGNsYXNzXG4gICAgICBjb25zdCBzdWdnZXN0aW9uQXV4ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvbkFjdGlvbiA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IGNsczogJ3N1Z2dlc3Rpb24tYWN0aW9uJyB9KTtcbiAgICAgIHN1Z2dlc3Rpb25BY3Rpb24uc2V0VGV4dCgnRW50ZXIgdG8gY3JlYXRlJyk7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBXaGVuIGRpc2FibGVkLCB1c2UgZGVmYXVsdCBPYnNpZGlhbiBzdHlsaW5nIChubyBjdXN0b20gY2xhc3NlcyBvciBpY29ucylcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIpIHtcbiAgICAgIC8vIFVzZSBkZWZhdWx0IE9ic2lkaWFuIHNpbmdsZS1saW5lIGRpc3BsYXlcbiAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZWwuc2V0VGV4dChpdGVtLnBhdGgucmVwbGFjZSgnLm1kJywgJycpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsLnNldFRleHQodGV4dCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFdoZW4gZW5hYmxlZCwgdXNlIG91ciBjdXN0b20gc3R5bGluZyB3aXRoIGljb25zXG4gICAgICAvLyBPbmx5IHNob3cgaWNvbnMgZm9yIFRGaWxlIGl0ZW1zLCBub3QgdW5yZXNvbHZlZCBsaW5rc1xuICAgICAgaWYgKCEoaXRlbSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICBlbC5zZXRUZXh0KHRleHQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoaXMgZmlsZSBoYXMgYSBjdXN0b20gcHJvcGVydHlcbiAgICAgIGNvbnN0IGNhY2hlZERhdGEgPSB0aGlzLmZpbGVDYWNoZS5nZXQoaXRlbS5wYXRoKTtcbiAgICAgIGNvbnN0IGlzQ3VzdG9tRGlzcGxheSA9IGNhY2hlZERhdGE/LmlzQ3VzdG9tRGlzcGxheSA/PyBmYWxzZTtcbiAgICAgIGNvbnN0IG1hdGNoUmVhc29uID0gdGhpcy5tYXRjaFJlYXNvbnMuZ2V0KGl0ZW0ucGF0aCk7XG5cbiAgICAgIC8vIFNwZWNpYWwgY2FzZTogbm90ZXMgd2l0aG91dCBwcm9wZXJ0eSB0aGF0IG1hdGNoZWQgdmlhIGFsaWFzIHNob3VsZCBzaG93IGFsaWFzIHdpdGggaWNvblxuICAgICAgaWYgKCFpc0N1c3RvbURpc3BsYXkgJiYgbWF0Y2hSZWFzb24/Lm1hdGNoZWRJbkFsaWFzICYmIG1hdGNoUmVhc29uLm1hdGNoZWRBbGlhc1RleHQpIHtcbiAgICAgICAgLy8gU2hvdyBhbGlhcyBhcyBtYWluIHRleHQsIGZpbGVuYW1lIGJlbG93LCB3aXRoIGFsaWFzIGljb24gKGxpa2UgZGVmYXVsdCBPYnNpZGlhbilcbiAgICAgICAgZWwuYWRkQ2xhc3MoJ21vZC1jb21wbGV4Jyk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcblxuICAgICAgICAvLyBNYWluIHRpdGxlIC0gc2hvdyB0aGUgYWxpYXMgdGhhdCBtYXRjaGVkXG4gICAgICAgIGNvbnN0IHRpdGxlRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJyB9KTtcbiAgICAgICAgdGl0bGVFbC5zZXRUZXh0KG1hdGNoUmVhc29uLm1hdGNoZWRBbGlhc1RleHQpO1xuXG4gICAgICAgIC8vIEZpbGUgcGF0aCBiZWxvd1xuICAgICAgICBjb25zdCBwYXRoRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLW5vdGUnIH0pO1xuICAgICAgICBwYXRoRWwuc2V0VGV4dChpdGVtLnBhdGgucmVwbGFjZSgnLm1kJywgJycpKTtcblxuICAgICAgICAvLyBBZGQgc3VnZ2VzdGlvbi1hdXggd2l0aCBhbGlhcyBpY29uXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25BdXggPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7XG4gICAgICAgICAgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicsXG4gICAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6ICdBbGlhcyBNYXRjaCcgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVGb3J3YXJkSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgfSBlbHNlIGlmIChpc0N1c3RvbURpc3BsYXkpIHtcbiAgICAgICAgLy8gTm90ZXMgd2l0aCB0aGUgcHJvcGVydHkgLSBrZWVwIGV4aXN0aW5nIGJlaGF2aW9yXG4gICAgICAgIGNvbnN0IHNob3VsZFNob3dJY29uID0gbWF0Y2hSZWFzb24gJiYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlIHx8IG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lIHx8IG1hdGNoUmVhc29uLm1hdGNoZWRJbkFsaWFzKTtcblxuICAgICAgICBpZiAoc2hvdWxkU2hvd0ljb24pIHtcbiAgICAgICAgICAvLyBBZGQgbW9kLWNvbXBsZXggY2xhc3MgdG8gbWF0Y2ggT2JzaWRpYW4ncyBzdHJ1Y3R1cmVcbiAgICAgICAgICBlbC5hZGRDbGFzcygnbW9kLWNvbXBsZXgnKTtcblxuICAgICAgICAgIC8vIENyZWF0ZSB0aGUgbWFpbiBzdWdnZXN0aW9uIGNvbnRhaW5lclxuICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcblxuICAgICAgICAgIC8vIE1haW4gdGl0bGVcbiAgICAgICAgICBjb25zdCB0aXRsZUVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScgfSk7XG4gICAgICAgICAgdGl0bGVFbC5zZXRUZXh0KHRleHQpO1xuXG4gICAgICAgICAgLy8gRmlsZSBwYXRoIGJlbG93XG4gICAgICAgICAgY29uc3QgcGF0aEVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1ub3RlJyB9KTtcbiAgICAgICAgICBwYXRoRWwuc2V0VGV4dChpdGVtLnBhdGgucmVwbGFjZSgnLm1kJywgJycpKTtcblxuICAgICAgICAgIC8vIEFkZCBzdWdnZXN0aW9uLWF1eCB3aXRoIGFwcHJvcHJpYXRlIGljb24gYmFzZWQgb24gbWF0Y2ggcmVhc29uXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uRmxhaXIgPSBzdWdnZXN0aW9uQXV4LmNyZWF0ZVNwYW4oe1xuICAgICAgICAgICAgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicsXG4gICAgICAgICAgICBhdHRyOiB7ICdhcmlhLWxhYmVsJzogdGhpcy5nZXRJY29uTGFiZWwobWF0Y2hSZWFzb24pIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIERldGVybWluZSBpY29uIGJhc2VkIG9uIHByaW9yaXR5OiB0aXRsZSA+IGZpbGUgbmFtZSA+IGFsaWFzXG4gICAgICAgICAgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlKSB7XG4gICAgICAgICAgICAvLyBUeXBlIGljb24gZm9yIHRpdGxlL3Byb3BlcnR5IG1hdGNoZXNcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVHlwZUljb24oc3VnZ2VzdGlvbkZsYWlyKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lKSB7XG4gICAgICAgICAgICAvLyBGaWxlIGljb24gZm9yIGZpbGUgbmFtZSBtYXRjaGVzXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUZpbGVJY29uKHN1Z2dlc3Rpb25GbGFpcik7XG4gICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcykge1xuICAgICAgICAgICAgLy8gQXJyb3cgaWNvbiBmb3IgYWxpYXMgbWF0Y2hlc1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVGb3J3YXJkSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBOb3RlIGhhcyBwcm9wZXJ0eSBidXQgbm8gbWF0Y2ggcmVhc29uIChlLmcuLCByZWNlbnQgZmlsZXMpXG4gICAgICAgICAgLy8gU2hvdyBjb21wbGV4IGxheW91dCB3aXRoIGljb24gaWYgdXNpbmcgcHJvcGVydHktYmFzZWQgdGl0bGVcbiAgICAgICAgICBlbC5hZGRDbGFzcygnbW9kLWNvbXBsZXgnKTtcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XG4gICAgICAgICAgY29uc3QgdGl0bGVFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnIH0pO1xuICAgICAgICAgIHRpdGxlRWwuc2V0VGV4dCh0ZXh0KTtcbiAgICAgICAgICBjb25zdCBwYXRoRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLW5vdGUnIH0pO1xuICAgICAgICAgIHBhdGhFbC5zZXRUZXh0KGl0ZW0ucGF0aC5yZXBsYWNlKCcubWQnLCAnJykpO1xuXG4gICAgICAgICAgLy8gU2hvdyBcIlRcIiBpY29uIGZvciBwcm9wZXJ0eS1iYXNlZCB0aXRsZXNcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQXV4ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xuICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7XG4gICAgICAgICAgICBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJyxcbiAgICAgICAgICAgIGF0dHI6IHsgJ2FyaWEtbGFiZWwnOiAnUHJvcGVydHktYmFzZWQgdGl0bGUnIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLmNyZWF0ZVR5cGVJY29uKHN1Z2dlc3Rpb25GbGFpcik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciBub3RlcyB3aXRob3V0IHRoZSBwcm9wZXJ0eSAoYW5kIG5vdCBtYXRjaGVkIHZpYSBhbGlhcyksIHNob3cgc2ltcGxlIGRpc3BsYXkgKG5vIGljb24sIG5vIGR1cGxpY2F0ZSBuYW1lKVxuICAgICAgICBlbC5zZXRUZXh0KHRleHQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0SWNvbkxhYmVsKG1hdGNoUmVhc29uOiBTZWFyY2hNYXRjaFJlYXNvbik6IHN0cmluZyB7XG4gICAgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlKSB7XG4gICAgICByZXR1cm4gJ1RpdGxlL1Byb3BlcnR5IE1hdGNoJztcbiAgICB9IGVsc2UgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lKSB7XG4gICAgICByZXR1cm4gJ0ZpbGUgTmFtZSBNYXRjaCc7XG4gICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcykge1xuICAgICAgcmV0dXJuICdBbGlhcyBNYXRjaCc7XG4gICAgfVxuICAgIHJldHVybiAnTWF0Y2gnO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVUeXBlSWNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd3aWR0aCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCAncm91bmQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcbiAgICBzdmcuY2xhc3NMaXN0LmFkZCgnc3ZnLWljb24nLCAnbHVjaWRlLXR5cGUnKTtcblxuICAgIGNvbnN0IHBvbHlsaW5lMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcbiAgICBwb2x5bGluZTEuc2V0QXR0cmlidXRlKCdwb2ludHMnLCAnNCA3IDQgNCAyMCA0IDIwIDcnKTtcbiAgICBzdmcuYXBwZW5kQ2hpbGQocG9seWxpbmUxKTtcblxuICAgIGNvbnN0IGxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MScsICc5Jyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MScsICcyMCcpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDInLCAnMTUnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kyJywgJzIwJyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUxKTtcblxuICAgIGNvbnN0IGxpbmUyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MScsICcxMicpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnNCcpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDInLCAnMTInKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kyJywgJzIwJyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcblxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzdmcpO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVGaWxlSWNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd3aWR0aCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCAncm91bmQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcbiAgICBzdmcuY2xhc3NMaXN0LmFkZCgnc3ZnLWljb24nLCAnbHVjaWRlLWZpbGUtdGV4dCcpO1xuXG4gICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpO1xuICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgJ00xNC41IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY3LjVMMTQuNSAyeicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcblxuICAgIGNvbnN0IHBvbHlsaW5lMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcbiAgICBwb2x5bGluZTEuc2V0QXR0cmlidXRlKCdwb2ludHMnLCAnMTQsMiAxNCw4IDIwLDgnKTtcbiAgICBzdmcuYXBwZW5kQ2hpbGQocG9seWxpbmUxKTtcblxuICAgIGNvbnN0IGxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MScsICcxNicpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneTEnLCAnMTMnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gyJywgJzgnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kyJywgJzEzJyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUxKTtcblxuICAgIGNvbnN0IGxpbmUyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MScsICcxNicpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnMTcnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzgnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kyJywgJzE3Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcblxuICAgIGNvbnN0IHBvbHlsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcbiAgICBwb2x5bGluZTIuc2V0QXR0cmlidXRlKCdwb2ludHMnLCAnMTAsOSA5LDkgOCw5Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lMik7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3ZnKTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlRm9yd2FyZEljb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAyNCAyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XG4gICAgc3ZnLmNsYXNzTGlzdC5hZGQoJ3N2Zy1pY29uJywgJ2x1Y2lkZS1mb3J3YXJkJyk7XG5cbiAgICBjb25zdCBwb2x5bGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcbiAgICBwb2x5bGluZS5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcxNSAxNyAyMCAxMiAxNSA3Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lKTtcblxuICAgIGNvbnN0IHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTtcbiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZCcsICdNNCAxOHYtMmE0IDQgMCAwIDEgNC00aDEyJyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBhdGgpO1xuXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN2Zyk7XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUZpbGVQbHVzSWNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd3aWR0aCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCAncm91bmQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcbiAgICBzdmcuY2xhc3NMaXN0LmFkZCgnc3ZnLWljb24nLCAnbHVjaWRlLWZpbGUtcGx1cycpO1xuXG4gICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpO1xuICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgJ00xNC41IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY3LjVMMTQuNSAyeicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcblxuICAgIGNvbnN0IHBvbHlsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5bGluZScpO1xuICAgIHBvbHlsaW5lLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzE0LDIgMTQsOCAyMCw4Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lKTtcblxuICAgIGNvbnN0IGxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MScsICcxMicpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneTEnLCAnMTgnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gyJywgJzEyJyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MicsICcxMicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMSk7XG5cbiAgICBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnOScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnMTUnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzE1Jyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcxNScpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3ZnKTtcbiAgfVxuXG4gIHByaXZhdGUgaXNVc2luZ0N1c3RvbVByb3BlcnR5KGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlcjtcbiAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gZnJvbnRtYXR0ZXI/Llt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gYXMgdW5rbm93bjtcbiAgICBpZiAocHJvcGVydHlWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHByb3BlcnR5VmFsdWUgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3Qgc3RyVmFsdWUgPSB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ3N0cmluZycgPyBwcm9wZXJ0eVZhbHVlIDogKHR5cGVvZiBwcm9wZXJ0eVZhbHVlID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ2Jvb2xlYW4nID8gU3RyaW5nKHByb3BlcnR5VmFsdWUpIDogJycpO1xuICAgIHJldHVybiBzdHJWYWx1ZS50cmltKCkgIT09ICcnO1xuICB9XG5cbiAgcHJpdmF0ZSBpc1VzaW5nQWxpYXMoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcbiAgICAvLyBDaGVjayBpZiB0aGlzIGZpbGUgaGFzIGFsaWFzZXMgYW5kIGlmIHdlJ3JlIGN1cnJlbnRseSBzZWFyY2hpbmdcbiAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gY2FjaGU/LmZyb250bWF0dGVyO1xuICAgIGNvbnN0IGFsaWFzZXMgPSBmcm9udG1hdHRlcj8uYWxpYXNlcyBhcyB1bmtub3duO1xuXG4gICAgaWYgKCFhbGlhc2VzKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBGb3Igbm93LCBzaG93IGFsaWFzIGljb24gaWYgdGhlIGZpbGUgaGFzIGFsaWFzZXMgYW5kIHdlJ3JlIG5vdCB1c2luZyBhIGN1c3RvbSBwcm9wZXJ0eVxuICAgIGNvbnN0IGlzVXNpbmdDdXN0b21Qcm9wZXJ0eSA9IHRoaXMuaXNVc2luZ0N1c3RvbVByb3BlcnR5KGZpbGUpO1xuICAgIHJldHVybiAhaXNVc2luZ0N1c3RvbVByb3BlcnR5ICYmIEJvb2xlYW4oYWxpYXNlcyk7XG4gIH1cblxuICBvbkNob29zZUl0ZW0oaXRlbTogUXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAvLyBIYW5kbGUgdW5yZXNvbHZlZCBsaW5rcyAtIGNyZWF0ZSB0aGUgZmlsZSB1c2luZyBvcGVuTGlua1RleHQgdG8gcmVzcGVjdCBuZXcgbm90ZSBsb2NhdGlvbiBzZXR0aW5nc1xuICAgIGlmICgnaXNVbnJlc29sdmVkJyBpbiBpdGVtICYmIGl0ZW0uaXNVbnJlc29sdmVkKSB7XG4gICAgICBjb25zdCB1bnJlc29sdmVkVGV4dCA9IGl0ZW0udW5yZXNvbHZlZFRleHQ7XG4gICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgIGNvbnN0IHNvdXJjZVBhdGggPSBhY3RpdmVWaWV3Py5maWxlPy5wYXRoIHx8ICcnO1xuXG4gICAgICAvLyBVc2Ugb3BlbkxpbmtUZXh0IHdoaWNoIHJlc3BlY3RzIE9ic2lkaWFuJ3MgZGVmYXVsdCBuZXcgbm90ZSBsb2NhdGlvbiBzZXR0aW5nc1xuICAgICAgdm9pZCB0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHVucmVzb2x2ZWRUZXh0LCBzb3VyY2VQYXRoKS5jYXRjaCgoZXJyOiB1bmtub3duKSA9PiB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogU3RyaW5nKGVycik7XG4gICAgICAgIG5ldyBOb3RpY2UoYEVycm9yIGNyZWF0aW5nIG5vdGU6ICR7bWVzc2FnZX1gKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICgnaXNOZXdOb3RlJyBpbiBpdGVtKSB7XG4gICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgIGNvbnN0IHNvdXJjZVBhdGggPSBhY3RpdmVWaWV3Py5maWxlPy5wYXRoIHx8ICcnO1xuXG4gICAgICAvLyBVc2Ugb3BlbkxpbmtUZXh0IHdoaWNoIHJlc3BlY3RzIE9ic2lkaWFuJ3MgZGVmYXVsdCBuZXcgbm90ZSBsb2NhdGlvbiBzZXR0aW5nc1xuICAgICAgdm9pZCB0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KGl0ZW0ubmV3TmFtZSwgc291cmNlUGF0aCkuY2F0Y2goKGVycjogdW5rbm93bikgPT4ge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6IFN0cmluZyhlcnIpO1xuICAgICAgICBuZXcgTm90aWNlKGBFcnJvciBjcmVhdGluZyBub3RlOiAke21lc3NhZ2V9YCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGl0ZW0gaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgLy8gSGFuZGxlIGRpZmZlcmVudCBtb2RpZmllciBrZXlzIGxpa2UgZGVmYXVsdCBPYnNpZGlhblxuICAgICAgaWYgKGV2dCBpbnN0YW5jZW9mIEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgaWYgKGV2dC5jdHJsS2V5ICYmIGV2dC5hbHRLZXkpIHtcbiAgICAgICAgICAvLyBPcGVuIHRvIHRoZSByaWdodFxuICAgICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKTtcbiAgICAgICAgICB2b2lkIGxlYWYub3BlbkZpbGUoaXRlbSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZ0LmN0cmxLZXkpIHtcbiAgICAgICAgICAvLyBPcGVuIGluIG5ldyB0YWJcbiAgICAgICAgICB2b2lkIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkub3BlbkZpbGUoaXRlbSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZ0LnNoaWZ0S2V5KSB7XG4gICAgICAgICAgLy8gQ3JlYXRlIG5ldyBub3RlIHdpdGggdGhlIGV4YWN0IHNlYXJjaCBxdWVyeSwgbGlrZSBkZWZhdWx0IHF1aWNrIHN3aXRjaGVyXG4gICAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgICAgY29uc3Qgc291cmNlUGF0aCA9IGFjdGl2ZVZpZXc/LmZpbGU/LnBhdGggfHwgJyc7XG4gICAgICAgICAgY29uc3QgY3VycmVudFF1ZXJ5ID0gdGhpcy5pbnB1dEVsLnZhbHVlLnRyaW0oKTtcblxuICAgICAgICAgIGlmIChjdXJyZW50UXVlcnkpIHtcbiAgICAgICAgICAgIHZvaWQgdGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChjdXJyZW50UXVlcnksIHNvdXJjZVBhdGgpLmNhdGNoKChlcnI6IHVua25vd24pID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiBTdHJpbmcoZXJyKTtcbiAgICAgICAgICAgICAgbmV3IE5vdGljZShgRXJyb3IgY3JlYXRpbmcgbm90ZTogJHttZXNzYWdlfWApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIERlZmF1bHQ6IG9wZW4gaW4gY3VycmVudCB0YWIgaWYgc2VhcmNoIHF1ZXJ5IGlzIGVtcHR5XG4gICAgICAgICAgICB2b2lkIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkub3BlbkZpbGUoaXRlbSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIERlZmF1bHQ6IG9wZW4gaW4gY3VycmVudCB0YWJcbiAgICAgICAgICB2b2lkIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkub3BlbkZpbGUoaXRlbSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1vdXNlIGNsaWNrOiBkZWZhdWx0IGJlaGF2aW9yXG4gICAgICAgIHZvaWQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShpdGVtKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuIiwgImltcG9ydCB7IFBsdWdpbiwgVEZpbGUsIEFwcCwgUGx1Z2luTWFuaWZlc3QgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFBsdWdpblNldHRpbmdzLCBXb3Jrc3BhY2VJbnRlcm5hbCwgRWRpdG9yU3VnZ2VzdCB9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zZXR0aW5ncyc7XHJcbmltcG9ydCB7IExpbmtUaXRsZVN1Z2dlc3QgfSBmcm9tICcuL3VpL0xpbmtUaXRsZVN1Z2dlc3QnO1xyXG5pbXBvcnQgeyBTZXR0aW5nVGFiIH0gZnJvbSAnLi91aS9TZXR0aW5nVGFiJztcclxuaW1wb3J0IHsgcmVnaXN0ZXJDb21tYW5kcyB9IGZyb20gJy4vY29tbWFuZHMnO1xyXG5pbXBvcnQgeyBRdWlja1N3aXRjaGVyU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvUXVpY2tTd2l0Y2hlclNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEcmFnRHJvcFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL0RyYWdEcm9wU2VydmljZSc7XHJcbmltcG9ydCB7IENhY2hlU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvQ2FjaGVTZXJ2aWNlJztcclxuaW1wb3J0IHsgR3JhcGhWaWV3U2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvR3JhcGhWaWV3U2VydmljZSc7XHJcbmltcG9ydCB7IEJhY2tsaW5rU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvQmFja2xpbmtTZXJ2aWNlJztcclxuaW1wb3J0IHsgVGFiU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvVGFiU2VydmljZSc7XHJcbmltcG9ydCB7IEV4cGxvcmVyU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvRXhwbG9yZXJTZXJ2aWNlJztcclxuaW1wb3J0IHsgV2luZG93RnJhbWVTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9XaW5kb3dGcmFtZVNlcnZpY2UnO1xyXG5pbXBvcnQgeyBCb29rbWFya1NlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL0Jvb2ttYXJrU2VydmljZSc7XHJcbmltcG9ydCB7IGZyb250bWF0dGVyQ2FjaGUgfSBmcm9tICcuL3V0aWxzL2Zyb250bWF0dGVyLWNhY2hlJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICBzZXR0aW5ncyE6IFBsdWdpblNldHRpbmdzO1xyXG4gIHN1Z2dlc3Q/OiBMaW5rVGl0bGVTdWdnZXN0O1xyXG4gIHByaXZhdGUgcXVpY2tTd2l0Y2hlclNlcnZpY2UhOiBRdWlja1N3aXRjaGVyU2VydmljZTtcclxuICBwcml2YXRlIGRyYWdEcm9wU2VydmljZSE6IERyYWdEcm9wU2VydmljZTtcclxuICBwcml2YXRlIGNhY2hlU2VydmljZSE6IENhY2hlU2VydmljZTtcclxuICBwcml2YXRlIGdyYXBoVmlld1NlcnZpY2UhOiBHcmFwaFZpZXdTZXJ2aWNlO1xyXG4gIHByaXZhdGUgYmFja2xpbmtTZXJ2aWNlITogQmFja2xpbmtTZXJ2aWNlO1xyXG4gIHByaXZhdGUgdGFiU2VydmljZSE6IFRhYlNlcnZpY2U7XHJcbiAgcHJpdmF0ZSBleHBsb3JlclNlcnZpY2UhOiBFeHBsb3JlclNlcnZpY2U7XHJcbiAgcHJpdmF0ZSB3aW5kb3dGcmFtZVNlcnZpY2UhOiBXaW5kb3dGcmFtZVNlcnZpY2U7XHJcbiAgcHJpdmF0ZSBib29rbWFya1NlcnZpY2UhOiBCb29rbWFya1NlcnZpY2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBtYW5pZmVzdDogUGx1Z2luTWFuaWZlc3QpIHtcclxuICAgIHN1cGVyKGFwcCwgbWFuaWZlc3QpO1xyXG5cclxuICAgIC8vIFJlZ2lzdGVyIE1EWCBleHRlbnNpb24gYXMgZWFybHkgYXMgcG9zc2libGVcclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMucmVnaXN0ZXJFeHRlbnNpb25zKFsnbWR4J10sICdtYXJrZG93bicpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gTURYIGV4dGVuc2lvbiBhbHJlYWR5IHJlZ2lzdGVyZWQgYnkgYW5vdGhlciBwbHVnaW4gaXMgbm9ybWFsXHJcbiAgICAgIGNvbnN0IGVycm9yTXNnID0gKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlO1xyXG4gICAgICBpZiAoIWVycm9yTXNnLmluY2x1ZGVzKCdleGlzdGluZyBmaWxlIGV4dGVuc2lvbicpKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignW1BPVl0gVW5leHBlY3RlZCBNRFggcmVnaXN0cmF0aW9uIGVycm9yIGluIGNvbnN0cnVjdG9yOicsIGVycm9yTXNnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuXHJcbiAgICAvLyByZWdpc3RlciB0aGUgdmlldyBhbmQgZXh0ZW5zaW9uc1xyXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFeHRlbnNpb25zKFsnbWR4J10sICdtYXJrZG93bicpO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnN0IGVycm9yTXNnID0gKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlO1xyXG4gICAgICAgIGlmICghZXJyb3JNc2cuaW5jbHVkZXMoJ2V4aXN0aW5nIGZpbGUgZXh0ZW5zaW9uJykpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgTURYIHJlZ2lzdHJhdGlvbiBlcnJvcjonLCBlcnJvck1zZyk7XHJcbiAgICAgICAgICB0aGlzLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEZvcmNlIG1ldGFkYXRhIGNhY2hlIHJlZnJlc2ggZm9yIE1EWCBmaWxlcyB0byBlbnN1cmUgdGhleSdyZSByZWNvZ25pemVkXHJcbiAgICAgIGNvbnN0IG1keEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoZiA9PiBmLmV4dGVuc2lvbiA9PT0gJ21keCcpO1xyXG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgbWR4RmlsZXMpIHtcclxuICAgICAgICB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLnRyaWdnZXIoJ2NoYW5nZWQnLCBmaWxlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEluaXRpYWxpemUgc2VydmljZXNcclxuICAgIHRoaXMucXVpY2tTd2l0Y2hlclNlcnZpY2UgPSBuZXcgUXVpY2tTd2l0Y2hlclNlcnZpY2UodGhpcyk7XHJcbiAgICB0aGlzLmRyYWdEcm9wU2VydmljZSA9IG5ldyBEcmFnRHJvcFNlcnZpY2UodGhpcyk7XHJcbiAgICB0aGlzLmNhY2hlU2VydmljZSA9IG5ldyBDYWNoZVNlcnZpY2UodGhpcyk7XHJcbiAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2UgPSBuZXcgR3JhcGhWaWV3U2VydmljZSh0aGlzKTtcclxuICAgIHRoaXMuYmFja2xpbmtTZXJ2aWNlID0gbmV3IEJhY2tsaW5rU2VydmljZSh0aGlzKTtcclxuICAgIHRoaXMudGFiU2VydmljZSA9IG5ldyBUYWJTZXJ2aWNlKHRoaXMpO1xyXG4gICAgdGhpcy5leHBsb3JlclNlcnZpY2UgPSBuZXcgRXhwbG9yZXJTZXJ2aWNlKHRoaXMpO1xyXG4gICAgdGhpcy53aW5kb3dGcmFtZVNlcnZpY2UgPSBuZXcgV2luZG93RnJhbWVTZXJ2aWNlKHRoaXMpO1xyXG4gICAgdGhpcy5ib29rbWFya1NlcnZpY2UgPSBuZXcgQm9va21hcmtTZXJ2aWNlKHRoaXMpO1xyXG5cclxuICAgIC8vIFJlZ2lzdGVyIHRhYiBzZXJ2aWNlIGV2ZW50cyBhbmQgcmVuYW1lIHRhYnMgaW1tZWRpYXRlbHlcclxuICAgIHRoaXMudGFiU2VydmljZS5yZWdpc3RlckV2ZW50cygpO1xyXG5cclxuICAgIC8vIFJlZ2lzdGVyIGV4cGxvcmVyIGFuZCB3aW5kb3cgZnJhbWUgc2VydmljZXNcclxuICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnJlZ2lzdGVyRXZlbnRzKCk7XHJcbiAgICB0aGlzLndpbmRvd0ZyYW1lU2VydmljZS5yZWdpc3RlckV2ZW50cygpO1xyXG5cclxuICAgIC8vIEluaXRpYWxpemUgYm9va21hcmtzIHNlcnZpY2VcclxuICAgIHRoaXMuYm9va21hcmtTZXJ2aWNlLnVwZGF0ZUJvb2ttYXJrcygpO1xyXG5cclxuICAgIC8vIFByZS1wb3B1bGF0ZSBmcm9udG1hdHRlciBjYWNoZSBmb3IgTURYIGZpbGVzIGlmIGVuYWJsZWRcclxuICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpIHtcclxuICAgICAgKCgpID0+IHtcclxuICAgICAgICBjb25zdCBtZHhGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKFxyXG4gICAgICAgICAgKGYpOiBmIGlzIFRGaWxlID0+IGYgaW5zdGFuY2VvZiBURmlsZSAmJiBmLmV4dGVuc2lvbiA9PT0gJ21keCdcclxuICAgICAgICApO1xyXG4gICAgICAgIC8vIFByZS1wb3B1bGF0ZSBjYWNoZSBpbiBiYWNrZ3JvdW5kXHJcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIG1keEZpbGVzKSB7XHJcbiAgICAgICAgICB2b2lkIGZyb250bWF0dGVyQ2FjaGUuZ2V0KHRoaXMuYXBwLCBmaWxlLCB0aGlzLnNldHRpbmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV2FpdCBhIGJpdCBmb3IgbWV0YWRhdGEgY2FjaGUgdG8gYmUgZnVsbHkgcG9wdWxhdGVkXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy51cGRhdGVMaW5rU3VnZ2VzdGVyKCk7XHJcbiAgICAgIHRoaXMudXBkYXRlUXVpY2tTd2l0Y2hlcigpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUdyYXBoVmlldygpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICB0aGlzLnVwZGF0ZVRhYnMoKTtcclxuICAgICAgdGhpcy51cGRhdGVFeHBsb3JlcigpO1xyXG4gICAgICB0aGlzLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XHJcbiAgICAgIHRoaXMudXBkYXRlQm9va21hcmtzKCk7XHJcbiAgICB9LCAxMDAwKTtcclxuXHJcbiAgICAvLyBTZXQgdXAgZ3JhcGggdmlldyBoYW5kbGluZ1xyXG4gICAgdGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xyXG4gICAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2Uub25MYXlvdXRDaGFuZ2UoKTtcclxuICAgICAgdGhpcy5iYWNrbGlua1NlcnZpY2Uub25MYXlvdXRDaGFuZ2UoKTtcclxuICAgICAgdm9pZCB0aGlzLnRhYlNlcnZpY2UucmVuYW1lVGFicygpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUV4cGxvcmVyKCk7XHJcbiAgICAgIHRoaXMudXBkYXRlV2luZG93RnJhbWUoKTtcclxuICAgICAgdGhpcy51cGRhdGVCb29rbWFya3MoKTtcclxuICAgICAgLy8gQWxzbyByZWZyZXNoIGdyYXBoIHZpZXcgdG8gZW5zdXJlIGl0J3MgdXBkYXRlZFxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2UucmVmcmVzaEdyYXBoVmlldygpO1xyXG4gICAgICB9LCA1MDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gTGlzdGVuIGZvciBsYXlvdXQgY2hhbmdlcyAtIGV4YWN0bHkgbGlrZSBOb2RlIE1hc3F1ZXJhZGVcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdsYXlvdXQtY2hhbmdlJywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZ3JhcGhWaWV3U2VydmljZS5vbkxheW91dENoYW5nZSgpO1xyXG4gICAgICAgIHRoaXMuYmFja2xpbmtTZXJ2aWNlLm9uTGF5b3V0Q2hhbmdlKCk7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8vIExheW91dCBjaGFuZ2VzIGFyZSBub3cgaGFuZGxlZCBwcmltYXJpbHkgdmlhIE11dGF0aW9uT2JzZXJ2ZXIgaW4gR3JhcGhWaWV3U2VydmljZVxyXG5cclxuICAgIC8vIFNldCB1cCBiYWNrbGlua3MgaGFuZGxpbmdcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdmaWxlLW9wZW4nLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5iYWNrbGlua1NlcnZpY2Uub25GaWxlT3BlbigpO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBSZWdpc3RlciBmaWxlIGNoYW5nZSBldmVudHMgdG8gaW52YWxpZGF0ZSBjYWNoZVxyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgKGZpbGUpID0+IHtcclxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJyB8fCAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCkpKSB7XHJcbiAgICAgICAgICB0aGlzLmNhY2hlU2VydmljZS5pbnZhbGlkYXRlQ2FjaGUoZmlsZSk7XHJcbiAgICAgICAgICAvLyBBbHNvIGludmFsaWRhdGUgZnJvbnRtYXR0ZXIgY2FjaGVcclxuICAgICAgICAgIGZyb250bWF0dGVyQ2FjaGUuaW52YWxpZGF0ZShmaWxlLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC52YXVsdC5vbigncmVuYW1lJywgKGZpbGUsIG9sZFBhdGgpID0+IHtcclxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJyB8fCAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCkpKSB7XHJcbiAgICAgICAgICB0aGlzLmNhY2hlU2VydmljZS5pbnZhbGlkYXRlQ2FjaGUoZmlsZSk7XHJcbiAgICAgICAgICAvLyBBbHNvIGludmFsaWRhdGUgZnJvbnRtYXR0ZXIgY2FjaGVcclxuICAgICAgICAgIGZyb250bWF0dGVyQ2FjaGUuaW52YWxpZGF0ZShmaWxlLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC52YXVsdC5vbignZGVsZXRlJywgKGZpbGUpID0+IHtcclxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJyB8fCAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCkpKSB7XHJcbiAgICAgICAgICB0aGlzLmNhY2hlU2VydmljZS5pbnZhbGlkYXRlQ2FjaGUoZmlsZSk7XHJcbiAgICAgICAgICAvLyBBbHNvIGludmFsaWRhdGUgZnJvbnRtYXR0ZXIgY2FjaGVcclxuICAgICAgICAgIGZyb250bWF0dGVyQ2FjaGUuaW52YWxpZGF0ZShmaWxlLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgLy8gUmVnaXN0ZXIgbWV0YWRhdGEgY2FjaGUgY2hhbmdlIGV2ZW50cyB0byByZWJ1aWxkIGNhY2hlXHJcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2NoYW5nZWQnLCAoZmlsZSkgPT4ge1xyXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnIHx8IChmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcgJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSkpIHtcclxuICAgICAgICAgIHRoaXMuY2FjaGVTZXJ2aWNlLnJlYnVpbGRDYWNoZSgpO1xyXG4gICAgICAgICAgLy8gUmVmcmVzaCBncmFwaCB2aWV3IHdoZW4gbWV0YWRhdGEgY2hhbmdlcyAodG8gdXBkYXRlIHZpc2libGUgbm9kZXMpXHJcbiAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVGb3JHcmFwaFZpZXcpIHtcclxuICAgICAgICAgICAgdGhpcy5ncmFwaFZpZXdTZXJ2aWNlLnJlZnJlc2hHcmFwaFZpZXcoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIFJlZnJlc2ggYmFja2xpbmtzIHdoZW4gbWV0YWRhdGEgY2hhbmdlc1xyXG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja2xpbmtTZXJ2aWNlLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLy8gUmVmcmVzaCBleHBsb3JlciB3aGVuIG1ldGFkYXRhIGNoYW5nZXNcclxuICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnVwZGF0ZUV4cGxvcmVyKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyBSZWZyZXNoIHdpbmRvdyBmcmFtZSB3aGVuIG1ldGFkYXRhIGNoYW5nZXNcclxuICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZUZvcldpbmRvd0ZyYW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93RnJhbWVTZXJ2aWNlLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyBSZWZyZXNoIGJvb2ttYXJrcyB3aGVuIG1ldGFkYXRhIGNoYW5nZXNcclxuICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZUZvckJvb2ttYXJrcykge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUJvb2ttYXJrcygpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdyZXNvbHZlZCcsICgpID0+IHtcclxuICAgICAgICAvLyBSZWJ1aWxkIGNhY2hlIHdoZW4gbWV0YWRhdGEgY2FjaGUgaXMgZnVsbHkgcmVzb2x2ZWRcclxuICAgICAgICB0aGlzLmNhY2hlU2VydmljZS5yZWJ1aWxkQ2FjaGUoKTtcclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgLy8gUmVnaXN0ZXIgZHJhZyBhbmQgZHJvcCBldmVudCBoYW5kbGluZ1xyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1kcm9wJywgKGV2ZW50LCBlZGl0b3IpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcCkge1xyXG4gICAgICAgICAgdGhpcy5kcmFnRHJvcFNlcnZpY2UuaGFuZGxlRHJhZ0Ryb3AoZXZlbnQsIGVkaXRvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBBbHNvIHRyeSBET00gZXZlbnRzIGFzIGJhY2t1cFxyXG4gICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnZHJvcCcsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcCkge1xyXG4gICAgICAgIHRoaXMuZHJhZ0Ryb3BTZXJ2aWNlLmhhbmRsZURPTURyb3AoZXZlbnQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBOb3RlOiBNb2JpbGUgcXVpY2sgc3dpdGNoZXIgaXMgaGFuZGxlZCBieSB0aGUgUXVpY2tTd2l0Y2hlclNlcnZpY2VcclxuICAgIC8vIHdoaWNoIG92ZXJyaWRlcyB0aGUgJ3N3aXRjaGVyOm9wZW4nIGNvbW1hbmQuIFRoZSBxdWljay1wcmV2aWV3IGV2ZW50XHJcbiAgICAvLyB3YXMgY2F1c2luZyBjb25mbGljdHMgd2l0aCBub3JtYWwgdHlwaW5nLCBzbyB3ZSByZW1vdmVkIHRoYXQgYXBwcm9hY2guXHJcblxyXG4gICAgLy8gUmVnaXN0ZXIgY29tbWFuZHNcclxuICAgIHJlZ2lzdGVyQ29tbWFuZHModGhpcyk7XHJcblxyXG4gICAgLy8gQWRkIHNldHRpbmcgdGFiXHJcbiAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpbmtTdWdnZXN0ZXIoKSB7XHJcbiAgICBjb25zdCBlZGl0b3JTdWdnZXN0ID0gKHRoaXMuYXBwLndvcmtzcGFjZSBhcyBXb3Jrc3BhY2VJbnRlcm5hbCkuZWRpdG9yU3VnZ2VzdDtcclxuICAgIGlmICghZWRpdG9yU3VnZ2VzdCkgcmV0dXJuO1xyXG5cclxuICAgIGlmICh0aGlzLnN1Z2dlc3QpIHtcclxuICAgICAgZWRpdG9yU3VnZ2VzdC5zdWdnZXN0cyA9IGVkaXRvclN1Z2dlc3Quc3VnZ2VzdHMuZmlsdGVyKChzOiBFZGl0b3JTdWdnZXN0KSA9PiBzICE9PSB0aGlzLnN1Z2dlc3QpO1xyXG4gICAgICB0aGlzLnN1Z2dlc3QgPSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZykge1xyXG4gICAgICB0aGlzLnN1Z2dlc3QgPSBuZXcgTGlua1RpdGxlU3VnZ2VzdCh0aGlzKTtcclxuICAgICAgdGhpcy5yZWdpc3RlckVkaXRvclN1Z2dlc3QodGhpcy5zdWdnZXN0KTtcclxuICAgICAgdGhpcy5jYWNoZVNlcnZpY2Uuc2V0U3VnZ2VzdCh0aGlzLnN1Z2dlc3QpO1xyXG4gICAgICBlZGl0b3JTdWdnZXN0LnN1Z2dlc3RzID0gZWRpdG9yU3VnZ2VzdC5zdWdnZXN0cy5maWx0ZXIoKHM6IEVkaXRvclN1Z2dlc3QpID0+ICFzLmNvbnN0cnVjdG9yLm5hbWUuaW5jbHVkZXMoJ0xpbmtTdWdnZXN0JykpO1xyXG4gICAgICBlZGl0b3JTdWdnZXN0LnN1Z2dlc3RzLnVuc2hpZnQodGhpcy5zdWdnZXN0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHVwZGF0ZVF1aWNrU3dpdGNoZXIoKSB7XHJcbiAgICB0aGlzLnF1aWNrU3dpdGNoZXJTZXJ2aWNlLnVwZGF0ZVF1aWNrU3dpdGNoZXIoKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUdyYXBoVmlldygpIHtcclxuICAgIHRoaXMuZ3JhcGhWaWV3U2VydmljZS51cGRhdGVHcmFwaFZpZXcoKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUJhY2tsaW5rcygpIHtcclxuICAgIHRoaXMuYmFja2xpbmtTZXJ2aWNlLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlVGFicygpIHtcclxuICAgIHRoaXMudGFiU2VydmljZS51cGRhdGVUYWJzKCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVFeHBsb3JlcigpIHtcclxuICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnVwZGF0ZUV4cGxvcmVyKCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVXaW5kb3dGcmFtZSgpIHtcclxuICAgIHRoaXMud2luZG93RnJhbWVTZXJ2aWNlLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVCb29rbWFya3MoKSB7XHJcbiAgICB0aGlzLmJvb2ttYXJrU2VydmljZS51cGRhdGVCb29rbWFya3MoKTtcclxuICB9XHJcblxyXG4gIHJlYnVpbGRDYWNoZSgpIHtcclxuICAgIHRoaXMuY2FjaGVTZXJ2aWNlLnJlYnVpbGRDYWNoZSgpO1xyXG4gIH1cclxuXHJcbiAgb251bmxvYWQoKSB7XHJcbiAgICAvLyBDbGVhbiB1cCBlZGl0b3Igc3VnZ2VzdGVyXHJcbiAgICBjb25zdCBlZGl0b3JTdWdnZXN0ID0gKHRoaXMuYXBwLndvcmtzcGFjZSBhcyBXb3Jrc3BhY2VJbnRlcm5hbCkuZWRpdG9yU3VnZ2VzdDtcclxuICAgIGlmIChlZGl0b3JTdWdnZXN0ICYmIHRoaXMuc3VnZ2VzdCkge1xyXG4gICAgICBlZGl0b3JTdWdnZXN0LnN1Z2dlc3RzID0gZWRpdG9yU3VnZ2VzdC5zdWdnZXN0cy5maWx0ZXIoKHM6IEVkaXRvclN1Z2dlc3QpID0+IHMgIT09IHRoaXMuc3VnZ2VzdCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVzdG9yZSB0aGUgb3JpZ2luYWwgUXVpY2sgU3dpdGNoZXIgY29tbWFuZFxyXG4gICAgdGhpcy5xdWlja1N3aXRjaGVyU2VydmljZS5yZXN0b3JlT3JpZ2luYWxDb21tYW5kKCk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgZ3JhcGggdmlld1xyXG4gICAgdGhpcy5ncmFwaFZpZXdTZXJ2aWNlLm9udW5sb2FkKCk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgYmFja2xpbmtzIHNlcnZpY2VcclxuICAgIHRoaXMuYmFja2xpbmtTZXJ2aWNlLm9udW5sb2FkKCk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgdGFiIHNlcnZpY2VcclxuICAgIHRoaXMudGFiU2VydmljZS5vbnVubG9hZCgpO1xyXG5cclxuICAgIC8vIENsZWFuIHVwIGV4cGxvcmVyIHNlcnZpY2VcclxuICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLm9udW5sb2FkKCk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgd2luZG93IGZyYW1lIHNlcnZpY2VcclxuICAgIHRoaXMud2luZG93RnJhbWVTZXJ2aWNlLm9udW5sb2FkKCk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgYm9va21hcmtzIHNlcnZpY2VcclxuICAgIHRoaXMuYm9va21hcmtTZXJ2aWNlLm9udW5sb2FkKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICBjb25zdCBsb2FkZWREYXRhID0gKGF3YWl0IHRoaXMubG9hZERhdGEoKSkgYXMgUGx1Z2luU2V0dGluZ3MgfCBudWxsO1xyXG4gICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGxvYWRlZERhdGEgPz8ge30pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2F2ZVNldHRpbmdzKHByZXZRdWlja1N3aXRjaGVyU3RhdGU/OiBib29sZWFuLCBwcmV2VGFiU3RhdGU/OiBib29sZWFuKSB7XHJcbiAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgLy8gT25seSB1cGRhdGUgY29tcG9uZW50cyB3aGVuIHJlbGV2YW50IHNldHRpbmdzIGNoYW5nZVxyXG4gICAgaWYgKHByZXZRdWlja1N3aXRjaGVyU3RhdGUgIT09IHVuZGVmaW5lZCAmJiBwcmV2UXVpY2tTd2l0Y2hlclN0YXRlICE9PSB0aGlzLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIpIHtcclxuICAgICAgdGhpcy51cGRhdGVRdWlja1N3aXRjaGVyKCk7XHJcbiAgICB9XHJcbiAgICBpZiAocHJldlRhYlN0YXRlICE9PSB1bmRlZmluZWQgJiYgcHJldlRhYlN0YXRlICE9PSB0aGlzLnNldHRpbmdzLmVuYWJsZUZvclRhYnMpIHtcclxuICAgICAgLy8gQWx3YXlzIHJlLXJlZ2lzdGVyIGV2ZW50cyB0byBlbnN1cmUgdGFicyBhcmUgbWFya2VkIGFzIHByb2Nlc3NlZFxyXG4gICAgICAvLyAoZXZlbiB3aGVuIGRpc2FibGVkLCB3ZSBuZWVkIHRvIG1hcmsgdGFicyBzbyB0aGV5J3JlIHZpc2libGUpXHJcbiAgICAgIHZvaWQgdGhpcy50YWJTZXJ2aWNlLnJlZ2lzdGVyRXZlbnRzKCk7XHJcbiAgICAgIHRoaXMudXBkYXRlVGFicygpO1xyXG4gICAgfVxyXG4gICAgLy8gQWx3YXlzIHVwZGF0ZSBncmFwaCB2aWV3IHNpbmNlIGdyYXBoIHZpZXcgYW5kIE1EWCBzZXR0aW5ncyBjYW4gY2hhbmdlXHJcbiAgICB0aGlzLnVwZGF0ZUdyYXBoVmlldygpO1xyXG4gIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQbHVnaW5TZXR0aW5ncyA9IHtcclxuICBwcm9wZXJ0eUtleTogJ3RpdGxlJyxcclxuICBlbmFibGVGb3JMaW5raW5nOiB0cnVlLFxyXG4gIGVuYWJsZUZvclF1aWNrU3dpdGNoZXI6IHRydWUsXHJcbiAgaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2g6IHRydWUsXHJcbiAgaW5jbHVkZUFsaWFzZXNJblNlYXJjaDogdHJ1ZSxcclxuICBlbmFibGVGb3JEcmFnRHJvcDogdHJ1ZSxcclxuICB1c2VTaW1wbGVTZWFyY2g6IGZhbHNlLFxyXG4gIGVuYWJsZUZvckdyYXBoVmlldzogdHJ1ZSxcclxuICBlbmFibGVGb3JCYWNrbGlua3M6IHRydWUsXHJcbiAgZW5hYmxlRm9yVGFiczogdHJ1ZSxcclxuICBlbmFibGVGb3JFeHBsb3JlcjogZmFsc2UsXHJcbiAgZm9sZGVyTm90ZUZpbGVuYW1lOiAnJyxcclxuICBlbmFibGVGb3JXaW5kb3dGcmFtZTogdHJ1ZSxcclxuICBlbmFibGVGb3JCb29rbWFya3M6IHRydWUsXHJcbiAgZW5hYmxlTWR4U3VwcG9ydDogZmFsc2UsXHJcbiAgcXVpY2tTd2l0Y2hlckV4Y2x1ZGVkQmVoYXZpb3I6ICdkZWVtcGhhc2l6ZScsXHJcbiAgbGlua1N1Z2dlc3RlckV4Y2x1ZGVkQmVoYXZpb3I6ICdkZWVtcGhhc2l6ZScsXHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVTZXR0aW5ncyhzZXR0aW5nczogUGx1Z2luU2V0dGluZ3MpOiB7IGlzVmFsaWQ6IGJvb2xlYW47IGVycm9yczogc3RyaW5nW10gfSB7XHJcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICBpZiAoIXNldHRpbmdzLnByb3BlcnR5S2V5IHx8IHNldHRpbmdzLnByb3BlcnR5S2V5LnRyaW0oKSA9PT0gJycpIHtcclxuICAgIGVycm9ycy5wdXNoKCdQcm9wZXJ0eSBrZXkgY2Fubm90IGJlIGVtcHR5Jyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9yc1xyXG4gIH07XHJcbn1cclxuIiwgImltcG9ydCB7IEVkaXRvciwgRWRpdG9yUG9zaXRpb24sIEVkaXRvclN1Z2dlc3QsIEVkaXRvclN1Z2dlc3RDb250ZXh0LCBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8sIE1hcmtkb3duVmlldywgTm90aWNlLCBURmlsZSwgcHJlcGFyZUZ1enp5U2VhcmNoLCBwcmVwYXJlU2ltcGxlU2VhcmNoLCBTZWFyY2hSZXN1bHQsIHNvcnRTZWFyY2hSZXN1bHRzIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgU3VnZ2VzdGlvbkl0ZW0sIENhY2hlZEZpbGVEYXRhLCBFZGl0b3JTdWdnZXN0SW50ZXJuYWwsIFNlYXJjaE1hdGNoUmVhc29uLCBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiwgVmF1bHRJbnRlcm5hbCwgUXVpY2tTd2l0Y2hlclBsdWdpbkluc3RhbmNlLCBBcHBJbnRlcm5hbCwgTWV0YWRhdGFDYWNoZUludGVybmFsIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgYnVpbGRGaWxlQ2FjaGUsIGlzRXhjbHVkZWQgfSBmcm9tICcuLi91dGlscy9zZWFyY2gnO1xuXG5leHBvcnQgY2xhc3MgTGlua1RpdGxlU3VnZ2VzdCBleHRlbmRzIEVkaXRvclN1Z2dlc3Q8U3VnZ2VzdGlvbkl0ZW0+IHtcbiAgcHJpdmF0ZSBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xuICBwcml2YXRlIGZpbGVDYWNoZTogTWFwPHN0cmluZywgQ2FjaGVkRmlsZURhdGE+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHNlYXJjaFRpbWVvdXQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIG1hdGNoUmVhc29uczogTWFwPHN0cmluZywgU2VhcmNoTWF0Y2hSZWFzb24+ID0gbmV3IE1hcCgpO1xuXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcbiAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB2b2lkIHRoaXMuYnVpbGRGaWxlQ2FjaGUoKTtcbiAgfVxuXG4gIG9wZW4oKTogdm9pZCB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIGNvbnN0IGVsID0gKHRoaXMgYXMgRWRpdG9yU3VnZ2VzdEludGVybmFsKS5zdWdnZXN0RWw7XG4gICAgaWYgKGVsKSB7XG4gICAgICAvLyBBZGQgc2NvcGluZyBjbGFzcyB0byBwcmV2ZW50IENTUyBmcm9tIGFmZmVjdGluZyBvdGhlciBzdWdnZXN0aW9uIHN5c3RlbXNcbiAgICAgIGVsLmFkZENsYXNzKCdwcm9wZXJ0eS1vdmVyLWZpbGVuYW1lLXN1Z2dlc3Rpb24nKTtcblxuICAgICAgaWYgKCFlbC5xdWVyeVNlbGVjdG9yKCcucHJvbXB0LWluc3RydWN0aW9ucycpKSB7XG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbnMnIH0pO1xuICAgICAgICBpbnN0cnVjdGlvbnMuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KS5zZXRUZXh0KCdUeXBlICMgdG8gbGluayBoZWFkaW5nJyk7XG4gICAgICAgIGluc3RydWN0aW9ucy5jcmVhdGVEaXYoeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb24nIH0pLnNldFRleHQoJ1R5cGUgXiB0byBsaW5rIGJsb2NrcycpO1xuICAgICAgICBpbnN0cnVjdGlvbnMuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KS5zZXRUZXh0KCdUeXBlIHwgdG8gY2hhbmdlIGRpc3BsYXkgdGV4dCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFkZCBrZXlib2FyZCBuYXZpZ2F0aW9uIGltcHJvdmVtZW50c1xuICAgIHRoaXMuYWRkS2V5Ym9hcmROYXZpZ2F0aW9uKCk7XG4gIH1cblxuICBwcml2YXRlIGFkZEtleWJvYXJkTmF2aWdhdGlvbigpOiB2b2lkIHtcbiAgICBjb25zdCBlbCA9ICh0aGlzIGFzIEVkaXRvclN1Z2dlc3RJbnRlcm5hbCkuc3VnZ2VzdEVsO1xuICAgIGlmICghZWwpIHJldHVybjtcblxuICAgIC8vIEFkZCBlc2NhcGUga2V5IGhhbmRsaW5nXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgb25UcmlnZ2VyKGN1cnNvcjogRWRpdG9yUG9zaXRpb24sIGVkaXRvcjogRWRpdG9yLCBmaWxlOiBURmlsZSB8IG51bGwpOiBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8gfCBudWxsIHtcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckxpbmtpbmcpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IGxpbmUgPSBlZGl0b3IuZ2V0TGluZShjdXJzb3IubGluZSkuc3Vic3RyaW5nKDAsIGN1cnNvci5jaCk7XG4gICAgY29uc3QgbWF0Y2ggPSAvXFxbXFxbKFteI158XFxdXSopJC8uZXhlYyhsaW5lKTtcbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0OiB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGluZS5sYXN0SW5kZXhPZignW1snKSB9LFxuICAgICAgICBlbmQ6IGN1cnNvcixcbiAgICAgICAgcXVlcnk6IG1hdGNoWzFdLFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBhc3luYyBidWlsZEZpbGVDYWNoZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBHZXQgYWxsIG1hcmtkb3duIGZpbGVzIGFuZCBNRFggZmlsZXMgKGlmIGVuYWJsZWQpXG4gICAgY29uc3QgbWRGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICBjb25zdCBhbGxGaWxlcyA9IFsuLi5tZEZpbGVzXTtcblxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XG4gICAgICBjb25zdCBtZHhGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKFxuICAgICAgICAoZik6IGYgaXMgVEZpbGUgPT4gZiBpbnN0YW5jZW9mIFRGaWxlICYmIGYuZXh0ZW5zaW9uID09PSAnbWR4J1xuICAgICAgKTtcbiAgICAgIGFsbEZpbGVzLnB1c2goLi4ubWR4RmlsZXMpO1xuICAgIH1cblxuICAgIHRoaXMuZmlsZUNhY2hlID0gYXdhaXQgYnVpbGRGaWxlQ2FjaGUoXG4gICAgICBhbGxGaWxlcyxcbiAgICAgIHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUsXG4gICAgICB0aGlzLmFwcCxcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5LFxuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3NcbiAgICApO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlRmlsZUNhY2hlKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyBnZXRGcm9udG1hdHRlciwgaXNGaWxlVHlwZVN1cHBvcnRlZCB9ID0gYXdhaXQgaW1wb3J0KCcuLi91dGlscy9mcm9udG1hdHRlcicpO1xuXG4gICAgLy8gU2tpcCB1bnN1cHBvcnRlZCBmaWxlIHR5cGVzXG4gICAgaWYgKCFpc0ZpbGVUeXBlU3VwcG9ydGVkKGZpbGUuZXh0ZW5zaW9uLCB0aGlzLnBsdWdpbi5zZXR0aW5ncykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGF3YWl0IGdldEZyb250bWF0dGVyKHRoaXMuYXBwLCBmaWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG4gICAgbGV0IGRpc3BsYXlOYW1lID0gZmlsZS5iYXNlbmFtZTtcbiAgICBsZXQgaXNDdXN0b21EaXNwbGF5ID0gZmFsc2U7XG4gICAgbGV0IGFsaWFzZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gU3RyaW5nKGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSkudHJpbSgpO1xuICAgICAgaWYgKHByb3BlcnR5VmFsdWUgIT09ICcnKSB7XG4gICAgICAgIGRpc3BsYXlOYW1lID0gcHJvcGVydHlWYWx1ZTtcbiAgICAgICAgaXNDdXN0b21EaXNwbGF5ID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZnJvbnRtYXR0ZXI/LmFsaWFzZXMpIHtcbiAgICAgIGNvbnN0IGFsaWFzZXNSYXcgPSBmcm9udG1hdHRlci5hbGlhc2VzIGFzIHVua25vd247XG4gICAgICBhbGlhc2VzID0gQXJyYXkuaXNBcnJheShhbGlhc2VzUmF3KSA/IGFsaWFzZXNSYXcubWFwKGEgPT4gU3RyaW5nKGEpKSA6IFtTdHJpbmcoYWxpYXNlc1JhdyldO1xuICAgICAgYWxpYXNlcyA9IGFsaWFzZXMubWFwKGFsaWFzID0+IGFsaWFzLnRyaW0oKSkuZmlsdGVyKGFsaWFzID0+IGFsaWFzICE9PSAnJyk7XG4gICAgfVxuXG4gICAgdGhpcy5maWxlQ2FjaGUuc2V0KGZpbGUucGF0aCwge1xuICAgICAgZmlsZSxcbiAgICAgIGRpc3BsYXlOYW1lLFxuICAgICAgYWxpYXNlcyxcbiAgICAgIGxhc3RNb2RpZmllZDogZmlsZS5zdGF0Lm10aW1lLFxuICAgICAgaXNDdXN0b21EaXNwbGF5XG4gICAgfSk7XG4gIH1cblxuICBnZXRTdWdnZXN0aW9ucyhjb250ZXh0OiBFZGl0b3JTdWdnZXN0Q29udGV4dCk6IFN1Z2dlc3Rpb25JdGVtW10ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gY29udGV4dC5xdWVyeS50cmltKCk7XG4gICAgcmV0dXJuIHRoaXMucGVyZm9ybVNlYXJjaChxdWVyeSk7XG4gIH1cblxuICBwcml2YXRlIHBlcmZvcm1TZWFyY2gocXVlcnk6IHN0cmluZyk6IFN1Z2dlc3Rpb25JdGVtW10ge1xuICAgIC8vIElmIG5vIHF1ZXJ5LCBzaG93IGFsbCBmaWxlc1xuICAgIGlmICghcXVlcnkgfHwgcXVlcnkudHJpbSgpID09PSAnJykge1xuICAgICAgY29uc3QgYmVoYXZpb3IgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rU3VnZ2VzdGVyRXhjbHVkZWRCZWhhdmlvcjtcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBTdWdnZXN0aW9uSXRlbVtdID0gQXJyYXkuZnJvbSh0aGlzLmZpbGVDYWNoZS52YWx1ZXMoKSlcbiAgICAgICAgLmZpbHRlcihjYWNoZWQgPT4gYmVoYXZpb3IgPT09ICdpZ25vcmUnIHx8ICFpc0V4Y2x1ZGVkKGNhY2hlZC5maWxlLCB0aGlzLmFwcCkpXG4gICAgICAgIC8vIFNvcnQgYnkgbGFzdCBtb2RpZmllZCB0byBzaG93IHJlY2VudCBmaWxlc1xuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5sYXN0TW9kaWZpZWQgLSBhLmxhc3RNb2RpZmllZClcbiAgICAgICAgLnNsaWNlKDAsIDEwKSAvLyBMaW1pdCB0byAxMCBmb3IgZGVmYXVsdCB2aWV3XG4gICAgICAgIC5tYXAoY2FjaGVkID0+ICh7XG4gICAgICAgICAgZmlsZTogY2FjaGVkLmZpbGUsXG4gICAgICAgICAgZGlzcGxheTogY2FjaGVkLmRpc3BsYXlOYW1lLFxuICAgICAgICAgIGlzQ3VzdG9tRGlzcGxheTogY2FjaGVkLmlzQ3VzdG9tRGlzcGxheVxuICAgICAgICB9KSk7XG4gICAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gICAgfVxuXG4gICAgLy8gVXNlIHNpbXBsZSBzZWFyY2ggZm9yIGxhcmdlIHZhdWx0cyBpZiBlbmFibGVkLCBvdGhlcndpc2UgdXNlIGZ1enp5IHNlYXJjaFxuICAgIGNvbnN0IHNlYXJjaCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVNpbXBsZVNlYXJjaFxuICAgICAgPyBwcmVwYXJlU2ltcGxlU2VhcmNoKHF1ZXJ5KVxuICAgICAgOiBwcmVwYXJlRnV6enlTZWFyY2gocXVlcnkpO1xuXG4gICAgLy8gQ3JlYXRlIGEgc3RydWN0dXJlIGNvbXBhdGlibGUgd2l0aCBzb3J0U2VhcmNoUmVzdWx0c1xuICAgIGludGVyZmFjZSBTZWFyY2hhYmxlU3VnZ2VzdGlvbiB7XG4gICAgICBpdGVtOiBTdWdnZXN0aW9uSXRlbTtcbiAgICAgIG1hdGNoOiBTZWFyY2hSZXN1bHQ7XG4gICAgfVxuXG4gICAgY29uc3Qgc2VhcmNoYWJsZVN1Z2dlc3Rpb25zOiBTZWFyY2hhYmxlU3VnZ2VzdGlvbltdID0gW107XG4gICAgdGhpcy5tYXRjaFJlYXNvbnMuY2xlYXIoKTsgLy8gQ2xlYXIgcHJldmlvdXMgbWF0Y2ggcmVhc29uc1xuXG4gICAgLy8gVXNlIGNhY2hlZCBkYXRhIGZvciBtdWNoIGZhc3RlciBzZWFyY2hcbiAgICBmb3IgKGNvbnN0IGNhY2hlZERhdGEgb2YgdGhpcy5maWxlQ2FjaGUudmFsdWVzKCkpIHtcbiAgICAgIGNvbnN0IHsgZmlsZSwgZGlzcGxheU5hbWUsIGFsaWFzZXMsIGlzQ3VzdG9tRGlzcGxheSB9ID0gY2FjaGVkRGF0YTtcblxuICAgICAgLy8gVHJhY2sgd2hpY2ggZmllbGRzIGNhdXNlZCB0aGUgbWF0Y2hcbiAgICAgIGNvbnN0IG1hdGNoUmVhc29uOiBTZWFyY2hNYXRjaFJlYXNvbiA9IHtcbiAgICAgICAgbWF0Y2hlZEluVGl0bGU6IGZhbHNlLFxuICAgICAgICBtYXRjaGVkSW5GaWxlbmFtZTogZmFsc2UsXG4gICAgICAgIG1hdGNoZWRJbkFsaWFzOiBmYWxzZVxuICAgICAgfTtcblxuICAgICAgLy8gUHJpbWFyeSBtYXRjaDogc2VhcmNoIHRpdGxlL3Byb3BlcnR5IGZpcnN0IChvbmx5IGlmIG5vdGUgaGFzIGN1c3RvbSBkaXNwbGF5KVxuICAgICAgbGV0IHByaW1hcnlNYXRjaDogU2VhcmNoUmVzdWx0IHwgbnVsbCA9IG51bGw7XG4gICAgICBsZXQgYmVzdE1hdGNoOiBTZWFyY2hSZXN1bHQgfCBudWxsID0gbnVsbDtcbiAgICAgIGxldCBtYXRjaFR5cGU6ICd0aXRsZScgfCAnZmlsZW5hbWUnIHwgJ2FsaWFzJyB8IG51bGwgPSBudWxsO1xuXG4gICAgICBpZiAoaXNDdXN0b21EaXNwbGF5KSB7XG4gICAgICAgIC8vIE9ubHkgc2VhcmNoIHRpdGxlL3Byb3BlcnR5IGlmIG5vdGUgYWN0dWFsbHkgaGFzIGEgY3VzdG9tIHByb3BlcnR5XG4gICAgICAgIHByaW1hcnlNYXRjaCA9IHNlYXJjaChkaXNwbGF5TmFtZSk7XG4gICAgICAgIGlmIChwcmltYXJ5TWF0Y2ggJiYgcHJpbWFyeU1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlID0gdHJ1ZTtcbiAgICAgICAgICBiZXN0TWF0Y2ggPSBwcmltYXJ5TWF0Y2g7XG4gICAgICAgICAgbWF0Y2hUeXBlID0gJ3RpdGxlJztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBJZiBubyB0aXRsZSBtYXRjaCAob3Igbm90ZSBkb2Vzbid0IGhhdmUgcHJvcGVydHkpLCBzZWFyY2ggZmlsZW5hbWVcbiAgICAgIGlmICghbWF0Y2hUeXBlKSB7XG4gICAgICAgIC8vIFNlYXJjaCBmaWxlbmFtZSBpZiBpdCdzIGRpZmZlcmVudCBmcm9tIGRpc3BsYXlOYW1lLCBvciBpZiBub3RlIGRvZXNuJ3QgaGF2ZSBwcm9wZXJ0eVxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2ggJiYgZmlsZS5iYXNlbmFtZSAhPT0gZGlzcGxheU5hbWUpIHtcbiAgICAgICAgICBjb25zdCBmaWxlbmFtZU1hdGNoID0gc2VhcmNoKGZpbGUuYmFzZW5hbWUpO1xuICAgICAgICAgIGlmIChmaWxlbmFtZU1hdGNoICYmIGZpbGVuYW1lTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkSW5GaWxlbmFtZSA9IHRydWU7XG4gICAgICAgICAgICAvLyBEb3ducmFuayBmaWxlbmFtZSBtYXRjaGVzIGJ5IC0xXG4gICAgICAgICAgICBiZXN0TWF0Y2ggPSB7IC4uLmZpbGVuYW1lTWF0Y2gsIHNjb3JlOiBmaWxlbmFtZU1hdGNoLnNjb3JlIC0gMSB9O1xuICAgICAgICAgICAgbWF0Y2hUeXBlID0gJ2ZpbGVuYW1lJztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIWlzQ3VzdG9tRGlzcGxheSkge1xuICAgICAgICAgIC8vIElmIG5vdGUgZG9lc24ndCBoYXZlIHByb3BlcnR5LCBkaXNwbGF5TmFtZSBlcXVhbHMgZmlsZW5hbWUsIHNvIHNlYXJjaCBmaWxlbmFtZVxuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lTWF0Y2ggPSBzZWFyY2goZmlsZS5iYXNlbmFtZSk7XG4gICAgICAgICAgaWYgKGZpbGVuYW1lTWF0Y2ggJiYgZmlsZW5hbWVNYXRjaC5tYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lID0gdHJ1ZTtcbiAgICAgICAgICAgIGJlc3RNYXRjaCA9IGZpbGVuYW1lTWF0Y2g7XG4gICAgICAgICAgICBtYXRjaFR5cGUgPSAnZmlsZW5hbWUnO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUZXJ0aWFyeSBtYXRjaDogc2VhcmNoIGFsaWFzZXMgKHdpdGggZG93bnJhbmtpbmcpXG4gICAgICBpZiAoIW1hdGNoVHlwZSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlQWxpYXNlc0luU2VhcmNoICYmIGFsaWFzZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBmb3IgKGNvbnN0IGFsaWFzIG9mIGFsaWFzZXMpIHtcbiAgICAgICAgICBjb25zdCBhbGlhc01hdGNoID0gc2VhcmNoKGFsaWFzKTtcbiAgICAgICAgICBpZiAoYWxpYXNNYXRjaCAmJiBhbGlhc01hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEluQWxpYXMgPSB0cnVlO1xuICAgICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEFsaWFzVGV4dCA9IGFsaWFzOyAvLyBTdG9yZSB3aGljaCBhbGlhcyBtYXRjaGVkXG4gICAgICAgICAgICAvLyBEb3ducmFuayBhbGlhcyBtYXRjaGVzIGJ5IC0xXG4gICAgICAgICAgICBiZXN0TWF0Y2ggPSB7IC4uLmFsaWFzTWF0Y2gsIHNjb3JlOiBhbGlhc01hdGNoLnNjb3JlIC0gMSB9O1xuICAgICAgICAgICAgbWF0Y2hUeXBlID0gJ2FsaWFzJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBJZiB3ZSBoYXZlIGFueSBtYXRjaCwgYWRkIHRvIHJlc3VsdHNcbiAgICAgIGlmIChiZXN0TWF0Y2ggJiYgYmVzdE1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBJZiBxdWVyeSBpcyBlbXB0eSwgbmV2ZXIgc2hvdyBleGNsdWRlZCBmaWxlcyB1bmxlc3MgYmVoYXZpb3IgaXMgJ2lnbm9yZSdcbiAgICAgICAgaWYgKCFxdWVyeSkge1xuICAgICAgICAgIGNvbnN0IGJlaGF2aW9yID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua1N1Z2dlc3RlckV4Y2x1ZGVkQmVoYXZpb3I7XG4gICAgICAgICAgaWYgKGJlaGF2aW9yICE9PSAnaWdub3JlJyAmJiBpc0V4Y2x1ZGVkKGZpbGUsIHRoaXMuYXBwKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbjogU3VnZ2VzdGlvbkl0ZW0gPSB7XG4gICAgICAgICAgZmlsZSxcbiAgICAgICAgICBkaXNwbGF5OiBkaXNwbGF5TmFtZSxcbiAgICAgICAgICBpc0N1c3RvbURpc3BsYXlcbiAgICAgICAgfTtcbiAgICAgICAgc2VhcmNoYWJsZVN1Z2dlc3Rpb25zLnB1c2goeyBpdGVtOiBzdWdnZXN0aW9uLCBtYXRjaDogYmVzdE1hdGNoIH0pO1xuICAgICAgICB0aGlzLm1hdGNoUmVhc29ucy5zZXQoZmlsZS5wYXRoLCBtYXRjaFJlYXNvbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWRkIHVucmVzb2x2ZWQgbGlua3MgaWYgXCJTaG93IGV4aXN0aW5nIG9ubHlcIiBpcyBkaXNhYmxlZFxuICAgIC8vIFRoaXMgbWF0Y2hlcyBRdWljayBTd2l0Y2ggKysgYmVoYXZpb3I6IHVucmVzb2x2ZWQ6ICFzZXR0aW5ncy5zaG93RXhpc3RpbmdPbmx5XG4gICAgY29uc3QgcXVpY2tTd2l0Y2hlck9wdGlvbnMgPSB0aGlzLmdldFF1aWNrU3dpdGNoZXJPcHRpb25zKCk7XG4gICAgY29uc3Qgc2hvd0V4aXN0aW5nT25seSA9IHF1aWNrU3dpdGNoZXJPcHRpb25zPy5zaG93RXhpc3RpbmdPbmx5ID8/IGZhbHNlO1xuXG4gICAgaWYgKCFzaG93RXhpc3RpbmdPbmx5KSB7XG4gICAgICAvLyBHZXQgdW5yZXNvbHZlZCBsaW5rcyBmcm9tIG1ldGFkYXRhIGNhY2hlIChsaWtlIFF1aWNrIFN3aXRjaCArKyBkb2VzKVxuICAgICAgY29uc3QgeyB1bnJlc29sdmVkTGlua3MgfSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGU7XG4gICAgICBjb25zdCB1bnJlc29sdmVkU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICAgIC8vIENvbGxlY3QgYWxsIHVucmVzb2x2ZWQgbGlua3MgZnJvbSBhbGwgZmlsZXNcbiAgICAgIGZvciAoY29uc3Qgc291cmNlUGF0aCBpbiB1bnJlc29sdmVkTGlua3MpIHtcbiAgICAgICAgY29uc3QgbGlua3MgPSBPYmplY3Qua2V5cyh1bnJlc29sdmVkTGlua3Nbc291cmNlUGF0aF0pO1xuICAgICAgICBsaW5rcy5mb3JFYWNoKGxpbmsgPT4gdW5yZXNvbHZlZFNldC5hZGQobGluaykpO1xuICAgICAgfVxuXG4gICAgICAvLyBTZWFyY2ggdW5yZXNvbHZlZCBsaW5rcyBhbmQgYWRkIG1hdGNoZXNcbiAgICAgIGZvciAoY29uc3QgdW5yZXNvbHZlZCBvZiB1bnJlc29sdmVkU2V0KSB7XG4gICAgICAgIGNvbnN0IHVucmVzb2x2ZWRNYXRjaCA9IHNlYXJjaCh1bnJlc29sdmVkKTtcbiAgICAgICAgaWYgKHVucmVzb2x2ZWRNYXRjaCAmJiB1bnJlc29sdmVkTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8gQWRkIGFzIGEgc3VnZ2VzdGlvbiB3aXRob3V0IGEgZmlsZSAodW5yZXNvbHZlZCBsaW5rKVxuICAgICAgICAgIHNlYXJjaGFibGVTdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgIGl0ZW06IHtcbiAgICAgICAgICAgICAgZGlzcGxheTogdW5yZXNvbHZlZCxcbiAgICAgICAgICAgICAgaXNDdXN0b21EaXNwbGF5OiBmYWxzZSxcbiAgICAgICAgICAgICAgLy8gTm8gZmlsZSBwcm9wZXJ0eSBtZWFucyBpdCdzIHVucmVzb2x2ZWRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtYXRjaDogdW5yZXNvbHZlZE1hdGNoXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBVc2UgT2JzaWRpYW4ncyBuYXRpdmUgc29ydGluZyBmb3IgZXhhY3QgdmFuaWxsYSBjb21wYXRpYmlsaXR5XG4gICAgLy8gUG9zdC1zb3J0OiBtb3ZlIGV4Y2x1ZGVkIGZpbGVzIHRvIHRoZSBlbmQgKHN0YWJsZSBzb3J0KVxuICAgIGNvbnN0IGJlaGF2aW9yID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua1N1Z2dlc3RlckV4Y2x1ZGVkQmVoYXZpb3I7XG4gICAgaWYgKGJlaGF2aW9yICE9PSAnaWdub3JlJykge1xuICAgICAgc2VhcmNoYWJsZVN1Z2dlc3Rpb25zLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgY29uc3QgYUZpbGUgPSBhLml0ZW0uZmlsZTtcbiAgICAgICAgY29uc3QgYkZpbGUgPSBiLml0ZW0uZmlsZTtcbiAgICAgICAgY29uc3QgYUV4Y2x1ZGVkID0gYUZpbGUgPyBpc0V4Y2x1ZGVkKGFGaWxlLCB0aGlzLmFwcCkgOiBmYWxzZTtcbiAgICAgICAgY29uc3QgYkV4Y2x1ZGVkID0gYkZpbGUgPyBpc0V4Y2x1ZGVkKGJGaWxlLCB0aGlzLmFwcCkgOiBmYWxzZTtcblxuICAgICAgICBpZiAoYUV4Y2x1ZGVkICYmICFiRXhjbHVkZWQpIHJldHVybiAxO1xuICAgICAgICBpZiAoIWFFeGNsdWRlZCAmJiBiRXhjbHVkZWQpIHJldHVybiAtMTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBFeHRyYWN0IHN1Z2dlc3Rpb25zIGZyb20gc29ydGVkIHJlc3VsdHNcbiAgICBsZXQgc3VnZ2VzdGlvbnMgPSBzZWFyY2hhYmxlU3VnZ2VzdGlvbnMubWFwKHMgPT4gcy5pdGVtKTtcblxuICAgIC8vIEZpbHRlciBvdXQgZXhjbHVkZWQgZmlsZXMgaWYgYmVoYXZpb3IgaXMgJ2hpZGUnXG4gICAgaWYgKGJlaGF2aW9yID09PSAnaGlkZScpIHtcbiAgICAgIHN1Z2dlc3Rpb25zID0gc3VnZ2VzdGlvbnMuZmlsdGVyKHMgPT4ge1xuICAgICAgICByZXR1cm4gIShzLmZpbGUgJiYgaXNFeGNsdWRlZChzLmZpbGUsIHRoaXMuYXBwKSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBGaWx0ZXIgb3V0IHVucmVzb2x2ZWQgbGlua3MgaWYgXCJTaG93IGV4aXN0aW5nIG9ubHlcIiBpcyBlbmFibGVkXG4gICAgLy8gVW5yZXNvbHZlZCBsaW5rcyBhcmUgaXRlbXMgd2l0aG91dCBhIGZpbGUgcHJvcGVydHlcbiAgICBpZiAoc2hvd0V4aXN0aW5nT25seSkge1xuICAgICAgc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9ucy5maWx0ZXIocyA9PiBzLmZpbGUgIT09IHVuZGVmaW5lZCk7XG4gICAgfVxuXG4gICAgLy8gTGluayBzdWdnZXN0ZXIgc2hvdWxkIE5PVCBzaG93IFwiY3JlYXRlIG5ldyBub3RlXCIgb3B0aW9uIC0gdGhhdCdzIFF1aWNrIFN3aXRjaGVyIGJlaGF2aW9yXG4gICAgLy8gQnV0IGlmIHRoZXJlIGFyZSBubyBtYXRjaGVzIGFuZCB0aGVyZSdzIGEgcXVlcnksIHNob3cgXCJObyBtYXRjaCBmb3VuZFwiIGxpa2UgdmFuaWxsYSBPYnNpZGlhblxuICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPT09IDAgJiYgcXVlcnkpIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xuICAgICAgICBkaXNwbGF5OiAnTm8gbWF0Y2ggZm91bmQnLFxuICAgICAgICBpc0N1c3RvbURpc3BsYXk6IGZhbHNlLFxuICAgICAgICBpc05vTWF0Y2g6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBzdWdnZXN0aW9ucztcbiAgfVxuXG4gIHJlbmRlclN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogU3VnZ2VzdGlvbkl0ZW0sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgIGVsLmVtcHR5KCk7XG5cbiAgICBpZiAoc3VnZ2VzdGlvbi5maWxlICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtTdWdnZXN0ZXJFeGNsdWRlZEJlaGF2aW9yID09PSAnZGVlbXBoYXNpemUnICYmIGlzRXhjbHVkZWQoc3VnZ2VzdGlvbi5maWxlLCB0aGlzLmFwcCkpIHtcbiAgICAgIGVsLmFkZENsYXNzKCdtb2QtZXhjbHVkZWQnKTtcbiAgICB9XG5cbiAgICBpZiAoc3VnZ2VzdGlvbi5pc05vTWF0Y2gpIHtcbiAgICAgIC8vIEZvciBcIk5vIG1hdGNoIGZvdW5kXCIsIHNob3cganVzdCB0aGUgdGV4dFxuICAgICAgZWwuc2V0VGV4dChzdWdnZXN0aW9uLmRpc3BsYXkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChzdWdnZXN0aW9uLmZpbGUpIHtcbiAgICAgIC8vIEdldCB0aGUgbWF0Y2ggcmVhc29uIGZvciB0aGlzIGZpbGVcbiAgICAgIGNvbnN0IG1hdGNoUmVhc29uID0gdGhpcy5tYXRjaFJlYXNvbnMuZ2V0KHN1Z2dlc3Rpb24uZmlsZS5wYXRoKTtcblxuICAgICAgLy8gU3BlY2lhbCBjYXNlOiBub3RlcyB3aXRob3V0IHByb3BlcnR5IHRoYXQgbWF0Y2hlZCB2aWEgYWxpYXMgc2hvdWxkIHNob3cgYWxpYXMgd2l0aCBpY29uXG4gICAgICBpZiAoIXN1Z2dlc3Rpb24uaXNDdXN0b21EaXNwbGF5ICYmIG1hdGNoUmVhc29uPy5tYXRjaGVkSW5BbGlhcyAmJiBtYXRjaFJlYXNvbi5tYXRjaGVkQWxpYXNUZXh0KSB7XG4gICAgICAgIC8vIFNob3cgYWxpYXMgYXMgbWFpbiB0ZXh0LCBmaWxlbmFtZSBiZWxvdywgd2l0aCBhbGlhcyBpY29uIChsaWtlIGRlZmF1bHQgT2JzaWRpYW4pXG4gICAgICAgIGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XG5cbiAgICAgICAgLy8gTWFpbiB0aXRsZSAtIHNob3cgdGhlIGFsaWFzIHRoYXQgbWF0Y2hlZFxuICAgICAgICBjb25zdCB0aXRsZUVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScgfSk7XG4gICAgICAgIHRpdGxlRWwuc2V0VGV4dChtYXRjaFJlYXNvbi5tYXRjaGVkQWxpYXNUZXh0KTtcblxuICAgICAgICAvLyBGaWxlIHBhdGggYmVsb3dcbiAgICAgICAgY29uc3QgcGF0aEVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1ub3RlJyB9KTtcbiAgICAgICAgcGF0aEVsLnNldFRleHQoc3VnZ2VzdGlvbi5maWxlLnBhdGgucmVwbGFjZSgnLm1kJywgJycpKTtcblxuICAgICAgICAvLyBBZGQgc3VnZ2VzdGlvbi1hdXggd2l0aCBhbGlhcyBpY29uXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25BdXggPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7XG4gICAgICAgICAgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicsXG4gICAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6ICdBbGlhcyBNYXRjaCcgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVGb3J3YXJkSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgfSBlbHNlIGlmIChzdWdnZXN0aW9uLmlzQ3VzdG9tRGlzcGxheSkge1xuICAgICAgICAvLyBOb3RlcyB3aXRoIHRoZSBwcm9wZXJ0eSAtIGtlZXAgZXhpc3RpbmcgYmVoYXZpb3JcbiAgICAgICAgY29uc3Qgc2hvdWxkU2hvd0ljb24gPSBtYXRjaFJlYXNvbiAmJiAobWF0Y2hSZWFzb24ubWF0Y2hlZEluVGl0bGUgfHwgbWF0Y2hSZWFzb24ubWF0Y2hlZEluRmlsZW5hbWUgfHwgbWF0Y2hSZWFzb24ubWF0Y2hlZEluQWxpYXMpO1xuXG4gICAgICAgIGlmIChzaG91bGRTaG93SWNvbikge1xuICAgICAgICAgIC8vIEFkZCBtb2QtY29tcGxleCBjbGFzcyB0byBtYXRjaCBPYnNpZGlhbidzIHN0cnVjdHVyZVxuICAgICAgICAgIGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xuXG4gICAgICAgICAgLy8gQ3JlYXRlIHRoZSBtYWluIHN1Z2dlc3Rpb24gY29udGFpbmVyXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRlbnQgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWNvbnRlbnQnIH0pO1xuXG4gICAgICAgICAgLy8gTWFpbiB0aXRsZVxuICAgICAgICAgIGNvbnN0IHRpdGxlRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJyB9KTtcbiAgICAgICAgICB0aXRsZUVsLnNldFRleHQoc3VnZ2VzdGlvbi5kaXNwbGF5KTtcblxuICAgICAgICAgIC8vIEZpbGUgcGF0aCBiZWxvd1xuICAgICAgICAgIGNvbnN0IHBhdGhFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tbm90ZScgfSk7XG4gICAgICAgICAgcGF0aEVsLnNldFRleHQoc3VnZ2VzdGlvbi5maWxlLnBhdGgucmVwbGFjZSgnLm1kJywgJycpKTtcblxuICAgICAgICAgIC8vIEFkZCBzdWdnZXN0aW9uLWF1eCB3aXRoIGFwcHJvcHJpYXRlIGljb24gYmFzZWQgb24gbWF0Y2ggcmVhc29uXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uRmxhaXIgPSBzdWdnZXN0aW9uQXV4LmNyZWF0ZVNwYW4oe1xuICAgICAgICAgICAgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicsXG4gICAgICAgICAgICBhdHRyOiB7ICdhcmlhLWxhYmVsJzogdGhpcy5nZXRJY29uTGFiZWwobWF0Y2hSZWFzb24pIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIERldGVybWluZSBpY29uIGJhc2VkIG9uIHByaW9yaXR5OiB0aXRsZSA+IGZpbGUgbmFtZSA+IGFsaWFzXG4gICAgICAgICAgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlKSB7XG4gICAgICAgICAgICAvLyBUeXBlIGljb24gZm9yIHRpdGxlL3Byb3BlcnR5IG1hdGNoZXNcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVHlwZUljb24oc3VnZ2VzdGlvbkZsYWlyKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lKSB7XG4gICAgICAgICAgICAvLyBGaWxlIGljb24gZm9yIGZpbGUgbmFtZSBtYXRjaGVzXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUZpbGVJY29uKHN1Z2dlc3Rpb25GbGFpcik7XG4gICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcykge1xuICAgICAgICAgICAgLy8gQXJyb3cgaWNvbiBmb3IgYWxpYXMgbWF0Y2hlc1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVGb3J3YXJkSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBOb3RlIGhhcyBwcm9wZXJ0eSBidXQgbm8gbWF0Y2ggcmVhc29uIChzaG91bGRuJ3QgaGFwcGVuLCBidXQgaGFuZGxlIGdyYWNlZnVsbHkpXG4gICAgICAgICAgLy8gU2hvdyBzaW1wbGUgZGlzcGxheSB3aXRoIGp1c3QgdGhlIGRpc3BsYXkgbmFtZVxuICAgICAgICAgIGVsLnNldFRleHQoc3VnZ2VzdGlvbi5kaXNwbGF5KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIG5vdGVzIHdpdGhvdXQgdGhlIHByb3BlcnR5IChhbmQgbm90IG1hdGNoZWQgdmlhIGFsaWFzKSwgc2hvdyBzaW1wbGUgZGlzcGxheSAobm8gaWNvbiwgbm8gZHVwbGljYXRlIG5hbWUpXG4gICAgICAgIGVsLnNldFRleHQoc3VnZ2VzdGlvbi5kaXNwbGF5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEljb25MYWJlbChtYXRjaFJlYXNvbjogU2VhcmNoTWF0Y2hSZWFzb24pOiBzdHJpbmcge1xuICAgIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5UaXRsZSkge1xuICAgICAgcmV0dXJuICdUaXRsZS9Qcm9wZXJ0eSBNYXRjaCc7XG4gICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5GaWxlbmFtZSkge1xuICAgICAgcmV0dXJuICdGaWxlIE5hbWUgTWF0Y2gnO1xuICAgIH0gZWxzZSBpZiAobWF0Y2hSZWFzb24ubWF0Y2hlZEluQWxpYXMpIHtcbiAgICAgIHJldHVybiAnQWxpYXMgTWF0Y2gnO1xuICAgIH1cbiAgICByZXR1cm4gJ01hdGNoJztcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlVHlwZUljb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAyNCAyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XG4gICAgc3ZnLmNsYXNzTGlzdC5hZGQoJ3N2Zy1pY29uJywgJ2x1Y2lkZS10eXBlJyk7XG5cbiAgICBjb25zdCBwb2x5bGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XG4gICAgcG9seWxpbmUxLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzQgNyA0IDQgMjAgNCAyMCA3Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lMSk7XG5cbiAgICBjb25zdCBsaW5lMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDEnLCAnOScpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneTEnLCAnMjAnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gyJywgJzE1Jyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MicsICcyMCcpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMSk7XG5cbiAgICBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnMTInKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kxJywgJzQnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzEyJyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcyMCcpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3ZnKTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlRmlsZUljb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAyNCAyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XG4gICAgc3ZnLmNsYXNzTGlzdC5hZGQoJ3N2Zy1pY29uJywgJ2x1Y2lkZS1maWxlLXRleHQnKTtcblxuICAgIGNvbnN0IHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTtcbiAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZCcsICdNMTQuNSAySDZhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWNy41TDE0LjUgMnonKTtcbiAgICBzdmcuYXBwZW5kQ2hpbGQocGF0aCk7XG5cbiAgICBjb25zdCBwb2x5bGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XG4gICAgcG9seWxpbmUxLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzE0LDIgMTQsOCAyMCw4Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lMSk7XG5cbiAgICBjb25zdCBsaW5lMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDEnLCAnMTYnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kxJywgJzEzJyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MicsICc4Jyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MicsICcxMycpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMSk7XG5cbiAgICBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnMTYnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kxJywgJzE3Jyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MicsICc4Jyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcxNycpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XG5cbiAgICBjb25zdCBwb2x5bGluZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XG4gICAgcG9seWxpbmUyLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzEwLDkgOSw5IDgsOScpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZTIpO1xuXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN2Zyk7XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUZvcndhcmRJY29uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgMjQgMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnY3VycmVudENvbG9yJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpO1xuICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdzdmctaWNvbicsICdsdWNpZGUtZm9yd2FyZCcpO1xuXG4gICAgY29uc3QgcG9seWxpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XG4gICAgcG9seWxpbmUuc2V0QXR0cmlidXRlKCdwb2ludHMnLCAnMTUgMTcgMjAgMTIgMTUgNycpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZSk7XG5cbiAgICBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XG4gICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2QnLCAnTTQgMTh2LTJhNCA0IDAgMCAxIDQtNGgxMicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcblxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzdmcpO1xuICB9XG5cbiAgcHJpdmF0ZSBpc1VzaW5nQ3VzdG9tUHJvcGVydHkoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcbiAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gY2FjaGU/LmZyb250bWF0dGVyO1xuICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBmcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyB1bmtub3duO1xuICAgIGlmIChwcm9wZXJ0eVZhbHVlID09PSB1bmRlZmluZWQgfHwgcHJvcGVydHlWYWx1ZSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBzdHJWYWx1ZSA9IHR5cGVvZiBwcm9wZXJ0eVZhbHVlID09PSAnc3RyaW5nJyA/IHByb3BlcnR5VmFsdWUgOiAodHlwZW9mIHByb3BlcnR5VmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiBwcm9wZXJ0eVZhbHVlID09PSAnYm9vbGVhbicgPyBTdHJpbmcocHJvcGVydHlWYWx1ZSkgOiAnJyk7XG4gICAgcmV0dXJuIHN0clZhbHVlLnRyaW0oKSAhPT0gJyc7XG4gIH1cblxuICBwcml2YXRlIGlzVXNpbmdBbGlhcyhmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgIC8vIENoZWNrIGlmIHRoaXMgZmlsZSBoYXMgYWxpYXNlcyBhbmQgaWYgd2UncmUgY3VycmVudGx5IHNlYXJjaGluZ1xuICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBjYWNoZT8uZnJvbnRtYXR0ZXI7XG4gICAgY29uc3QgYWxpYXNlcyA9IGZyb250bWF0dGVyPy5hbGlhc2VzIGFzIHVua25vd247XG5cbiAgICBpZiAoIWFsaWFzZXMpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIEZvciBub3csIHNob3cgYWxpYXMgaWNvbiBpZiB0aGUgZmlsZSBoYXMgYWxpYXNlcyBhbmQgd2UncmUgbm90IHVzaW5nIGEgY3VzdG9tIHByb3BlcnR5XG4gICAgY29uc3QgaXNVc2luZ0N1c3RvbVByb3BlcnR5ID0gdGhpcy5pc1VzaW5nQ3VzdG9tUHJvcGVydHkoZmlsZSk7XG4gICAgcmV0dXJuICFpc1VzaW5nQ3VzdG9tUHJvcGVydHkgJiYgQm9vbGVhbihhbGlhc2VzKTtcbiAgfVxuXG4gIHNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogU3VnZ2VzdGlvbkl0ZW0sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAvLyBEb24ndCBkbyBhbnl0aGluZyBmb3IgXCJObyBtYXRjaCBmb3VuZFwiXG4gICAgaWYgKHN1Z2dlc3Rpb24uaXNOb01hdGNoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgaWYgKCFhY3RpdmVWaWV3IHx8ICF0aGlzLmNvbnRleHQpIHJldHVybjtcbiAgICBjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcbiAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IHRoaXMuY29udGV4dDtcbiAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldExpbmUoc3RhcnQubGluZSk7XG4gICAgbGV0IGVuZFBvcyA9IGVuZDtcbiAgICBpZiAobGluZS5zbGljZShlbmQuY2gsIGVuZC5jaCArIDIpID09PSAnXV0nKSB7XG4gICAgICBlbmRQb3MgPSB7IGxpbmU6IGVuZC5saW5lLCBjaDogZW5kLmNoICsgMiB9O1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBleGlzdGluZyBmaWxlXG4gICAgaWYgKCFzdWdnZXN0aW9uLmZpbGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB2YXVsdCA9IHRoaXMuYXBwLnZhdWx0IGFzIHVua25vd24gYXMgVmF1bHRJbnRlcm5hbDtcbiAgICBjb25zdCB1c2VNYXJrZG93bkxpbmtzID0gdmF1bHQuZ2V0Q29uZmlnPy4oJ3VzZU1hcmtkb3duTGlua3MnKSA/PyBmYWxzZTtcbiAgICBsZXQgbGlua1RleHQ6IHN0cmluZztcblxuICAgIC8vIE9ubHkgYWRkIGRpc3BsYXkgdGV4dCBpZiB0aGUgbm90ZSBoYXMgdGhlIGN1c3RvbSBwcm9wZXJ0eVxuICAgIC8vIE90aGVyd2lzZSwgdXNlIGRlZmF1bHQgT2JzaWRpYW4gYmVoYXZpb3IgKG5vIGRpc3BsYXkgdGV4dClcbiAgICBpZiAoc3VnZ2VzdGlvbi5pc0N1c3RvbURpc3BsYXkpIHtcbiAgICAgIGlmICh1c2VNYXJrZG93bkxpbmtzKSB7XG4gICAgICAgIGxpbmtUZXh0ID0gYFske3N1Z2dlc3Rpb24uZGlzcGxheX1dKCR7ZW5jb2RlVVJJKHN1Z2dlc3Rpb24uZmlsZS5wYXRoKX0pYDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGxpbmtQYXRoID0gc3VnZ2VzdGlvbi5maWxlLnBhdGgucmVwbGFjZSgnLm1kJywgJycpO1xuICAgICAgICBsaW5rVGV4dCA9IGBbWyR7bGlua1BhdGh9fCR7c3VnZ2VzdGlvbi5kaXNwbGF5fV1dYDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRGVmYXVsdCBPYnNpZGlhbiBiZWhhdmlvciAtIG5vIGRpc3BsYXkgdGV4dFxuICAgICAgaWYgKHVzZU1hcmtkb3duTGlua3MpIHtcbiAgICAgICAgbGlua1RleHQgPSBgWyR7c3VnZ2VzdGlvbi5maWxlLnBhdGgucmVwbGFjZSgnLm1kJywgJycpfV0oJHtlbmNvZGVVUkkoc3VnZ2VzdGlvbi5maWxlLnBhdGgpfSlgO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbGlua1BhdGggPSBzdWdnZXN0aW9uLmZpbGUucGF0aC5yZXBsYWNlKCcubWQnLCAnJyk7XG4gICAgICAgIGxpbmtUZXh0ID0gYFtbJHtsaW5rUGF0aH1dXWA7XG4gICAgICB9XG4gICAgfVxuICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobGlua1RleHQsIHsgbGluZTogc3RhcnQubGluZSwgY2g6IHN0YXJ0LmNoIH0sIGVuZFBvcyk7XG4gICAgY29uc3QgbmV3Q3Vyc29yUG9zID0gc3RhcnQuY2ggKyBsaW5rVGV4dC5sZW5ndGg7XG4gICAgdHJ5IHtcbiAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBzdGFydC5saW5lLCBjaDogbmV3Q3Vyc29yUG9zIH0pO1xuICAgIH0gY2F0Y2gge1xuICAgICAgbmV3IE5vdGljZSgnRXJyb3Igc2V0dGluZyBjdXJzb3IgcG9zaXRpb24uIFBsZWFzZSBjaGVjayBjb25zb2xlIGZvciBkZXRhaWxzLicpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTogUXVpY2tTd2l0Y2hlclBsdWdpbkluc3RhbmNlWydvcHRpb25zJ10gfCBudWxsIHtcbiAgICB0cnkge1xuICAgICAgLy8gQWNjZXNzIHRoZSBpbnRlcm5hbCBRdWljayBTd2l0Y2hlciBwbHVnaW4gdGhlIHNhbWUgd2F5IFF1aWNrIFN3aXRjaCArKyBkb2VzXG4gICAgICBjb25zdCBpbnRlcm5hbFBsdWdpbnMgPSAodGhpcy5hcHAgYXMgdW5rbm93biBhcyBBcHBJbnRlcm5hbCkuaW50ZXJuYWxQbHVnaW5zO1xuICAgICAgaWYgKCFpbnRlcm5hbFBsdWdpbnMpIHJldHVybiBudWxsO1xuXG4gICAgICBjb25zdCBzd2l0Y2hlclBsdWdpbiA9IGludGVybmFsUGx1Z2lucy5nZXRQbHVnaW5CeUlkPy4oJ3N3aXRjaGVyJyk7XG4gICAgICBpZiAoIXN3aXRjaGVyUGx1Z2luIHx8ICFzd2l0Y2hlclBsdWdpbi5pbnN0YW5jZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHN3aXRjaGVyUGx1Z2luLmluc3RhbmNlLm9wdGlvbnMgfHwgbnVsbDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5pbXBvcnQgeyBjcmVhdGVTZXR0aW5nc0dyb3VwIH0gZnJvbSAnLi4vdXRpbHMvc2V0dGluZ3MtY29tcGF0JztcclxuXHJcbmV4cG9ydCBjbGFzcyBTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuICBwdWJsaWMgaWNvbiA9ICdsdWNpZGUtdHlwZSc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAvLyBBZGQgc2NvcGluZyBjbGFzcyB0byBwcmV2ZW50IENTUyBmcm9tIGFmZmVjdGluZyBvdGhlciBzZXR0aW5nc1xyXG4gICAgY29udGFpbmVyRWwuYWRkQ2xhc3MoJ3Byb3BlcnR5LW92ZXItZmlsZW5hbWUtc2V0dGluZ3MnKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYSBzaW5nbGUgc2V0dGluZ3MgZ3JvdXAgd2l0aCBubyBoZWFkaW5nIChmb2xsb3dpbmcgVUkgVHdlYWtlciBwYXR0ZXJuKVxyXG4gICAgY29uc3QgZ2VuZXJhbEdyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChjb250YWluZXJFbCwgdW5kZWZpbmVkLCAncHJvcGVydHktb3Zlci1maWxlLW5hbWUnKTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ1Byb3BlcnR5IGtleScpXHJcbiAgICAgICAgLnNldERlc2MoJ1RoZSBwcm9wZXJ0eSB0byB1c2UgYXMgdGhlIGRpc3BsYXkgdGl0bGUuIEZhbGxzIGJhY2sgdG8gdGhlIGZpbGUgbmFtZSB3aGVuIG5vIHByb3BlcnR5IGlzIHNldCBmb3IgdGhhdCBpdGVtLicpXHJcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignVGl0bGUnKVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXkpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleSA9IHZhbHVlLnRyaW0oKSB8fCAndGl0bGUnO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVMaW5rU3VnZ2VzdGVyKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlR3JhcGhWaWV3KCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlQmFja2xpbmtzKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlVGFicygpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUV4cGxvcmVyKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlV2luZG93RnJhbWUoKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVCb29rbWFya3MoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdXaGVuIGxpbmtpbmcgbm90ZXMnKVxyXG4gICAgICAgIC5zZXREZXNjKCdFbmFibGUgcHJvcGVydHktYmFzZWQgdGl0bGVzIGluIHRoZSBsaW5rIHN1Z2dlc3Rlci4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZylcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckxpbmtpbmcgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlTGlua1N1Z2dlc3RlcigpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luIHF1aWNrIHN3aXRjaGVyJylcclxuICAgICAgICAuc2V0RGVzYygnRW5hYmxlIHByb3BlcnR5LWJhc2VkIHRpdGxlcyBpbiB0aGUgcXVpY2sgc3dpdGNoZXIuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICBjb25zdCBwcmV2UXVpY2tTd2l0Y2hlclN0YXRlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcjtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKHByZXZRdWlja1N3aXRjaGVyU3RhdGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luY2x1ZGUgZmlsZSBuYW1lIGluIGZ1enp5IHNlYXJjaGVzJylcclxuICAgICAgICAuc2V0RGVzYygnSW5jbHVkZSBub3RlIGZpbGUgbmFtZXMgaW4gZnV6enkgc2VhcmNoIHJlc3VsdHMgZm9yIGxpbmsgc3VnZ2VzdGVyIGFuZCBxdWljayBzd2l0Y2hlci4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2gpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlRmlsZW5hbWVJblNlYXJjaCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbmNsdWRlIGFsaWFzZXMgaW4gZnV6enkgc2VhcmNoZXMnKVxyXG4gICAgICAgIC5zZXREZXNjKCdJbmNsdWRlIHByb3BlcnR5IGFsaWFzZXMgaW4gZnV6enkgc2VhcmNoIHJlc3VsdHMgZm9yIGxpbmsgc3VnZ2VzdGVyIGFuZCBxdWljayBzd2l0Y2hlci4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUFsaWFzZXNJblNlYXJjaClcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVBbGlhc2VzSW5TZWFyY2ggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnV2hlbiBkcmFnZ2luZyBub3RlcycpXHJcbiAgICAgICAgLnNldERlc2MoJ1VzZSBwcm9wZXJ0eS1iYXNlZCB0aXRsZXMgd2hlbiBkcmFnZ2luZyBub3RlcyBmcm9tIHRoZSBmaWxlIGV4cGxvcmVyLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcClcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckRyYWdEcm9wID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ1doZW4gbmFtaW5nIGJvb2ttYXJrcycpXHJcbiAgICAgICAgLnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgdXNlIHRoZSBjb25maWd1cmVkIHByb3BlcnR5IHZhbHVlIGFzIHRoZSBkZWZhdWx0IG5hbWUgd2hlbiBjcmVhdGluZyBhIGJvb2ttYXJrLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JCb29rbWFya3MpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JCb29rbWFya3MgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlQm9va21hcmtzKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnSW4gZ3JhcGggdmlldycpXHJcbiAgICAgICAgLnNldERlc2MoJ1VzZSB0aGUgcHJvcGVydHkgaW5zdGVhZCBvZiB0aGUgZmlsZSBuYW1lIGFzIHRoZSBub3RlXFwncyB0aXRsZSBpbiBncmFwaCB2aWV3LicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JHcmFwaFZpZXcpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JHcmFwaFZpZXcgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbiBiYWNrbGlua3MgYW5kIG91dGdvaW5nIGxpbmtzJylcclxuICAgICAgICAuc2V0RGVzYygnVXNlIHRoZSBwcm9wZXJ0eSBpbnN0ZWFkIG9mIHRoZSBmaWxlIG5hbWUgaW4gdGhlIGxpbmtlZCBtZW50aW9ucyBmb290ZXIsIGRlZGljYXRlZCBiYWNrbGlua3MgcGFuZWwsIGFuZCBvdXRnb2luZyBsaW5rcy4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luIHRhYiB0aXRsZXMnKVxyXG4gICAgICAgIC5zZXREZXNjKCdVc2UgdGhlIHByb3BlcnR5IGluc3RlYWQgb2YgdGhlIGZpbGUgbmFtZSBpbiB0YWIgdGl0bGVzLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JUYWJzKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcHJldlRhYlN0YXRlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yVGFicztcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JUYWJzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKHVuZGVmaW5lZCwgcHJldlRhYlN0YXRlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbiB3aW5kb3cgZnJhbWUgdGl0bGUnKVxyXG4gICAgICAgIC5zZXREZXNjKCdVc2UgdGhlIHByb3BlcnR5IGluc3RlYWQgb2YgdGhlIGZpbGUgbmFtZSBpbiB0aGUgYnJvd3NlciB3aW5kb3cgdGl0bGUgYmFyLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JXaW5kb3dGcmFtZSlcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvcldpbmRvd0ZyYW1lID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnSW4gZmlsZSBleHBsb3JlcicpXHJcbiAgICAgICAgLnNldERlc2MoJ1VzZSB0aGUgcHJvcGVydHkgaW5zdGVhZCBvZiB0aGUgZmlsZSBuYW1lIGluIHRoZSBmaWxlIGV4cGxvcmVyLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3JlcilcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUV4cGxvcmVyKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdG8gc2hvdy9oaWRlIGZvbGRlciBub3RlIHNldHRpbmdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gU2hvdyBmb2xkZXIgbm90ZSBmaWxlIG5hbWUgc2V0dGluZyBvbmx5IGlmIGV4cGxvcmVyIGlzIGVuYWJsZWRcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3Jlcikge1xyXG4gICAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICAgIHNldHRpbmdcclxuICAgICAgICAgIC5zZXROYW1lKCdGb2xkZXIgbm90ZSBmaWxlIG5hbWUnKVxyXG4gICAgICAgICAgLnNldERlc2MoJ0lmIGEgZm9sZGVyIGNvbnRhaW5zIGEgZmlsZSB3aXRoIHRoaXMgbmFtZSB0aGF0IGhhcyB0aGUgY29uZmlndXJlZCBwcm9wZXJ0eSwgdGhlIGZvbGRlciB3aWxsIGRpc3BsYXkgdGhhdCBwcm9wZXJ0eSB2YWx1ZSBpbnN0ZWFkLiBUaGlzIGVuc3VyZXMgY29tcGF0aWJpbGl0eSB3aXRoIGZvbGRlciBub3RlcyBwbHVnaW5zLiBMZWF2ZSBibGFuayB0byBkaXNhYmxlLicpXHJcbiAgICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICAgICAgdGV4dFxyXG4gICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignSW5kZXgnKVxyXG4gICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJOb3RlRmlsZW5hbWUpXHJcbiAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZm9sZGVyTm90ZUZpbGVuYW1lID0gdmFsdWUudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlRXhwbG9yZXIoKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdVc2Ugc2ltcGxlIHNlYXJjaCcpXHJcbiAgICAgICAgLnNldERlc2MoJ0luc3RlYWQgb2YgdXNpbmcgZnV6enkgc2VhcmNoLCBzaW1wbGUgc2VhcmNoIHByb3ZpZGVzIGJldHRlciBwZXJmb3JtYW5jZSB3aXRoIHZlcnkgbGFyZ2UgdmF1bHRzICh0aG91c2FuZHMgb2YgZmlsZXMpLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTaW1wbGVTZWFyY2gpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTaW1wbGVTZWFyY2ggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZWQgZmlsZXMgaW4gcXVpY2sgc3dpdGNoZXInKVxyXG4gICAgICAgIC5zZXREZXNjKCdIb3cgZmlsZXMgaW4gT2JzaWRpYW5cXCdzIFwiRXhjbHVkZWQgZmlsZXNcIiBsaXN0IHNob3VsZCBiZWhhdmUgaW4gdGhlIHF1aWNrIHN3aXRjaGVyLicpXHJcbiAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT5cclxuICAgICAgICAgIGRyb3Bkb3duXHJcbiAgICAgICAgICAgIC5hZGRPcHRpb25zKHtcclxuICAgICAgICAgICAgICBkZWVtcGhhc2l6ZTogJ0RlZW1waGFzaXplIChtb3ZlIHRvIGJvdHRvbSAmIGdyYXkgb3V0KScsXHJcbiAgICAgICAgICAgICAgaGlkZTogJ0hpZGUgZW50aXJlbHknLFxyXG4gICAgICAgICAgICAgIGlnbm9yZTogJ0lnbm9yZSAodHJlYXQgYXMgbm9ybWFsIGZpbGVzKScsXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5xdWlja1N3aXRjaGVyRXhjbHVkZWRCZWhhdmlvcilcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnF1aWNrU3dpdGNoZXJFeGNsdWRlZEJlaGF2aW9yID0gdmFsdWUgYXMgYW55O1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVRdWlja1N3aXRjaGVyKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZWQgZmlsZXMgaW4gbGluayBzdWdnZXN0ZXInKVxyXG4gICAgICAgIC5zZXREZXNjKCdIb3cgZmlsZXMgaW4gT2JzaWRpYW5cXCdzIFwiRXhjbHVkZWQgZmlsZXNcIiBsaXN0IHNob3VsZCBiZWhhdmUgaW4gdGhlIGxpbmsgc3VnZ2VzdGVyLicpXHJcbiAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT5cclxuICAgICAgICAgIGRyb3Bkb3duXHJcbiAgICAgICAgICAgIC5hZGRPcHRpb25zKHtcclxuICAgICAgICAgICAgICBkZWVtcGhhc2l6ZTogJ0RlZW1waGFzaXplIChtb3ZlIHRvIGJvdHRvbSAmIGdyYXkgb3V0KScsXHJcbiAgICAgICAgICAgICAgaGlkZTogJ0hpZGUgZW50aXJlbHknLFxyXG4gICAgICAgICAgICAgIGlnbm9yZTogJ0lnbm9yZSAodHJlYXQgYXMgbm9ybWFsIGZpbGVzKScsXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rU3VnZ2VzdGVyRXhjbHVkZWRCZWhhdmlvcilcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtTdWdnZXN0ZXJFeGNsdWRlZEJlaGF2aW9yID0gdmFsdWUgYXMgYW55O1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVMaW5rU3VnZ2VzdGVyKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnRW5hYmxlIE1EWCBmaWxlIHN1cHBvcnQnKVxyXG4gICAgICAgIC5zZXREZXNjKCdFbmFibGUgc3VwcG9ydCBmb3IgLm1keCBmaWxlcy4gV2hlbiBlbmFibGVkLCB0aGUgcGx1Z2luIHdpbGwgcmVhZCBwcm9wZXJ0aWVzIGZyb20gTWR4IGZpbGVzIG1hbnVhbGx5IChPYnNpZGlhblxcJ3MgbWV0YWRhdGEgY2FjaGUgb25seSB3b3JrcyBmb3IgLm1kIGZpbGVzKS4gTm90ZTogTWR4IHN1cHBvcnQgaXMgcGFydGlhbCAtIGdyYXBoIHZpZXcgaXMgbm90IHN1cHBvcnRlZCBkdWUgdG8gdGVjaG5pY2FsIGxpbWl0YXRpb25zLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgIC8vIFJlYnVpbGQgY2FjaGUgYW5kIHJlZnJlc2ggYWxsIGNvbXBvbmVudHMgd2hlbiBNRFggc3VwcG9ydCBpcyB0b2dnbGVkXHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ucmVidWlsZENhY2hlKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlTGlua1N1Z2dlc3RlcigpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZVF1aWNrU3dpdGNoZXIoKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVHcmFwaFZpZXcoKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVCYWNrbGlua3MoKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVUYWJzKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlRXhwbG9yZXIoKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVXaW5kb3dGcmFtZSgpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUJvb2ttYXJrcygpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBDb21wYXRpYmlsaXR5IHV0aWxpdGllcyBmb3Igc2V0dGluZ3NcclxuICogUHJvdmlkZXMgYmFja3dhcmQgY29tcGF0aWJpbGl0eSBmb3IgU2V0dGluZ0dyb3VwIChyZXF1aXJlcyBBUEkgMS4xMS4wKylcclxuICovXHJcblxyXG5pbXBvcnQgeyBTZXR0aW5nLCByZXF1aXJlQXBpVmVyc2lvbiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0ICogYXMgT2JzaWRpYW5Nb2R1bGUgZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSB0aGF0IHdvcmtzIHdpdGggYm90aCBTZXR0aW5nR3JvdXAgYW5kIGZhbGxiYWNrIGNvbnRhaW5lclxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTZXR0aW5nc0NvbnRhaW5lciB7XHJcblx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIHNldHRpbmdzIGNvbnRhaW5lciB0aGF0IHVzZXMgU2V0dGluZ0dyb3VwIGlmIGF2YWlsYWJsZSAoQVBJIDEuMTEuMCspLFxyXG4gKiBvdGhlcndpc2UgZmFsbHMgYmFjayB0byBjcmVhdGluZyBhIGhlYWRpbmcgYW5kIHVzaW5nIHRoZSBjb250YWluZXIgZGlyZWN0bHkuXHJcbiAqIFxyXG4gKiBVc2VzIHJlcXVpcmVBcGlWZXJzaW9uKCcxLjExLjAnKSB0byBjaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlLlxyXG4gKiBUaGlzIGlzIHRoZSBvZmZpY2lhbCBPYnNpZGlhbiBBUEkgbWV0aG9kIGZvciB2ZXJzaW9uIGNoZWNraW5nLlxyXG4gKiBcclxuICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIGNvbnRhaW5lciBlbGVtZW50IGZvciBzZXR0aW5nc1xyXG4gKiBAcGFyYW0gaGVhZGluZyAtIFRoZSBoZWFkaW5nIHRleHQgZm9yIHRoZSBzZXR0aW5ncyBncm91cCAob3B0aW9uYWwpXHJcbiAqIEBwYXJhbSBtYW5pZmVzdElkIC0gVGhlIHBsdWdpbidzIG1hbmlmZXN0IElEIGZvciBDU1Mgc2NvcGluZyAocmVxdWlyZWQgZm9yIGZhbGxiYWNrIG1vZGUpXHJcbiAqIEByZXR1cm5zIEEgY29udGFpbmVyIHRoYXQgY2FuIGJlIHVzZWQgdG8gYWRkIHNldHRpbmdzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2V0dGluZ3NHcm91cChcclxuXHRjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXHJcblx0aGVhZGluZz86IHN0cmluZyxcclxuXHRtYW5pZmVzdElkPzogc3RyaW5nXHJcbik6IFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHQvLyBDaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlIChBUEkgMS4xMS4wKylcclxuXHQvLyByZXF1aXJlQXBpVmVyc2lvbiBpcyB0aGUgb2ZmaWNpYWwgT2JzaWRpYW4gQVBJIG1ldGhvZCBmb3IgdmVyc2lvbiBjaGVja2luZ1xyXG5cdGlmIChyZXF1aXJlQXBpVmVyc2lvbignMS4xMS4wJykpIHtcclxuXHRcdC8vIFVzZSBTZXR0aW5nR3JvdXAgLSBpdCdzIGd1YXJhbnRlZWQgdG8gZXhpc3QgaWYgcmVxdWlyZUFwaVZlcnNpb24gcmV0dXJucyB0cnVlXHJcblx0XHQvLyBBY2Nlc3MgU2V0dGluZ0dyb3VwIHZpYSB0eXBlIGFzc2VydGlvbiBzaW5jZSBpdCBtYXkgbm90IGJlIGluIHR5cGUgZGVmaW5pdGlvbnNcclxuXHRcdC8vIGZvciBvbGRlciBUeXBlU2NyaXB0IHZlcnNpb25zLCBidXQgZXhpc3RzIGF0IHJ1bnRpbWUgaW4gT2JzaWRpYW4gMS4xMS4wK1xyXG5cdFx0Ly8gVXNpbmcgdW5rbm93biBpbnN0ZWFkIG9mIGFueSB0byBzYXRpc2Z5IGVzbGludCB3aGlsZSBtYWludGFpbmluZyB0eXBlIHNhZmV0eVxyXG5cdFx0Y29uc3QgU2V0dGluZ0dyb3VwQ2xhc3MgPSAoT2JzaWRpYW5Nb2R1bGUgYXMgdW5rbm93biBhcyB7IFNldHRpbmdHcm91cD86IG5ldyAoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSA9PiB7XHJcblx0XHRcdHNldEhlYWRpbmcoaGVhZGluZzogc3RyaW5nKToge1xyXG5cdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcclxuXHRcdFx0fTtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG5cdFx0fSB9KS5TZXR0aW5nR3JvdXA7XHJcblx0XHRcclxuXHRcdGlmIChTZXR0aW5nR3JvdXBDbGFzcykge1xyXG5cdFx0XHRjb25zdCBncm91cCA9IGhlYWRpbmcgXHJcblx0XHRcdFx0PyBuZXcgU2V0dGluZ0dyb3VwQ2xhc3MoY29udGFpbmVyRWwpLnNldEhlYWRpbmcoaGVhZGluZylcclxuXHRcdFx0XHQ6IG5ldyBTZXR0aW5nR3JvdXBDbGFzcyhjb250YWluZXJFbCk7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRcdGdyb3VwLmFkZFNldHRpbmcoY2IpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0Ly8gRmFsbGJhY2sgcGF0aCAoZWl0aGVyIEFQSSA8IDEuMTEuMCBvciBTZXR0aW5nR3JvdXAgbm90IGZvdW5kKVxyXG5cdC8vIEFkZCBzY29waW5nIGNsYXNzIHRvIGNvbnRhaW5lckVsIHRvIHNjb3BlIENTUyB0byBvbmx5IHRoaXMgcGx1Z2luJ3Mgc2V0dGluZ3NcclxuXHRpZiAobWFuaWZlc3RJZCkge1xyXG5cdFx0Y29udGFpbmVyRWwuYWRkQ2xhc3MoYCR7bWFuaWZlc3RJZH0tc2V0dGluZ3MtY29tcGF0YCk7XHJcblx0fVxyXG5cclxuXHR7XHJcblx0XHQvLyBGYWxsYmFjazogQ3JlYXRlIGEgaGVhZGluZyBtYW51YWxseSBmb3Igb2xkZXIgQVBJIHZlcnNpb25zXHJcblx0XHQvLyBOb3RlOiBXaGlsZSBiZXN0IHByYWN0aWNlIHByZWZlcnMgU2V0dGluZy5zZXRIZWFkaW5nKCksIHRoZSBmYWxsYmFjayBwYXRoXHJcblx0XHQvLyBpcyBmb3IgdmVyc2lvbnMgdGhhdCBtYXkgbm90IHN1cHBvcnQgaXQsIHNvIG1hbnVhbCBoZWFkaW5nIGlzIGFwcHJvcHJpYXRlIGhlcmVcclxuXHRcdGlmIChoZWFkaW5nKSB7XHJcblx0XHRcdGNvbnN0IGhlYWRpbmdFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdignc2V0dGluZy1ncm91cC1oZWFkaW5nJyk7XHJcblx0XHRcdGhlYWRpbmdFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6IGhlYWRpbmcgfSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKSB7XHJcblx0XHRcdFx0Y29uc3Qgc2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKTtcclxuXHRcdFx0XHRjYihzZXR0aW5nKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9XHJcbn1cclxuXHJcbiIsICJpbXBvcnQgeyBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4gfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckNvbW1hbmRzKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAvLyBRdWljayBTd2l0Y2hlciBjb21tYW5kXHJcbiAgcGx1Z2luLmFkZENvbW1hbmQoe1xyXG4gICAgaWQ6ICdvcGVuLXF1aWNrLXN3aXRjaGVyJyxcclxuICAgIG5hbWU6ICdPcGVuIHF1aWNrIHN3aXRjaGVyIChwcm9wZXJ0eS1iYXNlZCknLFxyXG4gICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgeyBRdWlja1N3aXRjaE1vZGFsIH0gPSBhd2FpdCBpbXBvcnQoJy4uL3VpL1F1aWNrU3dpdGNoTW9kYWwnKTtcclxuICAgICAgbmV3IFF1aWNrU3dpdGNoTW9kYWwocGx1Z2luLmFwcCwgcGx1Z2luKS5vcGVuKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIFRvZ2dsZSBsaW5raW5nIGNvbW1hbmRcclxuICBwbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICBpZDogJ3RvZ2dsZS1saW5raW5nJyxcclxuICAgIG5hbWU6ICdUb2dnbGUgcHJvcGVydHktYmFzZWQgbGlua2luZycsXHJcbiAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICBwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZyA9ICFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZztcclxuICAgICAgYXdhaXQgcGx1Z2luLnNhdmVEYXRhKHBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgIHBsdWdpbi51cGRhdGVMaW5rU3VnZ2VzdGVyKCk7XHJcbiAgICAgIG5ldyBOb3RpY2UoYFByb3BlcnR5LWJhc2VkIGxpbmtpbmcgJHtwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZyA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIFRvZ2dsZSBRdWljayBTd2l0Y2hlciBjb21tYW5kXHJcbiAgcGx1Z2luLmFkZENvbW1hbmQoe1xyXG4gICAgaWQ6ICd0b2dnbGUtcXVpY2stc3dpdGNoZXInLFxyXG4gICAgbmFtZTogJ1RvZ2dsZSBwcm9wZXJ0eS1iYXNlZCBxdWljayBzd2l0Y2hlcicsXHJcbiAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBwcmV2U3RhdGUgPSBwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcjtcclxuICAgICAgcGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIgPSAhcGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXI7XHJcbiAgICAgIGF3YWl0IHBsdWdpbi5zYXZlU2V0dGluZ3MocHJldlN0YXRlKTtcclxuICAgICAgbmV3IE5vdGljZShgUHJvcGVydHktYmFzZWQgUXVpY2sgU3dpdGNoZXIgJHtwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlciA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIFJlYnVpbGQgY2FjaGUgY29tbWFuZFxyXG4gIHBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgIGlkOiAncmVidWlsZC1jYWNoZScsXHJcbiAgICBuYW1lOiAnUmVidWlsZCBmaWxlIGNhY2hlJyxcclxuICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgIHBsdWdpbi5yZWJ1aWxkQ2FjaGUoKTtcclxuICAgICAgbmV3IE5vdGljZSgnRmlsZSBjYWNoZSByZWJ1aWx0Jyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIFRvZ2dsZSBkcmFnIGFuZCBkcm9wIGNvbW1hbmRcclxuICBwbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICBpZDogJ3RvZ2dsZS1kcmFnLWRyb3AnLFxyXG4gICAgbmFtZTogJ1RvZ2dsZSBwcm9wZXJ0eS1iYXNlZCBkcmFnIGFuZCBkcm9wJyxcclxuICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgIHBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcCA9ICFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRHJhZ0Ryb3A7XHJcbiAgICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShwbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICBuZXcgTm90aWNlKGBQcm9wZXJ0eS1iYXNlZCBkcmFnIGFuZCBkcm9wICR7cGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckRyYWdEcm9wID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwSW50ZXJuYWwsIFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luLCBXb3Jrc3BhY2VJbnRlcm5hbCB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFF1aWNrU3dpdGNoZXJTZXJ2aWNlIHtcclxuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcbiAgcHJpdmF0ZSBvcmlnaW5hbFN3aXRjaGVyQ29tbWFuZD86IHtcclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBpY29uPzogc3RyaW5nO1xyXG4gICAgaG90a2V5czogQXJyYXk8eyBtb2RpZmllcnM6IHN0cmluZ1tdOyBrZXk6IHN0cmluZyB9PjtcclxuICAgIGNhbGxiYWNrOiAoKSA9PiB2b2lkO1xyXG4gIH07XHJcbiAgcHJpdmF0ZSBpc0NvbW1hbmRPdmVycmlkZGVuID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUXVpY2tTd2l0Y2hlcigpIHtcclxuICAgIC8vIE9ubHkgb3ZlcnJpZGUgdGhlIGNvbW1hbmQgaWYgb3VyIFF1aWNrIFN3aXRjaGVyIGlzIGVuYWJsZWRcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyICYmICF0aGlzLmlzQ29tbWFuZE92ZXJyaWRkZW4pIHtcclxuICAgICAgdGhpcy5vdmVycmlkZVF1aWNrU3dpdGNoZXJDb21tYW5kKCk7XHJcbiAgICB9IGVsc2UgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyICYmIHRoaXMuaXNDb21tYW5kT3ZlcnJpZGRlbikge1xyXG4gICAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIGNvbW1hbmQgd2hlbiBkaXNhYmxlZFxyXG4gICAgICB0aGlzLnJlc3RvcmVPcmlnaW5hbENvbW1hbmQoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgb3ZlcnJpZGVRdWlja1N3aXRjaGVyQ29tbWFuZCgpIHtcclxuICAgIC8vIEdldCB0aGUgY29tbWFuZCByZWdpc3RyeVxyXG4gICAgY29uc3QgY29tbWFuZHMgPSAodGhpcy5wbHVnaW4uYXBwIGFzIHVua25vd24gYXMgQXBwSW50ZXJuYWwpLmNvbW1hbmRzLmNvbW1hbmRzO1xyXG5cclxuICAgIC8vIFN0b3JlIHRoZSBvcmlnaW5hbCBjb21tYW5kIEJFRk9SRSB3ZSBkZWxldGUgaXRcclxuICAgIGlmIChjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddICYmICF0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kKSB7XHJcbiAgICAgIGNvbnN0IG9yaWdpbmFsQ21kID0gY29tbWFuZHNbJ3N3aXRjaGVyOm9wZW4nXTtcclxuICAgICAgdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZCA9IHtcclxuICAgICAgICBpZDogb3JpZ2luYWxDbWQuaWQgfHwgJ3N3aXRjaGVyOm9wZW4nLFxyXG4gICAgICAgIG5hbWU6IG9yaWdpbmFsQ21kLm5hbWUgfHwgJ1F1aWNrIFN3aXRjaGVyJyxcclxuICAgICAgICBpY29uOiBvcmlnaW5hbENtZC5pY29uLFxyXG4gICAgICAgIGhvdGtleXM6IG9yaWdpbmFsQ21kLmhvdGtleXMgPyBbLi4ub3JpZ2luYWxDbWQuaG90a2V5c10gOiBbXSxcclxuICAgICAgICBjYWxsYmFjazogb3JpZ2luYWxDbWQuY2FsbGJhY2tcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZW1vdmUgdGhlIG9yaWdpbmFsIGNvbW1hbmQgY29tcGxldGVseSB0byBhdm9pZCBjb25mbGljdHNcclxuICAgIGlmIChjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddKSB7XHJcbiAgICAgIGRlbGV0ZSBjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENyZWF0ZSBvdXIgY3VzdG9tIGNvbW1hbmQgb2JqZWN0XHJcbiAgICBjb25zdCBjdXN0b21Db21tYW5kID0ge1xyXG4gICAgICBpZDogJ3N3aXRjaGVyOm9wZW4nLFxyXG4gICAgICBuYW1lOiAnUXVpY2sgU3dpdGNoZXInLFxyXG4gICAgICBpY29uOiB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kPy5pY29uLFxyXG4gICAgICBob3RrZXlzOiBbeyBtb2RpZmllcnM6IFtcIk1vZFwiXSwga2V5OiBcIm9cIiB9XSxcclxuICAgICAgY2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgICAvLyBQcmV2ZW50IGFueSBkZWZhdWx0IFF1aWNrIFN3aXRjaGVyIGZyb20gb3BlbmluZ1xyXG4gICAgICAgIGNvbnN0IHdvcmtzcGFjZSA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UgYXMgdW5rbm93biBhcyBXb3Jrc3BhY2VJbnRlcm5hbCAmIHsgc3dpdGNoZXI/OiB7IGNsb3NlKCk6IHZvaWQgfSB9O1xyXG4gICAgICAgIGlmICh3b3Jrc3BhY2Uuc3dpdGNoZXIgJiYgdHlwZW9mIHdvcmtzcGFjZS5zd2l0Y2hlci5jbG9zZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgd29ya3NwYWNlLnN3aXRjaGVyLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVzZSBvdXIgY3VzdG9tIG1vZGFsIHdoZW4gdGhpcyBjb21tYW5kIGlzIGFjdGl2ZVxyXG4gICAgICAgIC8vIENsb3NlIGFueSBleGlzdGluZyBtb2RhbHMgZmlyc3RcclxuICAgICAgICBjb25zdCBleGlzdGluZ01vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbCcpO1xyXG4gICAgICAgIGV4aXN0aW5nTW9kYWxzLmZvckVhY2gobW9kYWwgPT4ge1xyXG4gICAgICAgICAgaWYgKG1vZGFsIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgJiYgIW1vZGFsLmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIHtcclxuICAgICAgICAgICAgbW9kYWwuYWRkQ2xhc3MoJ2hpZGRlbicpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBpbXBvcnQoJy4uL3VpL1F1aWNrU3dpdGNoTW9kYWwnKS50aGVuKCh7IFF1aWNrU3dpdGNoTW9kYWwgfSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBRdWlja1N3aXRjaE1vZGFsKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4pO1xyXG4gICAgICAgICAgICBtb2RhbC5vcGVuKCk7XHJcbiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIG9yaWdpbmFsIGNvbW1hbmQgaWYgb3VyIG1vZGFsIGZhaWxzXHJcbiAgICAgICAgICAgIGlmICh0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kICYmIHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQuY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLmNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgICAgLy8gRmFsbGJhY2sgdG8gb3JpZ2luYWwgY29tbWFuZCBpZiBvdXIgbW9kYWwgZmFpbHNcclxuICAgICAgICAgIGlmICh0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kICYmIHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQuY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5jYWxsYmFjaygpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBEaXJlY3RseSBhc3NpZ24gdG8gdGhlIGNvbW1hbmQgcmVnaXN0cnkgaW5zdGVhZCBvZiB1c2luZyBhZGRDb21tYW5kXHJcbiAgICBjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddID0gY3VzdG9tQ29tbWFuZDtcclxuXHJcbiAgICB0aGlzLmlzQ29tbWFuZE92ZXJyaWRkZW4gPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgcmVzdG9yZU9yaWdpbmFsQ29tbWFuZCgpIHtcclxuICAgIGlmICghdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVtb3ZlIG91ciBjb21tYW5kXHJcbiAgICBjb25zdCBjb21tYW5kcyA9ICh0aGlzLnBsdWdpbi5hcHAgYXMgdW5rbm93biBhcyBBcHBJbnRlcm5hbCkuY29tbWFuZHMuY29tbWFuZHM7XHJcbiAgICBpZiAoY29tbWFuZHNbJ3N3aXRjaGVyOm9wZW4nXSkge1xyXG4gICAgICBkZWxldGUgY29tbWFuZHNbJ3N3aXRjaGVyOm9wZW4nXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXN0b3JlIHRoZSBvcmlnaW5hbCBjb21tYW5kXHJcbiAgICBjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddID0ge1xyXG4gICAgICBpZDogdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5pZCxcclxuICAgICAgbmFtZTogdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5uYW1lLFxyXG4gICAgICBpY29uOiB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLmljb24sXHJcbiAgICAgIGhvdGtleXM6IHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQuaG90a2V5cyxcclxuICAgICAgY2FsbGJhY2s6IHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQuY2FsbGJhY2tcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pc0NvbW1hbmRPdmVycmlkZGVuID0gZmFsc2U7XHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBURmlsZSwgTWFya2Rvd25WaWV3LCBFZGl0b3IgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBnZXRGcm9udG1hdHRlclN5bmMgfSBmcm9tIFwiLi4vdXRpbHMvZnJvbnRtYXR0ZXJcIjtcblxuZXhwb3J0IGNsYXNzIERyYWdEcm9wU2VydmljZSB7XG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcbiAgcHJpdmF0ZSBsYXN0RHJvcFRpbWU6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgbGFzdERyb3BEYXRhOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZWFkb25seSBEUk9QX0RFQk9VTkNFX01TID0gMTAwOyAvLyBQcmV2ZW50IGR1cGxpY2F0ZSBwcm9jZXNzaW5nIHdpdGhpbiAxMDBtc1xuXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGhhbmRsZURyYWdEcm9wKGV2ZW50OiBEcmFnRXZlbnQsIGVkaXRvcjogRWRpdG9yKTogdm9pZCB7XG4gICAgLy8gQ1JJVElDQUw6IENhcHR1cmUgZGF0YVRyYW5zZmVyIHN5bmNocm9ub3VzbHkgaW4gYSBsb2NhbCB2YXJpYWJsZVxuICAgIC8vIFRoZSBldmVudC5kYXRhVHJhbnNmZXIgY2FuIGJlY29tZSBudWxsL3VuZGVmaW5lZCBhZnRlciB0aGUgZXZlbnQgaGFuZGxlciBjb21wbGV0ZXMsXG4gICAgLy8gc28gd2UgbXVzdCBjYXB0dXJlIGl0IGltbWVkaWF0ZWx5IGFuZCB1c2UgdGhlIGxvY2FsIHJlZmVyZW5jZVxuICAgIGNvbnN0IGRhdGFUcmFuc2ZlciA9IGV2ZW50LmRhdGFUcmFuc2ZlcjtcbiAgICBpZiAoIWRhdGFUcmFuc2Zlcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgZmlsZSBwYXRoIGZyb20gdGhlIGRyYWcgZXZlbnQgc3luY2hyb25vdXNseVxuICAgIC8vIFRoaXMgbXVzdCBiZSBkb25lIGR1cmluZyB0aGUgZXZlbnQsIG5vdCBpbiBzZXRUaW1lb3V0XG4gICAgLy8gVXNlIHRoZSBjYXB0dXJlZCBkYXRhVHJhbnNmZXIgcmVmZXJlbmNlLCBub3QgZXZlbnQuZGF0YVRyYW5zZmVyXG4gICAgY29uc3QgZmlsZVBhdGggPSBkYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xuICAgIFxuICAgIGlmICghZmlsZVBhdGggfHwgKCFmaWxlUGF0aC5lbmRzV2l0aCgnLm1kJykgJiYgIShmaWxlUGF0aC5lbmRzV2l0aCgnLm1keCcpICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFByZXZlbnQgZHVwbGljYXRlIHByb2Nlc3NpbmcgaWYgYm90aCBoYW5kbGVycyBmaXJlIGZvciB0aGUgc2FtZSBkcm9wXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBpZiAobm93IC0gdGhpcy5sYXN0RHJvcFRpbWUgPCB0aGlzLkRST1BfREVCT1VOQ0VfTVMgJiYgdGhpcy5sYXN0RHJvcERhdGEgPT09IGZpbGVQYXRoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubGFzdERyb3BUaW1lID0gbm93O1xuICAgIHRoaXMubGFzdERyb3BEYXRhID0gZmlsZVBhdGg7XG5cbiAgICAvLyBGaW5kIHRoZSBmaWxlIGluIHRoZSB2YXVsdFxuICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcbiAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRm9yIC5tZCBmaWxlcywgdXNlIHN5bmNocm9ub3VzIGxvZ2ljIChmYXN0LCBpbW1lZGlhdGUpXG4gICAgLy8gRm9yIC5tZHggZmlsZXMsIHVzZSBhc3luYyBsb2dpYyB3aXRoIHJldHJpZXMgKG5lZWRzIGZpbGUgcmVhZGluZylcbiAgICBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gdGhpcy5nZXREaXNwbGF5TmFtZVN5bmMoZmlsZSk7XG4gICAgICBpZiAoZGlzcGxheU5hbWUgIT09IG51bGwpIHtcbiAgICAgICAgLy8gSW1tZWRpYXRlIHJlcGxhY2VtZW50IGZvciAubWQgZmlsZXMgKG5vIHJldHJpZXMgbmVlZGVkKVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLnJlcGxhY2VMYXN0SW5zZXJ0ZWRMaW5rKGZpbGUsIGRpc3BsYXlOYW1lLCBlZGl0b3IpO1xuICAgICAgICB9LCA1MCk7IC8vIFNob3J0IGRlbGF5IGp1c3QgdG8gbGV0IE9ic2lkaWFuIGluc2VydCB0aGUgbGluayBmaXJzdFxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpIHtcbiAgICAgIC8vIEFzeW5jIGxvZ2ljIHdpdGggcmV0cmllcyBmb3IgLm1keCBmaWxlc1xuICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IGF3YWl0IHRoaXMuZ2V0RGlzcGxheU5hbWUoZmlsZSk7XG5cbiAgICAgICAgaWYgKGRpc3BsYXlOYW1lICE9PSBudWxsKSB7XG4gICAgICAgICAgLy8gVXNlIG11bHRpcGxlIGF0dGVtcHRzIHdpdGggaW5jcmVhc2luZyBkZWxheXMgdG8gY2F0Y2ggdGhlIGxpbmsgaW5zZXJ0aW9uXG4gICAgICAgICAgbGV0IGF0dGVtcHRzID0gMDtcbiAgICAgICAgICBjb25zdCBtYXhBdHRlbXB0cyA9IDU7XG4gICAgICAgICAgY29uc3QgYXR0ZW1wdFJlcGxhY2UgPSAoKSA9PiB7XG4gICAgICAgICAgICBhdHRlbXB0cysrO1xuICAgICAgICAgICAgY29uc3QgcmVwbGFjZWQgPSB0aGlzLnJlcGxhY2VMYXN0SW5zZXJ0ZWRMaW5rKGZpbGUsIGRpc3BsYXlOYW1lLCBlZGl0b3IpO1xuICAgICAgICAgICAgaWYgKCFyZXBsYWNlZCAmJiBhdHRlbXB0cyA8IG1heEF0dGVtcHRzKSB7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoYXR0ZW1wdFJlcGxhY2UsIDUwICogYXR0ZW1wdHMpOyAvLyBJbmNyZWFzaW5nIGRlbGF5OiA1MG1zLCAxMDBtcywgMTUwbXMsIGV0Yy5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIHNldFRpbWVvdXQoYXR0ZW1wdFJlcGxhY2UsIDE1MCk7IC8vIFN0YXJ0IGFmdGVyIDE1MG1zXG4gICAgICAgIH1cbiAgICAgIH0pKCk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlRE9NRHJvcChldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XG4gICAgLy8gQ2hlY2sgaWYgd2UncmUgZHJvcHBpbmcgb24gYW4gZWRpdG9yXG4gICAgLy8gVXNlIG11bHRpcGxlIG1ldGhvZHMgdG8gZGV0ZWN0IGVkaXRvciBjb250ZXh0LCBhcyBjbG9zZXN0KCkgY2FuIGZhaWxcbiAgICAvLyB3aGVuIGRyb3BwaW5nIG9uIGNtLWxpbmUgZWxlbWVudHMgdGhhdCBhcmVuJ3QgZnVsbHkgYXR0YWNoZWQgdG8gRE9NIChsYXJnZSB2YXVsdCBsYWcpXG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgIFxuICAgIC8vIE1ldGhvZCAxOiBUcnkgRE9NIHRyYXZlcnNhbCAod29ya3Mgd2hlbiBlbGVtZW50IGlzIGZ1bGx5IGF0dGFjaGVkKVxuICAgIGNvbnN0IGVkaXRvckVsZW1lbnQgPSB0YXJnZXQ/LmNsb3Nlc3QoJy5jbS1lZGl0b3InKTtcbiAgICBcbiAgICAvLyBNZXRob2QgMjogRmFsbGJhY2sgLSBjaGVjayBpZiB0aGVyZSdzIGFuIGFjdGl2ZSBtYXJrZG93biB2aWV3IHdpdGggYW4gZWRpdG9yXG4gICAgLy8gVGhpcyB3b3JrcyBldmVuIHdoZW4gRE9NIHRyYXZlcnNhbCBmYWlscyBkdWUgdG8gdGltaW5nL2xhZyBpc3N1ZXMgaW4gbGFyZ2UgdmF1bHRzXG4gICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgIGNvbnN0IGhhc0FjdGl2ZUVkaXRvciA9IGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgXG4gICAgLy8gV2UgbmVlZCBhdCBsZWFzdCBvbmUgb2YgdGhlc2UgdG8gYmUgdHJ1ZSB0byBwcm9jZWVkXG4gICAgaWYgKCFlZGl0b3JFbGVtZW50ICYmICFoYXNBY3RpdmVFZGl0b3IpIHtcbiAgICAgIC8vIE5vdCBkcm9wcGluZyBvbiBhbiBlZGl0b3Igb3Igbm8gYWN0aXZlIGVkaXRvciBhdmFpbGFibGVcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgLy8gSWYgY2xvc2VzdCgpIGZhaWxlZCBidXQgd2UgaGF2ZSBhbiBhY3RpdmUgZWRpdG9yLCB3ZSBjYW4gc3RpbGwgcHJvY2VlZFxuICAgIC8vIFRoZSBhY3RpdmVWaWV3LmVkaXRvciB3aWxsIGJlIHVzZWQgbGF0ZXIgaW4gdGhlIHNldFRpbWVvdXRcblxuICAgIC8vIENSSVRJQ0FMOiBDYXB0dXJlIGRhdGFUcmFuc2ZlciBzeW5jaHJvbm91c2x5IGluIGEgbG9jYWwgdmFyaWFibGVcbiAgICAvLyBUaGUgZXZlbnQuZGF0YVRyYW5zZmVyIGNhbiBiZWNvbWUgbnVsbC91bmRlZmluZWQgYWZ0ZXIgdGhlIGV2ZW50IGhhbmRsZXIgY29tcGxldGVzLFxuICAgIC8vIHNvIHdlIG11c3QgY2FwdHVyZSBpdCBpbW1lZGlhdGVseSBhbmQgdXNlIHRoZSBsb2NhbCByZWZlcmVuY2VcbiAgICBjb25zdCBkYXRhVHJhbnNmZXIgPSBldmVudC5kYXRhVHJhbnNmZXI7XG4gICAgaWYgKCFkYXRhVHJhbnNmZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGZpbGUgcGF0aCBmcm9tIHRoZSBkcmFnIGV2ZW50IHN5bmNocm9ub3VzbHlcbiAgICAvLyBUaGlzIG11c3QgYmUgZG9uZSBkdXJpbmcgdGhlIGV2ZW50LCBub3QgaW4gc2V0VGltZW91dFxuICAgIC8vIFVzZSB0aGUgY2FwdHVyZWQgZGF0YVRyYW5zZmVyIHJlZmVyZW5jZSwgbm90IGV2ZW50LmRhdGFUcmFuc2ZlclxuICAgIGNvbnN0IGZpbGVQYXRoID0gZGF0YVRyYW5zZmVyLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcbiAgICBcbiAgICBpZiAoIWZpbGVQYXRoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgT2JzaWRpYW4gVVJMIGZvcm1hdDogb2JzaWRpYW46Ly9vcGVuP3ZhdWx0PS4uLiZmaWxlPS4uLlxuICAgIGxldCBhY3R1YWxGaWxlUGF0aCA9IGZpbGVQYXRoO1xuICAgIGlmIChmaWxlUGF0aC5zdGFydHNXaXRoKCdvYnNpZGlhbjovL29wZW4/JykpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoZmlsZVBhdGgpO1xuICAgICAgICBjb25zdCBmaWxlUGFyYW0gPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnZmlsZScpO1xuICAgICAgICBpZiAoZmlsZVBhcmFtKSB7XG4gICAgICAgICAgY29uc3QgZGVjb2RlZFBhdGggPSBkZWNvZGVVUklDb21wb25lbnQoZmlsZVBhcmFtKTtcbiAgICAgICAgICAvLyBPYnNpZGlhbiBVUkxzIG1pZ2h0IG5vdCBpbmNsdWRlIHRoZSBleHRlbnNpb25cbiAgICAgICAgICAvLyBUcnkgdG8gZmluZCB0aGUgZmlsZSB3aXRoIGJvdGggLm1kIGFuZCAubWR4IGV4dGVuc2lvbnNcbiAgICAgICAgICBpZiAoZGVjb2RlZFBhdGguZW5kc1dpdGgoJy5tZHgnKSkge1xuICAgICAgICAgICAgLy8gQWxyZWFkeSBoYXMgLm1keCBleHRlbnNpb25cbiAgICAgICAgICAgIGFjdHVhbEZpbGVQYXRoID0gZGVjb2RlZFBhdGg7XG4gICAgICAgICAgfSBlbHNlIGlmIChkZWNvZGVkUGF0aC5lbmRzV2l0aCgnLm1kJykpIHtcbiAgICAgICAgICAgIC8vIEFscmVhZHkgaGFzIC5tZCBleHRlbnNpb25cbiAgICAgICAgICAgIGFjdHVhbEZpbGVQYXRoID0gZGVjb2RlZFBhdGg7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE5vIGV4dGVuc2lvbiAtIHRyeSAubWR4IGZpcnN0IGlmIE1EWCBzdXBwb3J0IGlzIGVuYWJsZWQsIHRoZW4gZmFsbCBiYWNrIHRvIC5tZFxuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpIHtcbiAgICAgICAgICAgICAgY29uc3QgbWR4RmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGVjb2RlZFBhdGggKyAnLm1keCcpO1xuICAgICAgICAgICAgICBpZiAobWR4RmlsZSkge1xuICAgICAgICAgICAgICAgIGFjdHVhbEZpbGVQYXRoID0gZGVjb2RlZFBhdGggKyAnLm1keCc7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWN0dWFsRmlsZVBhdGggPSBkZWNvZGVkUGF0aCArICcubWQnO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhY3R1YWxGaWxlUGF0aCA9IGRlY29kZWRQYXRoICsgJy5tZCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCFmaWxlUGF0aC5lbmRzV2l0aCgnLm1kJykgJiYgIShmaWxlUGF0aC5lbmRzV2l0aCgnLm1keCcpICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU1keFN1cHBvcnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUHJldmVudCBkdXBsaWNhdGUgcHJvY2Vzc2luZyBpZiBib3RoIGhhbmRsZXJzIGZpcmUgZm9yIHRoZSBzYW1lIGRyb3BcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLmxhc3REcm9wVGltZSA8IHRoaXMuRFJPUF9ERUJPVU5DRV9NUyAmJiB0aGlzLmxhc3REcm9wRGF0YSA9PT0gYWN0dWFsRmlsZVBhdGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5sYXN0RHJvcFRpbWUgPSBub3c7XG4gICAgdGhpcy5sYXN0RHJvcERhdGEgPSBhY3R1YWxGaWxlUGF0aDtcblxuICAgIC8vIEZpbmQgdGhlIGZpbGUgaW4gdGhlIHZhdWx0XG4gICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYWN0dWFsRmlsZVBhdGgpO1xuICAgIFxuICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGRpc3BsYXkgbmFtZSBmcm9tIGZyb250bWF0dGVyIChvbmx5IGlmIHByb3BlcnR5IGV4aXN0cylcbiAgICAoKCkgPT4ge1xuICAgICAgLy8gRm9yIC5tZCBmaWxlcywgdXNlIHN5bmNocm9ub3VzIGxvZ2ljIChmYXN0LCBpbW1lZGlhdGUpXG4gICAgICAvLyBGb3IgLm1keCBmaWxlcywgdXNlIGFzeW5jIGxvZ2ljIHdpdGggcmV0cmllcyAobmVlZHMgZmlsZSByZWFkaW5nKVxuICAgICAgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gdGhpcy5nZXREaXNwbGF5TmFtZVN5bmMoZmlsZSk7XG4gICAgICAgIGlmIChkaXNwbGF5TmFtZSAhPT0gbnVsbCkge1xuICAgICAgICAgIC8vIEltbWVkaWF0ZSByZXBsYWNlbWVudCBmb3IgLm1kIGZpbGVzIChubyByZXRyaWVzIG5lZWRlZClcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgIGlmIChhY3RpdmVWaWV3ICYmIGFjdGl2ZVZpZXcuZWRpdG9yKSB7XG4gICAgICAgICAgICAgIHRoaXMucmVwbGFjZUxhc3RJbnNlcnRlZExpbmsoZmlsZSwgZGlzcGxheU5hbWUsIGFjdGl2ZVZpZXcuZWRpdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCA1MCk7IC8vIFNob3J0IGRlbGF5IGp1c3QgdG8gbGV0IE9ic2lkaWFuIGluc2VydCB0aGUgbGluayBmaXJzdFxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XG4gICAgICAgIC8vIEFzeW5jIGxvZ2ljIHdpdGggcmV0cmllcyBmb3IgLm1keCBmaWxlc1xuICAgICAgICB2b2lkIChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgZGlzcGxheU5hbWUgPSBhd2FpdCB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGUpO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChkaXNwbGF5TmFtZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gVXNlIG11bHRpcGxlIGF0dGVtcHRzIHdpdGggaW5jcmVhc2luZyBkZWxheXMgdG8gY2F0Y2ggdGhlIGxpbmsgaW5zZXJ0aW9uXG4gICAgICAgICAgICBsZXQgYXR0ZW1wdHMgPSAwO1xuICAgICAgICAgICAgY29uc3QgbWF4QXR0ZW1wdHMgPSA1O1xuICAgICAgICAgICAgY29uc3QgYXR0ZW1wdFJlcGxhY2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgIGF0dGVtcHRzKys7XG4gICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5lZGl0b3IpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlZCA9IHRoaXMucmVwbGFjZUxhc3RJbnNlcnRlZExpbmsoZmlsZSwgZGlzcGxheU5hbWUsIGFjdGl2ZVZpZXcuZWRpdG9yKTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlcGxhY2VkICYmIGF0dGVtcHRzIDwgbWF4QXR0ZW1wdHMpIHtcbiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXR0ZW1wdFJlcGxhY2UsIDUwICogYXR0ZW1wdHMpOyAvLyBJbmNyZWFzaW5nIGRlbGF5OiA1MG1zLCAxMDBtcywgMTUwbXMsIGV0Yy5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoYXR0ZW1wdHMgPCBtYXhBdHRlbXB0cykge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXR0ZW1wdFJlcGxhY2UsIDUwICogYXR0ZW1wdHMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2V0VGltZW91dChhdHRlbXB0UmVwbGFjZSwgMTUwKTsgLy8gU3RhcnQgYWZ0ZXIgMTUwbXNcbiAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgICB9XG4gICAgfSkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTeW5jaHJvbm91cyB2ZXJzaW9uIGZvciAubWQgZmlsZXMgKGZhc3QsIGltbWVkaWF0ZSlcbiAgICovXG4gIHByaXZhdGUgZ2V0RGlzcGxheU5hbWVTeW5jKGZpbGU6IFRGaWxlKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgaWYgKGZpbGUuZXh0ZW5zaW9uICE9PSAnbWQnKSB7XG4gICAgICByZXR1cm4gbnVsbDsgLy8gT25seSBmb3IgLm1kIGZpbGVzXG4gICAgfVxuXG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBnZXRGcm9udG1hdHRlclN5bmModGhpcy5wbHVnaW4uYXBwLCBmaWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG4gICAgXG4gICAgaWYgKGZyb250bWF0dGVyICYmIGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gdW5kZWZpbmVkICYmIGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gbnVsbCkge1xuICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IFN0cmluZyhmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0pLnRyaW0oKTtcbiAgICAgIGlmIChwcm9wZXJ0eVZhbHVlICE9PSAnJykge1xuICAgICAgICByZXR1cm4gcHJvcGVydHlWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDsgLy8gTm8gcHJvcGVydHkgLSB1c2UgZGVmYXVsdCBPYnNpZGlhbiBiZWhhdmlvclxuICB9XG5cbiAgLyoqXG4gICAqIEFzeW5jIHZlcnNpb24gZm9yIC5tZHggZmlsZXMgKG5lZWRzIGZpbGUgcmVhZGluZylcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0RGlzcGxheU5hbWUoZmlsZTogVEZpbGUpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICBjb25zdCB7IGdldEZyb250bWF0dGVyLCBpc0ZpbGVUeXBlU3VwcG9ydGVkIH0gPSBhd2FpdCBpbXBvcnQoJy4uL3V0aWxzL2Zyb250bWF0dGVyJyk7XG4gICAgXG4gICAgLy8gU2tpcCB1bnN1cHBvcnRlZCBmaWxlIHR5cGVzXG4gICAgaWYgKCFpc0ZpbGVUeXBlU3VwcG9ydGVkKGZpbGUuZXh0ZW5zaW9uLCB0aGlzLnBsdWdpbi5zZXR0aW5ncykpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gYXdhaXQgZ2V0RnJvbnRtYXR0ZXIodGhpcy5wbHVnaW4uYXBwLCBmaWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG4gICAgXG4gICAgLy8gT25seSByZXR1cm4gZGlzcGxheSBuYW1lIGlmIHRoZSBwcm9wZXJ0eSBleGlzdHMgYW5kIGhhcyBhIHZhbHVlXG4gICAgLy8gUmV0dXJuIG51bGwgaWYgcHJvcGVydHkgZG9lc24ndCBleGlzdCAodG8gaW5kaWNhdGUgd2Ugc2hvdWxkIHVzZSBkZWZhdWx0IGJlaGF2aW9yKVxuICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcoZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldKS50cmltKCk7XG4gICAgICBpZiAocHJvcGVydHlWYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgcmV0dXJuIHByb3BlcnR5VmFsdWU7IC8vIFVzZSBmcm9udG1hdHRlciB0aXRsZVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsOyAvLyBObyBwcm9wZXJ0eSAtIHVzZSBkZWZhdWx0IE9ic2lkaWFuIGJlaGF2aW9yXG4gIH1cblxuICBwcml2YXRlIHJlcGxhY2VMYXN0SW5zZXJ0ZWRMaW5rKGZpbGU6IFRGaWxlLCBkaXNwbGF5TmFtZTogc3RyaW5nLCBlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgXG4gICAgLy8gTG9vayBmb3IgdGhlIG1vc3QgcmVjZW50bHkgaW5zZXJ0ZWQgbGluayBuZWFyIHRoZSBjdXJzb3JcbiAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gbGluZXNbY3Vyc29yLmxpbmVdO1xuICAgIFxuICAgIC8vIEZpbmQgd2lraSBsaW5rcyBvciBtYXJrZG93biBsaW5rcyBvbiB0aGUgY3VycmVudCBsaW5lXG4gICAgLy8gVXBkYXRlZCByZWdleCB0byBoYW5kbGUgTURYIGZpbGVzIC0gdGhleSBtaWdodCBoYXZlIC5tZHggZXh0ZW5zaW9uIGluIHRoZSBsaW5rXG4gICAgLy8gTm90ZTogbWFya2Rvd24gbGlua3MgY2FuIGhhdmUgZW1wdHkgYnJhY2tldHM6IFtdKGZpbGUubWR4KVxuICAgIGNvbnN0IHdpa2lMaW5rUmVnZXggPSAvXFxbXFxbKFteXFxdXSspXFxdXFxdL2c7XG4gICAgY29uc3QgbWFya2Rvd25MaW5rUmVnZXggPSAvXFxbKFteXFxdXSopXFxdXFwoKFteKV0rKVxcKS9nOyAvLyBBbGxvdyBlbXB0eSBicmFja2V0cyB3aXRoICpcbiAgICBcbiAgICBsZXQgbWF0Y2g7XG4gICAgbGV0IGxhc3RNYXRjaCA9IG51bGw7XG4gICAgXG4gICAgLy8gRmluZCB0aGUgbGFzdCB3aWtpIGxpbmsgb24gdGhlIGN1cnJlbnQgbGluZVxuICAgIHdoaWxlICgobWF0Y2ggPSB3aWtpTGlua1JlZ2V4LmV4ZWMoY3VycmVudExpbmUpKSAhPT0gbnVsbCkge1xuICAgICAgbGFzdE1hdGNoID0gbWF0Y2g7XG4gICAgfVxuICAgIFxuICAgIGlmIChsYXN0TWF0Y2gpIHtcbiAgICAgIGNvbnN0IGxpbmtQYXRoID0gbGFzdE1hdGNoWzFdO1xuICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBsaW5rIG1hdGNoZXMgb3VyIGZpbGUgKHdpdGggb3Igd2l0aG91dCBleHRlbnNpb24pXG4gICAgICBjb25zdCBmaWxlUGF0aFdpdGhvdXRFeHQgPSBmaWxlLnBhdGgucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgJycpO1xuICAgICAgY29uc3QgbGlua1BhdGhXaXRob3V0RXh0ID0gbGlua1BhdGgucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgJycpO1xuICAgICAgXG4gICAgICBpZiAoZmlsZVBhdGhXaXRob3V0RXh0ID09PSBsaW5rUGF0aFdpdGhvdXRFeHQgfHwgZmlsZS5wYXRoID09PSBsaW5rUGF0aCB8fCBmaWxlLnBhdGgucmVwbGFjZSgvXFwubWR4JC8sICcubWQnKSA9PT0gbGlua1BhdGgpIHtcbiAgICAgICAgY29uc3QgbmV3TGlua1RleHQgPSBgW1ske2xpbmtQYXRofXwke2Rpc3BsYXlOYW1lfV1dYDtcbiAgICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGFzdE1hdGNoLmluZGV4IH07XG4gICAgICAgIGNvbnN0IGVuZFBvcyA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBsYXN0TWF0Y2guaW5kZXggKyBsYXN0TWF0Y2hbMF0ubGVuZ3RoIH07XG4gICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3TGlua1RleHQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gUmVzZXQgcmVnZXggZm9yIG1hcmtkb3duIGxpbmtzXG4gICAgbWFya2Rvd25MaW5rUmVnZXgubGFzdEluZGV4ID0gMDtcbiAgICBsYXN0TWF0Y2ggPSBudWxsO1xuICAgIFxuICAgIC8vIEZpbmQgdGhlIGxhc3QgbWFya2Rvd24gbGluayBvbiB0aGUgY3VycmVudCBsaW5lXG4gICAgd2hpbGUgKChtYXRjaCA9IG1hcmtkb3duTGlua1JlZ2V4LmV4ZWMoY3VycmVudExpbmUpKSAhPT0gbnVsbCkge1xuICAgICAgbGFzdE1hdGNoID0gbWF0Y2g7XG4gICAgfVxuICAgIFxuICAgIGlmIChsYXN0TWF0Y2gpIHtcbiAgICAgIGNvbnN0IGxpbmtVcmwgPSBsYXN0TWF0Y2hbMl07XG4gICAgICBjb25zdCBsaW5rVXJsRGVjb2RlZCA9IGRlY29kZVVSSUNvbXBvbmVudChsaW5rVXJsKTtcbiAgICAgIC8vIENoZWNrIGlmIHRoaXMgbGluayBtYXRjaGVzIG91ciBmaWxlXG4gICAgICBjb25zdCBmaWxlUGF0aEVuY29kZWQgPSBlbmNvZGVVUkkoZmlsZS5wYXRoKTtcbiAgICAgIGNvbnN0IGZpbGVQYXRoV2l0aG91dEV4dCA9IGZpbGUucGF0aC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCAnJyk7XG4gICAgICBjb25zdCBsaW5rVXJsV2l0aG91dEV4dCA9IGxpbmtVcmxEZWNvZGVkLnJlcGxhY2UoL1xcLihtZHxtZHgpJC8sICcnKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgdmFyaW91cyBtYXRjaGluZyBzY2VuYXJpb3NcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBcbiAgICAgICAgZmlsZS5wYXRoID09PSBsaW5rVXJsRGVjb2RlZCB8fCBcbiAgICAgICAgZmlsZVBhdGhFbmNvZGVkID09PSBsaW5rVXJsIHx8XG4gICAgICAgIGZpbGVQYXRoV2l0aG91dEV4dCA9PT0gbGlua1VybFdpdGhvdXRFeHQgfHxcbiAgICAgICAgZmlsZS5wYXRoLnJlcGxhY2UoL1xcLm1keCQvLCAnLm1kJykgPT09IGxpbmtVcmxEZWNvZGVkIHx8XG4gICAgICAgIGZpbGUucGF0aC5yZXBsYWNlKC9cXC5tZCQvLCAnLm1keCcpID09PSBsaW5rVXJsRGVjb2RlZCB8fFxuICAgICAgICAvLyBIYW5kbGUgcmVsYXRpdmUgcGF0aHMgLSBjaGVjayBpZiBsaW5rIFVSTCBtYXRjaGVzIGZpbGUgYmFzZW5hbWVcbiAgICAgICAgZmlsZS5iYXNlbmFtZSA9PT0gbGlua1VybERlY29kZWQucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgJycpIHx8XG4gICAgICAgIGZpbGUuYmFzZW5hbWUgKyAnLm1keCcgPT09IGxpbmtVcmxEZWNvZGVkIHx8XG4gICAgICAgIGZpbGUuYmFzZW5hbWUgKyAnLm1kJyA9PT0gbGlua1VybERlY29kZWQgfHxcbiAgICAgICAgLy8gSGFuZGxlIHBhdGhzIHdpdGggZGlyZWN0b3J5XG4gICAgICAgIGZpbGUucGF0aC5lbmRzV2l0aChsaW5rVXJsRGVjb2RlZCkgfHxcbiAgICAgICAgbGlua1VybERlY29kZWQuZW5kc1dpdGgoZmlsZS5wYXRoKTtcbiAgICAgIFxuICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgY29uc3QgbmV3TGlua1RleHQgPSBgWyR7ZGlzcGxheU5hbWV9XSgke2xpbmtVcmx9KWA7XG4gICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGxhc3RNYXRjaC5pbmRleCB9O1xuICAgICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGFzdE1hdGNoLmluZGV4ICsgbGFzdE1hdGNoWzBdLmxlbmd0aCB9O1xuICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0xpbmtUZXh0LCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFRyeSBzZWFyY2hpbmcgYSBmZXcgbGluZXMgYXJvdW5kIHRoZSBjdXJzb3JcbiAgICAgIGNvbnN0IHNlYXJjaFJhbmdlID0gMztcbiAgICAgIGZvciAobGV0IGkgPSBNYXRoLm1heCgwLCBjdXJzb3IubGluZSAtIHNlYXJjaFJhbmdlKTsgaSA8PSBNYXRoLm1pbihsaW5lcy5sZW5ndGggLSAxLCBjdXJzb3IubGluZSArIHNlYXJjaFJhbmdlKTsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgY29uc3Qgd2lraU1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbCgvXFxbXFxbKFteXFxdXSspXFxdXFxdL2cpXTtcbiAgICAgICAgY29uc3QgbWFya2Rvd25NYXRjaGVzID0gWy4uLmxpbmUubWF0Y2hBbGwoL1xcWyhbXlxcXV0qKVxcXVxcKChbXildKylcXCkvZyldO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgd2lraSBsaW5rc1xuICAgICAgICBmb3IgKGNvbnN0IHdpa2lNYXRjaCBvZiB3aWtpTWF0Y2hlcykge1xuICAgICAgICAgIGNvbnN0IGxpbmtQYXRoID0gd2lraU1hdGNoWzFdO1xuICAgICAgICAgIGNvbnN0IGZpbGVQYXRoV2l0aG91dEV4dCA9IGZpbGUucGF0aC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCAnJyk7XG4gICAgICAgICAgY29uc3QgbGlua1BhdGhXaXRob3V0RXh0ID0gbGlua1BhdGgucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgJycpO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChmaWxlUGF0aFdpdGhvdXRFeHQgPT09IGxpbmtQYXRoV2l0aG91dEV4dCB8fCBmaWxlLnBhdGggPT09IGxpbmtQYXRoIHx8IGZpbGUucGF0aC5yZXBsYWNlKC9cXC5tZHgkLywgJy5tZCcpID09PSBsaW5rUGF0aCkge1xuICAgICAgICAgICAgY29uc3QgbmV3TGlua1RleHQgPSBgW1ske2xpbmtQYXRofXwke2Rpc3BsYXlOYW1lfV1dYDtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoSW5kZXggPSB3aWtpTWF0Y2guaW5kZXggPz8gMDtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBpLCBjaDogbWF0Y2hJbmRleCB9O1xuICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBpLCBjaDogbWF0Y2hJbmRleCArIHdpa2lNYXRjaFswXS5sZW5ndGggfTtcbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3TGlua1RleHQsIHN0YXJ0UG9zLCBlbmRQb3MpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBtYXJrZG93biBsaW5rc1xuICAgICAgICBmb3IgKGNvbnN0IG1kTWF0Y2ggb2YgbWFya2Rvd25NYXRjaGVzKSB7XG4gICAgICAgICAgY29uc3QgbGlua1VybCA9IG1kTWF0Y2hbMl07XG4gICAgICAgICAgLy8gSGFuZGxlIGJvdGggcmVsYXRpdmUgcGF0aHMgKGJpZy10ZXN0Lm1keCkgYW5kIGZ1bGwgcGF0aHMgKHBvc3RzL2JpZy10ZXN0Lm1keClcbiAgICAgICAgICBjb25zdCBsaW5rVXJsRGVjb2RlZCA9IGRlY29kZVVSSUNvbXBvbmVudChsaW5rVXJsKTtcbiAgICAgICAgICBjb25zdCBmaWxlUGF0aFdpdGhvdXRFeHQgPSBmaWxlLnBhdGgucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgJycpO1xuICAgICAgICAgIGNvbnN0IGxpbmtVcmxXaXRob3V0RXh0ID0gbGlua1VybERlY29kZWQucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgJycpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIENoZWNrIHZhcmlvdXMgbWF0Y2hpbmcgc2NlbmFyaW9zXG4gICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IFxuICAgICAgICAgICAgZmlsZS5wYXRoID09PSBsaW5rVXJsRGVjb2RlZCB8fCBcbiAgICAgICAgICAgIGVuY29kZVVSSShmaWxlLnBhdGgpID09PSBsaW5rVXJsIHx8XG4gICAgICAgICAgICBmaWxlLnBhdGgucmVwbGFjZSgvXFwubWR4JC8sICcubWQnKSA9PT0gbGlua1VybERlY29kZWQgfHxcbiAgICAgICAgICAgIGZpbGUucGF0aC5yZXBsYWNlKC9cXC5tZCQvLCAnLm1keCcpID09PSBsaW5rVXJsRGVjb2RlZCB8fFxuICAgICAgICAgICAgZmlsZVBhdGhXaXRob3V0RXh0ID09PSBsaW5rVXJsV2l0aG91dEV4dCB8fFxuICAgICAgICAgICAgLy8gSGFuZGxlIHJlbGF0aXZlIHBhdGhzIC0gY2hlY2sgaWYgbGluayBVUkwgbWF0Y2hlcyBmaWxlIGJhc2VuYW1lXG4gICAgICAgICAgICBmaWxlLmJhc2VuYW1lID09PSBsaW5rVXJsRGVjb2RlZC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCAnJykgfHxcbiAgICAgICAgICAgIGZpbGUuYmFzZW5hbWUgKyAnLm1keCcgPT09IGxpbmtVcmxEZWNvZGVkIHx8XG4gICAgICAgICAgICBmaWxlLmJhc2VuYW1lICsgJy5tZCcgPT09IGxpbmtVcmxEZWNvZGVkIHx8XG4gICAgICAgICAgICAvLyBIYW5kbGUgcGF0aHMgd2l0aCBkaXJlY3RvcnlcbiAgICAgICAgICAgIGZpbGUucGF0aC5lbmRzV2l0aChsaW5rVXJsRGVjb2RlZCkgfHxcbiAgICAgICAgICAgIGxpbmtVcmxEZWNvZGVkLmVuZHNXaXRoKGZpbGUucGF0aCk7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0xpbmtUZXh0ID0gYFske2Rpc3BsYXlOYW1lfV0oJHtsaW5rVXJsfSlgO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hJbmRleCA9IG1kTWF0Y2guaW5kZXggPz8gMDtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0UG9zID0geyBsaW5lOiBpLCBjaDogbWF0Y2hJbmRleCB9O1xuICAgICAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBpLCBjaDogbWF0Y2hJbmRleCArIG1kTWF0Y2hbMF0ubGVuZ3RoIH07XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0xpbmtUZXh0LCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBFZGl0b3JTdWdnZXN0LCBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIENhY2hlU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG4gIHByaXZhdGUgc3VnZ2VzdD86IEVkaXRvclN1Z2dlc3Q7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VnZ2VzdChzdWdnZXN0OiBFZGl0b3JTdWdnZXN0KSB7XHJcbiAgICB0aGlzLnN1Z2dlc3QgPSBzdWdnZXN0O1xyXG4gIH1cclxuXHJcbiAgaW52YWxpZGF0ZUNhY2hlKGZpbGU6IFRGaWxlKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5zdWdnZXN0KSB7XHJcbiAgICAgIC8vIHVwZGF0ZUZpbGVDYWNoZSBpcyBub3cgYXN5bmMsIGJ1dCB3ZSBjYW4ndCBhd2FpdCBoZXJlXHJcbiAgICAgIC8vIFRoZSBjYWNoZSB3aWxsIGJlIHVwZGF0ZWQgYXN5bmNocm9ub3VzbHlcclxuICAgICAgdm9pZCB0aGlzLnN1Z2dlc3QudXBkYXRlRmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVidWlsZENhY2hlKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuc3VnZ2VzdCkge1xyXG4gICAgICAvLyBidWlsZEZpbGVDYWNoZSBpcyBub3cgYXN5bmMsIGJ1dCB3ZSBjYW4ndCBhd2FpdCBoZXJlXHJcbiAgICAgIC8vIFRoZSBjYWNoZSB3aWxsIGJlIHJlYnVpbHQgYXN5bmNocm9ub3VzbHlcclxuICAgICAgdm9pZCB0aGlzLnN1Z2dlc3QuYnVpbGRGaWxlQ2FjaGUoKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBHcmFwaCBWaWV3IFNlcnZpY2VcclxuICpcclxuICogVGhpcyBmaWxlIGNvbnRhaW5zIGNvZGUgYWRhcHRlZCBmcm9tIHRoZSBOb2RlIE1hc3F1ZXJhZGUgcGx1Z2luIGJ5IEVsc2FUYW0uXHJcbiAqIE9yaWdpbmFsIHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL0thcGlya2xhYS9vYnNpZGlhbi1ub2RlLW1hc3F1ZXJhZGVcclxuICpcclxuICogVGhlIGNvZGUgaGFzIGJlZW4gbW9kaWZpZWQgdG8gaW50ZWdyYXRlIHdpdGggdGhlIFByb3BlcnR5IE92ZXIgRmlsZSBOYW1lIHBsdWdpblxyXG4gKiBhbmQgdXNlIHRoZSBwbHVnaW4ncyBwcm9wZXJ0eSBrZXkgc2V0dGluZyBpbnN0ZWFkIG9mIE5vZGUgTWFzcXVlcmFkZSdzIGNvbmZpZ3VyYXRpb24uXHJcbiAqXHJcbiAqIE9yaWdpbmFsIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgR1BMdjMuIFRoaXMgZmlsZSBpcyBhbHNvIGxpY2Vuc2VkIHVuZGVyIEdQTHYzLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgVmlldywgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4gfSBmcm9tICcuLi90eXBlcyc7XHJcbmltcG9ydCB7IGZyb250bWF0dGVyQ2FjaGUgfSBmcm9tICcuLi91dGlscy9mcm9udG1hdHRlci1jYWNoZSc7XHJcblxyXG4vLyBTdGF0aWMgZGlzcGxheSBzZXR0aW5ncyAtIGV4YWN0bHkgbGlrZSBOb2RlIE1hc3F1ZXJhZGVcclxubGV0IGdyYXBoRGlzcGxheVNldHRpbmdzOiB7IGVuYWJsZUZvckdyYXBoVmlldzogYm9vbGVhbjsgcHJvcGVydHlLZXk6IHN0cmluZzsgZW5hYmxlTWR4U3VwcG9ydDogYm9vbGVhbjsgYXBwOiBBcHAgfSB8IG51bGwgPSBudWxsO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlR2V0RGlzcGxheVRleHQoYXBwOiBBcHApIHtcclxuXHRyZXR1cm4gZnVuY3Rpb24gZ2V0RGlzcGxheVRleHQodGhpczogR3JhcGhOb2RlKTogc3RyaW5nIHtcclxuXHRcdGlmICghZ3JhcGhEaXNwbGF5U2V0dGluZ3M/LmVuYWJsZUZvckdyYXBoVmlldykge1xyXG5cdFx0XHQvLyBJZiBkaXNhYmxlZCwgdXNlIG9yaWdpbmFsXHJcblx0XHRcdGlmICh0aGlzLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0KSB7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMucG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ3Bvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0IGRvZXMgbm90IGV4aXN0IG9uIG5vZGUnKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBUcnkgdG8gZ2V0IHByb3BlcnR5IHZhbHVlIC0gZXhhY3RseSBsaWtlIE5vZGUgTWFzcXVlcmFkZSBsb2dpYyBidXQgZm9yIHByb3BlcnRpZXNcclxuXHRcdGNvbnN0IGZpbGUgPSBhcHAudmF1bHQuZ2V0RmlsZUJ5UGF0aCh0aGlzLmlkKTtcclxuXHJcblx0XHRpZiAoZmlsZSkge1xyXG5cdFx0XHQvLyBGb3IgYm90aCBNRCBhbmQgTURYIGZpbGVzLCB0cnkgZnJvbnRtYXR0ZXIgcGFyc2luZ1xyXG5cdFx0XHRpZiAoKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnIHx8IChmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcgJiYgZ3JhcGhEaXNwbGF5U2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCkpKSB7XHJcblx0XHRcdFx0aWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XHJcblx0XHRcdFx0XHQvLyBGb3IgTUQgZmlsZXMsIHVzZSBtZXRhZGF0YSBjYWNoZSBkaXJlY3RseSAoZmFzdCBzeW5jIGFjY2VzcylcclxuXHRcdFx0XHRcdGNvbnN0IGZpbGVDYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuXHRcdFx0XHRcdGNvbnN0IG1kRnJvbnRtYXR0ZXIgPSBmaWxlQ2FjaGU/LmZyb250bWF0dGVyO1xyXG5cclxuXHRcdFx0XHRcdGlmIChtZEZyb250bWF0dGVyICYmIG1kRnJvbnRtYXR0ZXJbZ3JhcGhEaXNwbGF5U2V0dGluZ3MucHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgbWRGcm9udG1hdHRlcltncmFwaERpc3BsYXlTZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcclxuXHRcdFx0XHRcdFx0Y29uc3QgcHJvcGVydHlWYWx1ZSA9IFN0cmluZyhtZEZyb250bWF0dGVyW2dyYXBoRGlzcGxheVNldHRpbmdzLnByb3BlcnR5S2V5XSkudHJpbSgpO1xyXG5cdFx0XHRcdFx0XHRpZiAocHJvcGVydHlWYWx1ZSAhPT0gJycpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gcHJvcGVydHlWYWx1ZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZHgnKSB7XHJcblx0XHRcdFx0XHQvLyBGb3IgTURYIGZpbGVzLCBjaGVjayBjYWNoZSBmaXJzdCwgdGhlbiB0cmlnZ2VyIGFzeW5jIHBvcHVsYXRpb24gaWYgbmVlZGVkXHJcblx0XHRcdFx0XHRjb25zdCBjYWNoZWQgPSBmcm9udG1hdHRlckNhY2hlLmdldFN5bmMoZmlsZS5wYXRoKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoY2FjaGVkICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGNhY2hlZCAmJiBjYWNoZWRbZ3JhcGhEaXNwbGF5U2V0dGluZ3MucHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgY2FjaGVkW2dyYXBoRGlzcGxheVNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcoY2FjaGVkW2dyYXBoRGlzcGxheVNldHRpbmdzLnByb3BlcnR5S2V5XSkudHJpbSgpO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChwcm9wZXJ0eVZhbHVlICE9PSAnJykge1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHByb3BlcnR5VmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBUcmlnZ2VyIGFzeW5jIGxvYWQgaW4gYmFja2dyb3VuZFxyXG5cdFx0XHRcdFx0XHR2b2lkIGZyb250bWF0dGVyQ2FjaGUuZ2V0KGFwcCwgZmlsZSwgeyBlbmFibGVNZHhTdXBwb3J0OiBncmFwaERpc3BsYXlTZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0LCBwcm9wZXJ0eUtleTogZ3JhcGhEaXNwbGF5U2V0dGluZ3MucHJvcGVydHlLZXkgfSBhcyBhbnkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEZhbGwgYmFjayB0byBvcmlnaW5hbCBkaXNwbGF5IHRleHQgKGZpbGUgbmFtZSkgLSBleGFjdGx5IGxpa2UgTm9kZSBNYXNxdWVyYWRlXHJcblx0XHRpZiAodGhpcy5wb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5wb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dCgpO1xyXG5cdFx0fVxyXG5cdFx0dGhyb3cgbmV3IEVycm9yKCdwb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dCBkb2VzIG5vdCBleGlzdCBvbiBub2RlJyk7XHJcblx0fTtcclxufVxyXG5cclxuLy8gVHlwZSBkZWZpbml0aW9ucyBmb3IgZ3JhcGggdmlldyBpbnRlcm5hbHNcclxuaW50ZXJmYWNlIEdyYXBoTm9kZUNvbGxlY3Rpb24ge1xyXG4gIGZpcnN0KCk6IEdyYXBoTm9kZSB8IHVuZGVmaW5lZDtcclxuICBbU3ltYm9sLml0ZXJhdG9yXSgpOiBJdGVyYXRvcjxHcmFwaE5vZGU+O1xyXG59XHJcblxyXG5pbnRlcmZhY2UgR3JhcGhWaWV3IHtcclxuICByZW5kZXJlcjoge1xyXG4gICAgbm9kZXM6IEdyYXBoTm9kZUNvbGxlY3Rpb247XHJcbiAgICBjaGFuZ2VkKCk6IHZvaWQ7XHJcbiAgfTtcclxufVxyXG5cclxuaW50ZXJmYWNlIExvY2FsR3JhcGhWaWV3IHtcclxuICByZW5kZXJlcjoge1xyXG4gICAgbm9kZXM6IEdyYXBoTm9kZUNvbGxlY3Rpb247XHJcbiAgICBjaGFuZ2VkKCk6IHZvaWQ7XHJcbiAgfTtcclxufVxyXG5cclxuaW50ZXJmYWNlIEdyYXBoTm9kZSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICB0ZXh0Pzoge1xyXG4gICAgdGV4dDogc3RyaW5nO1xyXG4gIH07XHJcbiAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nO1xyXG4gIHBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0PzogKCkgPT4gc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgR3JhcGhOb2RlUHJvdG90eXBlIHtcclxuICBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmc7XHJcbiAgcG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQ/OiAoKSA9PiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBHcmFwaE5vZGVDb2xsZWN0aW9uV2l0aEZpcnN0IGV4dGVuZHMgR3JhcGhOb2RlQ29sbGVjdGlvbiB7XHJcbiAgZmlyc3QoKTogR3JhcGhOb2RlIHwgdW5kZWZpbmVkO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgR3JhcGhWaWV3U2VydmljZSB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG4gIHByaXZhdGUgbW9kaWZpZWRQcm90b3R5cGVzOiBHcmFwaE5vZGVQcm90b3R5cGVbXSA9IFtdO1xyXG4gIHByaXZhdGUgb2JzZXJ2ZXI6IE11dGF0aW9uT2JzZXJ2ZXIgfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIHRpbWVyOiBudW1iZXIgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICAvLyBTZXQgc3RhdGljIGRpc3BsYXkgc2V0dGluZ3MgLSBleGFjdGx5IGxpa2UgTm9kZSBNYXNxdWVyYWRlXHJcbiAgICBncmFwaERpc3BsYXlTZXR0aW5ncyA9IHtcclxuICAgICAgZW5hYmxlRm9yR3JhcGhWaWV3OiBwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3LFxyXG4gICAgICBwcm9wZXJ0eUtleTogcGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5LFxyXG4gICAgICBlbmFibGVNZHhTdXBwb3J0OiBwbHVnaW4uc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCxcclxuICAgICAgYXBwOiBwbHVnaW4uYXBwXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcblxyXG4gIHByaXZhdGUgZ2V0R3JhcGhMZWF2ZXMoKTogV29ya3NwYWNlTGVhZltdIHtcclxuICAgIGNvbnN0IGxlYXZlczogV29ya3NwYWNlTGVhZltdID0gW107XHJcbiAgICBsZWF2ZXMucHVzaCguLi50aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZ3JhcGgnKSk7XHJcbiAgICBsZWF2ZXMucHVzaCguLi50aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbG9jYWxncmFwaCcpKTtcclxuICAgIHJldHVybiBbLi4ubmV3IFNldChsZWF2ZXMpXTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgb3ZlcnJpZGVQcm90b3R5cGVzKCkge1xyXG4gICAgY29uc3QgbGVhdmVzID0gdGhpcy5nZXRHcmFwaExlYXZlcygpO1xyXG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xyXG4gICAgICBpZiAoIShsZWFmLnZpZXcgaW5zdGFuY2VvZiBWaWV3KSB8fCBsZWFmLmlzRGVmZXJyZWQpIGNvbnRpbnVlO1xyXG4gICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3IGFzIHVua25vd24gYXMgR3JhcGhWaWV3IHwgTG9jYWxHcmFwaFZpZXc7XHJcbiAgICAgIGF3YWl0IHRoaXMub3ZlcnJpZGVQcm90b3R5cGUodmlldyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIG92ZXJyaWRlUHJvdG90eXBlKHZpZXc6IEdyYXBoVmlldyB8IExvY2FsR3JhcGhWaWV3KSB7XHJcbiAgICAvLyBDaGVjayBpZiBncmFwaCB2aWV3IGhhcyBub2RlcyBsb2FkZWQgeWV0XHJcbiAgICBsZXQgbm9kZUNvdW50ID0gMDtcclxuICAgIGZvciAoY29uc3QgZ3JhcGhOb2RlIG9mIHZpZXcucmVuZGVyZXIubm9kZXMpIHtcclxuICAgICAgbm9kZUNvdW50Kys7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG5vZGVDb3VudCA9PT0gMCkge1xyXG4gICAgICAvLyBHcmFwaCB2aWV3IGlzIGVtcHR5LCB0cnkgYWdhaW4gaW4gMSBzZWNvbmRcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgdm9pZCB0aGlzLm92ZXJyaWRlUHJvdG90eXBlKHZpZXcpO1xyXG4gICAgICB9LCAxMDAwKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFByZS1wb3B1bGF0ZSBjYWNoZSBmb3IgTURYIGZpbGVzIGluIHRoZSBncmFwaFxyXG4gICAgaWYgKGdyYXBoRGlzcGxheVNldHRpbmdzPy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgIGNvbnN0IG1keFByb21pc2VzOiBQcm9taXNlPHZvaWQ+W10gPSBbXTtcclxuXHJcbiAgICAgIGZvciAoY29uc3QgZ3JhcGhOb2RlIG9mIHZpZXcucmVuZGVyZXIubm9kZXMpIHtcclxuICAgICAgICBjb25zdCBmaWxlID0gZ3JhcGhEaXNwbGF5U2V0dGluZ3MuYXBwLnZhdWx0LmdldEZpbGVCeVBhdGgoZ3JhcGhOb2RlLmlkKTtcclxuICAgICAgICBpZiAoZmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21keCcpIHtcclxuICAgICAgICAgIGNvbnN0IHByb21pc2UgPSBmcm9udG1hdHRlckNhY2hlLmdldChncmFwaERpc3BsYXlTZXR0aW5ncy5hcHAsIGZpbGUsIHsgZW5hYmxlTWR4U3VwcG9ydDogZ3JhcGhEaXNwbGF5U2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydCwgcHJvcGVydHlLZXk6IGdyYXBoRGlzcGxheVNldHRpbmdzLnByb3BlcnR5S2V5IH0gYXMgYW55KTtcclxuICAgICAgICAgIG1keFByb21pc2VzLnB1c2gocHJvbWlzZS50aGVuKCgpID0+IHt9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBXYWl0IGZvciBhbGwgTURYIGNhY2hlIHBvcHVsYXRpb24gdG8gY29tcGxldGVcclxuICAgICAgaWYgKG1keFByb21pc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChtZHhQcm9taXNlcyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBub2RlID0gdmlldy5yZW5kZXJlci5ub2Rlcy5maXJzdCgpO1xyXG5cclxuICAgIGlmIChub2RlKSB7XHJcbiAgICAgIGNvbnN0IHByb3RvID0gbm9kZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XHJcbiAgICAgIGlmICghcHJvdG8uaGFzT3duUHJvcGVydHkoJ3Bvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0JykgJiYgIXRoaXMubW9kaWZpZWRQcm90b3R5cGVzLmNvbnRhaW5zKHByb3RvKSkge1xyXG4gICAgICAgIHByb3RvLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0ID0gcHJvdG8uZ2V0RGlzcGxheVRleHQ7XHJcbiAgICAgICAgcHJvdG8uZ2V0RGlzcGxheVRleHQgPSBjcmVhdGVHZXREaXNwbGF5VGV4dCh0aGlzLnBsdWdpbi5hcHApO1xyXG4gICAgICAgIGxldCB1cGRhdGVkQ291bnQgPSAwO1xyXG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB2aWV3LnJlbmRlcmVyLm5vZGVzKSB7XHJcbiAgICAgICAgICBpZiAobm9kZS50ZXh0KSB7XHJcbiAgICAgICAgICAgIG5vZGUudGV4dC50ZXh0ID0gbm9kZS5nZXREaXNwbGF5VGV4dCgpO1xyXG4gICAgICAgICAgICB1cGRhdGVkQ291bnQrKztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmlldy5yZW5kZXJlci5jaGFuZ2VkKCk7XHJcbiAgICAgICAgdGhpcy5tb2RpZmllZFByb3RvdHlwZXMucHVzaChwcm90byk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVzdG9yZVByb3RvdHlwZXMoKSB7XHJcbiAgICBmb3IgKGNvbnN0IHByb3RvIG9mIHRoaXMubW9kaWZpZWRQcm90b3R5cGVzKSB7XHJcbiAgICAgIGlmICh0eXBlb2YgcHJvdG8ucG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBwcm90by5nZXREaXNwbGF5VGV4dCA9IHByb3RvLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0O1xyXG4gICAgICAgIGRlbGV0ZSBwcm90by5wb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5tb2RpZmllZFByb3RvdHlwZXMgPSBbXTtcclxuICAgIHRoaXMucmV3cml0ZU5hbWVzKCk7XHJcbiAgfVxyXG5cclxuICByZXdyaXRlTmFtZXMoKSB7XHJcbiAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmdldEdyYXBoTGVhdmVzKCk7XHJcbiAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XHJcbiAgICAgIGlmICghKGxlYWYudmlldyBpbnN0YW5jZW9mIFZpZXcpIHx8IGxlYWYuaXNEZWZlcnJlZCkgY29udGludWU7XHJcbiAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgdW5rbm93biBhcyBHcmFwaFZpZXcgfCBMb2NhbEdyYXBoVmlldztcclxuICAgICAgZm9yIChjb25zdCBub2RlIG9mIHZpZXcucmVuZGVyZXIubm9kZXMpIHtcclxuICAgICAgICBpZiAobm9kZS50ZXh0KSBub2RlLnRleHQudGV4dCA9IG5vZGUuZ2V0RGlzcGxheVRleHQoKTtcclxuICAgICAgfVxyXG4gICAgICB2aWV3LnJlbmRlcmVyLmNoYW5nZWQoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uTGF5b3V0Q2hhbmdlKCkge1xyXG4gICAgdGhpcy5jbGVhbnVwT2JzZXJ2ZXIoKTtcclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldykge1xyXG4gICAgICB0aGlzLnJlc3RvcmVQcm90b3R5cGVzKCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBpZiBncmFwaCBwbHVnaW4gaXMgbG9hZGVkIC0gZXhhY3RseSBsaWtlIE5vZGUgTWFzcXVlcmFkZVxyXG4gICAgY29uc3QgYXBwSW50ZXJuYWwgPSB0aGlzLnBsdWdpbi5hcHAgYXMgYW55O1xyXG4gICAgY29uc3QgaXNHcmFwaExvYWRlZCA9IGFwcEludGVybmFsLmludGVybmFsUGx1Z2lucy5nZXRQbHVnaW5CeUlkKFwiZ3JhcGhcIik/Ll9sb2FkZWQ7XHJcbiAgICBpZiAoIWlzR3JhcGhMb2FkZWQpIHJldHVybjtcclxuXHJcbiAgICAvLyBVc2UgTXV0YXRpb25PYnNlcnZlciBmb3IgYSBtb3JlIGVmZmljaWVudCB3YXkgdG8gZGV0ZWN0IHdoZW4gbm9kZXMgYXJlIGFkZGVkXHJcbiAgICB0aGlzLnNldHVwT2JzZXJ2ZXIoKTtcclxuICAgIFxyXG4gICAgLy8gQWxzbyB0cmlnZ2VyIGluaXRpYWwgb3ZlcnJpZGVcclxuICAgIHZvaWQgdGhpcy5vdmVycmlkZVByb3RvdHlwZXMoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0dXBPYnNlcnZlcigpIHtcclxuICAgIC8vIExvb2sgZm9yIGdyYXBoIGNvbnRhaW5lcnMgaW4gYWxsIGxlYXZlc1xyXG4gICAgY29uc3QgbGVhdmVzID0gdGhpcy5nZXRHcmFwaExlYXZlcygpO1xyXG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xyXG4gICAgICBjb25zdCBjb250YWluZXIgPSBsZWFmLnZpZXcuY29udGFpbmVyRWw7XHJcbiAgICAgIGlmICghY29udGFpbmVyKSBjb250aW51ZTtcclxuXHJcbiAgICAgIGlmICghdGhpcy5vYnNlcnZlcikge1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XHJcbiAgICAgICAgICAvLyBEZWJvdW5jZSB1cGRhdGVzIHRvIGF2b2lkIGV4Y2Vzc2l2ZSBwcm9jZXNzaW5nXHJcbiAgICAgICAgICBpZiAodGhpcy50aW1lcikgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcclxuICAgICAgICAgIHRoaXMudGltZXIgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHZvaWQgdGhpcy5vdmVycmlkZVByb3RvdHlwZXMoKTtcclxuICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIE9ic2VydmUgdGhlIGNvbnRhaW5lciBmb3IgYWRkaXRpb25zIG9mIGdyYXBoLXJlbGF0ZWQgZWxlbWVudHNcclxuICAgICAgdGhpcy5vYnNlcnZlci5vYnNlcnZlKGNvbnRhaW5lciwge1xyXG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcclxuICAgICAgICBzdWJ0cmVlOiB0cnVlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEZhbGxiYWNrOiBpZiBubyBvYnNlcnZlciBjb3VsZCBiZSBzZXQgdXAsIG9yIGFzIGFuIGV4dHJhIHNhZmV0eSBtZWFzdXJlLFxyXG4gICAgLy8gd2UgY291bGQga2VlcCBhIHZlcnkgaW5mcmVxdWVudCBpbnRlcnZhbCwgYnV0IHRoZSByZXF1aXJlbWVudCBpcyB0byByZXBsYWNlIGl0LlxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjbGVhbnVwT2JzZXJ2ZXIoKSB7XHJcbiAgICBpZiAodGhpcy5vYnNlcnZlcikge1xyXG4gICAgICB0aGlzLm9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgdGhpcy5vYnNlcnZlciA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy50aW1lcikge1xyXG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xyXG4gICAgICB0aGlzLnRpbWVyID0gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICB1cGRhdGVHcmFwaFZpZXcoKSB7XHJcbiAgICAvLyBVcGRhdGUgc3RhdGljIGRpc3BsYXkgc2V0dGluZ3Mgd2hlbiBwbHVnaW4gc2V0dGluZ3MgY2hhbmdlXHJcbiAgICBpZiAoZ3JhcGhEaXNwbGF5U2V0dGluZ3MpIHtcclxuICAgICAgZ3JhcGhEaXNwbGF5U2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3O1xyXG4gICAgICBncmFwaERpc3BsYXlTZXR0aW5ncy5wcm9wZXJ0eUtleSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5O1xyXG4gICAgICBncmFwaERpc3BsYXlTZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTWR4U3VwcG9ydDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3KSB7XHJcbiAgICAgIHZvaWQgdGhpcy5vdmVycmlkZVByb3RvdHlwZXMoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMucmVzdG9yZVByb3RvdHlwZXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlZnJlc2hHcmFwaFZpZXcoKSB7XHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yR3JhcGhWaWV3KSB7XHJcbiAgICAgIHRoaXMucmV3cml0ZU5hbWVzKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbnVubG9hZCgpIHtcclxuICAgIHRoaXMuY2xlYW51cE9ic2VydmVyKCk7XHJcbiAgICB0aGlzLnJlc3RvcmVQcm90b3R5cGVzKCk7XHJcbiAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgVEZpbGUsIEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFBsdWdpblNldHRpbmdzIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgZ2V0RnJvbnRtYXR0ZXIgfSBmcm9tICcuL2Zyb250bWF0dGVyJztcblxuLyoqXG4gKiBTaW1wbGUgY2FjaGUgZm9yIGZyb250bWF0dGVyIGRhdGEgdG8gc3VwcG9ydCBzeW5jIGNvbnRleHRzIGxpa2UgZ3JhcGggdmlldy5cbiAqIFxuICogKipXaGF0IGZvcm1hdCBpcyBleHBlY3RlZDoqKlxuICogSXQgc3RvcmVzIGEgTWFwIHdoZXJlIGtleXMgYXJlIGZpbGUgcGF0aHMgYW5kIHZhbHVlcyBhcmUgZWl0aGVyIGEgYFJlY29yZDxzdHJpbmcsIHVua25vd24+YCBcbiAqIGNvbnRhaW5pbmcgdGhlIHBhcnNlZCBZQU1MIGZyb250bWF0dGVyLCBvciBgbnVsbGAgaWYgbm8gZnJvbnRtYXR0ZXIgZXhpc3RzIG9yIHBhcnNpbmcgZmFpbGVkLlxuICogXG4gKiAqKldoeSBpdCdzIHNlcGFyYXRlIGZyb20gT2JzaWRpYW4ncyBtZXRhZGF0YSBjYWNoZToqKlxuICogT2JzaWRpYW4ncyBgbWV0YWRhdGFDYWNoZWAgc3BlY2lmaWNhbGx5IHRhcmdldHMgYC5tZGAgZmlsZXMuIFRoaXMgcGx1Z2luIGFkZHMgc3VwcG9ydCBmb3IgYC5tZHhgIGZpbGVzLFxuICogd2hpY2ggT2JzaWRpYW4gdHJlYXRzIGFzIHBsYWluIHRleHQuIFRoaXMgc2VwYXJhdGUgY2FjaGUgYWxsb3dzIHVzIHRvIHN0b3JlIG1hbnVhbGx5IHBhcnNlZFxuICogZnJvbnRtYXR0ZXIgZm9yIE1EWCBmaWxlcyBzbyBpdCBjYW4gYmUgYWNjZXNzZWQgc3luY2hyb25vdXNseSBpbiBwZXJmb3JtYW5jZS1jcml0aWNhbCBjb250ZXh0cyBcbiAqIGxpa2UgdGhlIGdyYXBoIHZpZXcncyBub2RlIHJlbmRlcmluZy5cbiAqIFxuICogKipLbm93biBsaW1pdGF0aW9uczoqKlxuICogLSAqKk1hbnVhbCBQYXJzaW5nOioqIFVzZXMgYSBiYXNpYyByZWdleCB0byBleHRyYWN0IGZyb250bWF0dGVyIGZyb20gTURYIGZpbGVzLCB3aGljaCBtaWdodCBub3QgXG4gKiAgIHN1cHBvcnQgYWxsIGVkZ2UgY2FzZXMgb2YgWUFNTCBibG9jayBkZXRlY3Rpb24gdGhhdCBPYnNpZGlhbidzIG5hdGl2ZSBwYXJzZXIgaGFuZGxlcy5cbiAqIC0gKipBc3luYyBOYXR1cmU6KiogUG9wdWxhdGlvbiBpcyBhc3luY2hyb25vdXMuIENvbnRleHRzIHJlcXVpcmluZyBzeW5jaHJvbm91cyBhY2Nlc3MgKGxpa2UgZ3JhcGggbm9kZXMpIFxuICogICBtdXN0IGhhbmRsZSBgdW5kZWZpbmVkYCByZXN1bHRzIGJ5IHRyaWdnZXJpbmcgYW4gYXN5bmMgbG9hZCBhbmQgcmVseWluZyBvbiBhIGZ1dHVyZSByZWZyZXNoLlxuICogLSAqKk1lbW9yeToqKiBJdCByZXNpZGVzIGVudGlyZWx5IGluIG1lbW9yeSBhbmQgaXMgaW52YWxpZGF0ZWQgb24gZmlsZSBtb2RpZmljYXRpb24gb3IgcmVuYW1lLlxuICovXG5jbGFzcyBGcm9udG1hdHRlckNhY2hlIHtcbiAgcHJpdmF0ZSBjYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGw+KCk7XG4gIHByaXZhdGUgcGVuZGluZyA9IG5ldyBNYXA8c3RyaW5nLCBQcm9taXNlPFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgbnVsbD4+KCk7XG5cbiAgYXN5bmMgZ2V0KGFwcDogQXBwLCBmaWxlOiBURmlsZSwgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGw+IHtcbiAgICBjb25zdCBrZXkgPSBmaWxlLnBhdGg7XG5cbiAgICAvLyBSZXR1cm4gY2FjaGVkIHZhbHVlIGlmIGF2YWlsYWJsZVxuICAgIGlmICh0aGlzLmNhY2hlLmhhcyhrZXkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5jYWNoZS5nZXQoa2V5KSA/PyBudWxsO1xuICAgIH1cblxuICAgIC8vIElmIGFscmVhZHkgcGVuZGluZywgd2FpdCBmb3IgaXRcbiAgICBpZiAodGhpcy5wZW5kaW5nLmhhcyhrZXkpKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5wZW5kaW5nLmdldChrZXkpITtcbiAgICB9XG5cbiAgICAvLyBTdGFydCByZWFkaW5nXG4gICAgY29uc3QgcHJvbWlzZSA9IGdldEZyb250bWF0dGVyKGFwcCwgZmlsZSwgc2V0dGluZ3MpO1xuICAgIHRoaXMucGVuZGluZy5zZXQoa2V5LCBwcm9taXNlKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9taXNlO1xuICAgICAgdGhpcy5jYWNoZS5zZXQoa2V5LCByZXN1bHQpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5wZW5kaW5nLmRlbGV0ZShrZXkpO1xuICAgIH1cbiAgfVxuXG4gIGdldFN5bmMoa2V5OiBzdHJpbmcpOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGwgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmNhY2hlLmdldChrZXkpO1xuICB9XG5cbiAgaW52YWxpZGF0ZShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XG4gICAgdGhpcy5wZW5kaW5nLmRlbGV0ZShrZXkpO1xuICB9XG5cbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5jYWNoZS5jbGVhcigpO1xuICAgIHRoaXMucGVuZGluZy5jbGVhcigpO1xuICB9XG59XG5cbi8vIEdsb2JhbCBjYWNoZSBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGZyb250bWF0dGVyQ2FjaGUgPSBuZXcgRnJvbnRtYXR0ZXJDYWNoZSgpO1xuIiwgImltcG9ydCB7IE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIEJhY2tsaW5rIFNlcnZpY2VcclxuICogXHJcbiAqIEhhbmRsZXMgZGlzcGxheWluZyBwcm9wZXJ0eSB0aXRsZXMgaW5zdGVhZCBvZiBmaWxlIG5hbWVzIGluOlxyXG4gKiAtIEVtYmVkZGVkIGJhY2tsaW5rcyAoTGlua2VkIG1lbnRpb25zIGZvb3RlciBpbiBlYWNoIG5vdGUpXHJcbiAqIC0gRGVkaWNhdGVkIGJhY2tsaW5rcyBwYW5lbFxyXG4gKiAtIE91dGdvaW5nIGxpbmtzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQmFja2xpbmtTZXJ2aWNlIHtcclxuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcbiAgcHJpdmF0ZSBvYnNlcnZlcj86IE11dGF0aW9uT2JzZXJ2ZXI7XHJcbiAgcHJpdmF0ZSBwcm9jZXNzZWRFbGVtZW50czogV2Vha1NldDxIVE1MRWxlbWVudD4gPSBuZXcgV2Vha1NldCgpO1xyXG4gIHByaXZhdGUgbW9kaWZpZWRFbGVtZW50czogV2Vha1NldDxIVE1MRWxlbWVudD4gPSBuZXcgV2Vha1NldCgpO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxUZXh0Q29udGVudERlc2NyaXB0b3JzOiBNYXA8SFRNTEVsZW1lbnQsIFByb3BlcnR5RGVzY3JpcHRvcj4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGRpc3BsYXkgbmFtZSBmcm9tIGZpbGUncyBmcm9udG1hdHRlciBwcm9wZXJ0eVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZ2V0RGlzcGxheU5hbWUoZmlsZTogVEZpbGUpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZ2V0RnJvbnRtYXR0ZXIsIGlzRmlsZVR5cGVTdXBwb3J0ZWQgfSA9IGF3YWl0IGltcG9ydCgnLi4vdXRpbHMvZnJvbnRtYXR0ZXInKTtcclxuXHJcbiAgICAvLyBTa2lwIHVuc3VwcG9ydGVkIGZpbGUgdHlwZXNcclxuICAgIGlmICghaXNGaWxlVHlwZVN1cHBvcnRlZChmaWxlLmV4dGVuc2lvbiwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gYXdhaXQgZ2V0RnJvbnRtYXR0ZXIodGhpcy5wbHVnaW4uYXBwLCBmaWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcblxyXG4gICAgaWYgKGZyb250bWF0dGVyICYmIGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gdW5kZWZpbmVkICYmIGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gbnVsbCkge1xyXG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gU3RyaW5nKGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSkudHJpbSgpO1xyXG4gICAgICBpZiAocHJvcGVydHlWYWx1ZSAhPT0gJycpIHtcclxuICAgICAgICByZXR1cm4gcHJvcGVydHlWYWx1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGFsbCBiYWNrbGluayBkaXNwbGF5c1xyXG4gICAqL1xyXG4gIHVwZGF0ZUJhY2tsaW5rcygpOiB2b2lkIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgIHRoaXMuc3RvcE9ic2VydmluZygpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIGVtYmVkZGVkIGJhY2tsaW5rcyBpbiBhbGwgbWFya2Rvd24gdmlld3NcclxuICAgIHRoaXMudXBkYXRlRW1iZWRkZWRCYWNrbGlua3MoKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgZGVkaWNhdGVkIGJhY2tsaW5rcyBwYW5lbFxyXG4gICAgdm9pZCB0aGlzLnVwZGF0ZURlZGljYXRlZEJhY2tsaW5rc1BhbmVsKCk7XHJcblxyXG4gICAgLy8gU3RhcnQgb2JzZXJ2aW5nIGZvciBmdXR1cmUgY2hhbmdlc1xyXG4gICAgdGhpcy5zdGFydE9ic2VydmluZygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGVtYmVkZGVkIGJhY2tsaW5rcyBpbiBtYXJrZG93biB2aWV3c1xyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlRW1iZWRkZWRCYWNrbGlua3MoKTogdm9pZCB7XHJcbiAgICBmb3IgKGNvbnN0IGxlYWYgb2YgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJykpIHtcclxuICAgICAgaWYgKCEobGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSkge1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBlbWJlZGRlZEJhY2tsaW5rcyA9IGxlYWYudmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcuZW1iZWRkZWQtYmFja2xpbmtzJyk7XHJcbiAgICAgIGlmIChlbWJlZGRlZEJhY2tsaW5rcykge1xyXG4gICAgICAgIHRoaXMudXBkYXRlQmFja2xpbmtDb250YWluZXIoZW1iZWRkZWRCYWNrbGlua3MgYXMgSFRNTEVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgZGVkaWNhdGVkIGJhY2tsaW5rcyBwYW5lbFxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlRGVkaWNhdGVkQmFja2xpbmtzUGFuZWwoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCBiYWNrbGlua3NMZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnYmFja2xpbmsnKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGxlYWYgb2YgYmFja2xpbmtzTGVhdmVzKSB7XHJcbiAgICAgIGF3YWl0IGxlYWYubG9hZElmRGVmZXJyZWQoKTtcclxuXHJcbiAgICAgIGlmIChsZWFmLnZpZXcpIHtcclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSAobGVhZi52aWV3IGFzIHsgY29udGFpbmVyRWw/OiBIVE1MRWxlbWVudCB9KS5jb250YWluZXJFbDtcclxuICAgICAgICBpZiAoY29udGFpbmVyKSB7XHJcbiAgICAgICAgICAvLyBGaW5kIGJhY2tsaW5rcyBhbmQgb3V0Z29pbmcgbGlua3Mgc2VjdGlvbnNcclxuICAgICAgICAgIGNvbnN0IGJhY2tsaW5rc0NvbnRhaW5lciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYmFja2xpbmtzLXBhbmUnKSB8fCBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJhY2tsaW5rLXBhbmUnKTtcclxuICAgICAgICAgIGlmIChiYWNrbGlua3NDb250YWluZXIpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVCYWNrbGlua0NvbnRhaW5lcihiYWNrbGlua3NDb250YWluZXIgYXMgSFRNTEVsZW1lbnQpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIEFsc28gY2hlY2sgZm9yIG91dGdvaW5nIGxpbmtzXHJcbiAgICAgICAgICBjb25zdCBvdXRnb2luZ0xpbmtzQ29udGFpbmVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5vdXRnb2luZy1saW5rLXBhbmUnKSB8fCBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm91dGdvaW5nLWxpbmtzJyk7XHJcbiAgICAgICAgICBpZiAob3V0Z29pbmdMaW5rc0NvbnRhaW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rQ29udGFpbmVyKG91dGdvaW5nTGlua3NDb250YWluZXIgYXMgSFRNTEVsZW1lbnQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXh0cmFjdCBmaWxlIHBhdGggZnJvbSBhbiBlbGVtZW50IG9yIGl0cyBwYXJlbnQgbGlua1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZXh0cmFjdEZpbGVQYXRoRnJvbUVsZW1lbnQoZWxlbWVudDogSFRNTEVsZW1lbnQpOiBURmlsZSB8IG51bGwge1xyXG4gICAgLy8gVHJ5IGRhdGEtcGF0aCBhdHRyaWJ1dGUgZmlyc3RcclxuICAgIGNvbnN0IGRhdGFQYXRoID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcpO1xyXG4gICAgaWYgKGRhdGFQYXRoKSB7XHJcbiAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRhdGFQYXRoKTtcclxuICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgIHJldHVybiBmaWxlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVHJ5IHRvIGZpbmQgYSBsaW5rIGVsZW1lbnQgKHBhcmVudCBvciBjaGlsZClcclxuICAgIGNvbnN0IGxpbmsgPSBlbGVtZW50LmNsb3Nlc3QoJ2EnKSB8fCBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2EnKTtcclxuICAgIGlmIChsaW5rKSB7XHJcbiAgICAgIGNvbnN0IGhyZWYgPSBsaW5rIGluc3RhbmNlb2YgSFRNTEFuY2hvckVsZW1lbnQgPyBsaW5rLmhyZWYgOiAobGluayBhcyBFbGVtZW50KS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTtcclxuICAgICAgaWYgKGhyZWYpIHtcclxuICAgICAgICAvLyBUcnkgb2JzaWRpYW46Ly8gVVJMIGZvcm1hdFxyXG4gICAgICAgIGlmIChocmVmLnN0YXJ0c1dpdGgoJ29ic2lkaWFuOi8vJykpIHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoaHJlZik7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXJhbSA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdmaWxlJyk7XHJcbiAgICAgICAgICAgIGlmIChmaWxlUGFyYW0pIHtcclxuICAgICAgICAgICAgICBjb25zdCBkZWNvZGVkUGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChmaWxlUGFyYW0pO1xyXG4gICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRlY29kZWRQYXRoICsgJy5tZCcpO1xyXG4gICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgIC8vIElnbm9yZSBVUkwgcGFyc2luZyBlcnJvcnNcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyeSBpbnRlcm5hbCBsaW5rIGZvcm1hdCAoZS5nLiwgI2ZpbGUvcGF0aC90by9maWxlKVxyXG4gICAgICAgIGNvbnN0IGludGVybmFsTGlua01hdGNoID0gaHJlZi5tYXRjaCgvI2ZpbGVcXC8oLispLyk7XHJcbiAgICAgICAgaWYgKGludGVybmFsTGlua01hdGNoKSB7XHJcbiAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChpbnRlcm5hbExpbmtNYXRjaFsxXSk7XHJcbiAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XHJcbiAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaWxlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVHJ5IGRhdGEtaHJlZiBhdHRyaWJ1dGUgKE9ic2lkaWFuIHNvbWV0aW1lcyB1c2VzIHRoaXMpXHJcbiAgICAgICAgY29uc3QgZGF0YUhyZWYgPSBsaW5rLmdldEF0dHJpYnV0ZSgnZGF0YS1ocmVmJyk7XHJcbiAgICAgICAgaWYgKGRhdGFIcmVmKSB7XHJcbiAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkYXRhSHJlZik7XHJcbiAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaWxlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFRyeSB0byBtYXRjaCB0ZXh0IGNvbnRlbnQgdG8gYSBmaWxlIGJhc2VuYW1lXHJcbiAgICBjb25zdCB0ZXh0Q29udGVudCA9IGVsZW1lbnQudGV4dENvbnRlbnQ/LnRyaW0oKTtcclxuICAgIGlmICh0ZXh0Q29udGVudCkge1xyXG4gICAgICAvLyBUcnkgdG8gZmluZCBmaWxlIGJ5IGJhc2VuYW1lICh3aXRob3V0IGV4dGVuc2lvbilcclxuICAgICAgY29uc3QgYWxsRmlsZXMgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgICBjb25zdCBtYXRjaGluZ0ZpbGUgPSBhbGxGaWxlcy5maW5kKGYgPT4gZi5iYXNlbmFtZSA9PT0gdGV4dENvbnRlbnQpO1xyXG4gICAgICBpZiAobWF0Y2hpbmdGaWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIG1hdGNoaW5nRmlsZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGEgYmFja2xpbmsgY29udGFpbmVyIGJ5IHJlcGxhY2luZyBmaWxlIG5hbWVzIHdpdGggcHJvcGVydHkgdGl0bGVzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB1cGRhdGVCYWNrbGlua0NvbnRhaW5lcihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICAvLyBGaW5kIGFsbCBwb3RlbnRpYWwgZmlsZSBuYW1lIGVsZW1lbnRzIGluIHRoZSBjb250YWluZXJcclxuICAgIC8vIE9ic2lkaWFuIHVzZXMgdmFyaW91cyBzZWxlY3RvcnMgZm9yIGJhY2tsaW5rIGl0ZW1zXHJcbiAgICBjb25zdCBzZWxlY3RvcnMgPSBbXHJcbiAgICAgICcudHJlZS1pdGVtLWlubmVyJyxcclxuICAgICAgJy5iYWNrbGluay10aXRsZScsXHJcbiAgICAgICcuYmFja2xpbmstZmlsZS1saW5rJyxcclxuICAgICAgJy5vdXRnb2luZy1saW5rLWZpbGUtbGluaycsXHJcbiAgICAgICcudHJlZS1pdGVtLXNlbGYnLFxyXG4gICAgICAnLm5hdi1maWxlLXRpdGxlJyxcclxuICAgICAgJ1tkYXRhLXBhdGhdJyxcclxuICAgICAgJ2EuaW50ZXJuYWwtbGluaydcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgZmlsZUVsZW1lbnRzID0gbmV3IFNldDxIVE1MRWxlbWVudD4oKTtcclxuXHJcbiAgICAvLyBDb2xsZWN0IGFsbCBwb3RlbnRpYWwgZWxlbWVudHNcclxuICAgIHNlbGVjdG9ycy5mb3JFYWNoKHNlbGVjdG9yID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgICBmaWxlRWxlbWVudHMuYWRkKGVsIGFzIEhUTUxFbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgLy8gSWdub3JlIGludmFsaWQgc2VsZWN0b3IgZXJyb3JzXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGZpbGVFbGVtZW50cy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgIC8vIFNraXAgaWYgYWxyZWFkeSBwcm9jZXNzZWQgaW4gdGhpcyB1cGRhdGUgY3ljbGVcclxuICAgICAgaWYgKHRoaXMucHJvY2Vzc2VkRWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBFeHRyYWN0IGZpbGUgZnJvbSBlbGVtZW50XHJcbiAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmV4dHJhY3RGaWxlUGF0aEZyb21FbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgICBpZiAoZmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUVsZW1lbnRXaXRoRmlsZShlbGVtZW50LCBmaWxlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYW4gZWxlbWVudCB3aXRoIGZpbGUncyBkaXNwbGF5IG5hbWVcclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZUVsZW1lbnRXaXRoRmlsZShlbGVtZW50OiBIVE1MRWxlbWVudCwgZmlsZTogVEZpbGUpOiB2b2lkIHtcclxuICAgIHZvaWQgKGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZGlzcGxheU5hbWUgPSBhd2FpdCB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGUpO1xyXG5cclxuICAgICAgaWYgKGRpc3BsYXlOYW1lID09PSBudWxsKSB7XHJcbiAgICAgICAgLy8gTm8gcHJvcGVydHksIHVzZSBkZWZhdWx0IGJlaGF2aW9yIChmaWxlIG5hbWUpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBNYXJrIGFzIHByb2Nlc3NlZFxyXG4gICAgICB0aGlzLnByb2Nlc3NlZEVsZW1lbnRzLmFkZChlbGVtZW50KTtcclxuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG92LXByb2Nlc3NlZCcsICd0cnVlJyk7XHJcblxyXG4gICAgICAvLyBGaW5kIHRoZSB0ZXh0IG5vZGUgb3IgZWxlbWVudCB0aGF0IGNvbnRhaW5zIHRoZSBmaWxlIG5hbWVcclxuICAgICAgY29uc3QgY3VycmVudFRleHQgPSBlbGVtZW50LnRleHRDb250ZW50Py50cmltKCkgfHwgJyc7XHJcbiAgICAgIGNvbnN0IGJhc2VuYW1lID0gZmlsZS5iYXNlbmFtZTtcclxuXHJcbiAgICAgIC8vIE9ubHkgdXBkYXRlIGlmIHRoZSBjdXJyZW50IHRleHQgbWF0Y2hlcyB0aGUgYmFzZW5hbWUgb3IgZmlsZSBuYW1lXHJcbiAgICAgIC8vIFRoaXMgcHJldmVudHMgb3ZlcndyaXRpbmcgY3VzdG9tIHRleHQgdGhhdCBtaWdodCBhbHJlYWR5IGJlIHNldFxyXG4gICAgICBpZiAoY3VycmVudFRleHQgPT09IGJhc2VuYW1lIHx8IGN1cnJlbnRUZXh0ID09PSBmaWxlLm5hbWUgfHwgY3VycmVudFRleHQuZW5kc1dpdGgoYmFzZW5hbWUpKSB7XHJcbiAgICAgICAgLy8gRmluZCB0aGUgbGluayBlbGVtZW50IChpZiBhbnkpXHJcbiAgICAgICAgY29uc3QgbGluayA9IGVsZW1lbnQuY2xvc2VzdCgnYScpIHx8IGVsZW1lbnQucXVlcnlTZWxlY3RvcignYScpO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBsaW5rIHx8IGVsZW1lbnQ7XHJcblxyXG4gICAgICAgIC8vIFRyeSB0byBwcmVzZXJ2ZSB0aGUgc3RydWN0dXJlIHdoaWxlIHVwZGF0aW5nIHRleHRcclxuICAgICAgICAvLyBMb29rIGZvciB0ZXh0IG5vZGVzIG9yIGVsZW1lbnRzIHRoYXQgY29udGFpbiB0aGUgZmlsZSBuYW1lXHJcbiAgICAgICAgY29uc3QgdXBkYXRlVGV4dEluRWxlbWVudCA9IChlbDogSFRNTEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgIC8vIENoZWNrIGlmIGVsZW1lbnQgaGFzIGEgc2luZ2xlIHRleHQgbm9kZSBjaGlsZFxyXG4gICAgICAgICAgaWYgKGVsLmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICYmIGVsLmNoaWxkTm9kZXNbMF0ubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XHJcbiAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gZGlzcGxheU5hbWU7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIExvb2sgZm9yIHRleHQgbm9kZXNcclxuICAgICAgICAgIGNvbnN0IHRleHROb2RlcyA9IEFycmF5LmZyb20oZWwuY2hpbGROb2RlcykuZmlsdGVyKG5vZGUgPT4gbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpO1xyXG4gICAgICAgICAgaWYgKHRleHROb2Rlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgZmlyc3QgdGV4dCBub2RlXHJcbiAgICAgICAgICAgIHRleHROb2Rlc1swXS50ZXh0Q29udGVudCA9IGRpc3BsYXlOYW1lO1xyXG4gICAgICAgICAgICAvLyBSZW1vdmUgb3RoZXIgdGV4dCBub2RlcyB0byBhdm9pZCBkdXBsaWNhdGlvblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRleHROb2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgIHRleHROb2Rlc1tpXS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBJZiBubyB0ZXh0IG5vZGVzLCBjaGVjayBpZiB3ZSBzaG91bGQgcmVwbGFjZSBhbGwgY29udGVudFxyXG4gICAgICAgICAgLy8gT25seSBkbyB0aGlzIGlmIHRoZSBlbGVtZW50J3MgdGV4dCBtYXRjaGVzIHRoZSBmaWxlIG5hbWVcclxuICAgICAgICAgIGlmIChlbC50ZXh0Q29udGVudD8udHJpbSgpID09PSBiYXNlbmFtZSB8fCBlbC50ZXh0Q29udGVudD8udHJpbSgpID09PSBmaWxlLm5hbWUpIHtcclxuICAgICAgICAgICAgZWwudGV4dENvbnRlbnQgPSBkaXNwbGF5TmFtZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIFRyeSB0byB1cGRhdGUgdGhlIGxpbmsgZmlyc3QsIHRoZW4gZmFsbCBiYWNrIHRvIGVsZW1lbnRcclxuICAgICAgICBpZiAoIXVwZGF0ZVRleHRJbkVsZW1lbnQodGFyZ2V0RWxlbWVudCkpIHtcclxuICAgICAgICAgIC8vIElmIGxpbmsgdXBkYXRlIGZhaWxlZCwgdHJ5IHRoZSBlbGVtZW50IGl0c2VsZlxyXG4gICAgICAgICAgdXBkYXRlVGV4dEluRWxlbWVudChlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdGFydCBvYnNlcnZpbmcgRE9NIGNoYW5nZXMgZm9yIGJhY2tsaW5rc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhcnRPYnNlcnZpbmcoKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5vYnNlcnZlcikge1xyXG4gICAgICByZXR1cm47IC8vIEFscmVhZHkgb2JzZXJ2aW5nXHJcbiAgICB9XHJcblxyXG4gICAgLy8gT3ZlcnJpZGUgdGV4dENvbnRlbnQgb24gYmFja2xpbmsgZWxlbWVudHMgdG8gaW50ZXJjZXB0IGltbWVkaWF0ZWx5XHJcbiAgICB0aGlzLm92ZXJyaWRlQmFja2xpbmtFbGVtZW50cygpO1xyXG5cclxuICAgIGxldCB1cGRhdGVUaW1lb3V0OiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRUaW1lb3V0PiB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7XHJcbiAgICAgIC8vIENoZWNrIGlmIGFueSBtdXRhdGlvbnMgYWZmZWN0IGJhY2tsaW5rIGNvbnRhaW5lcnNcclxuICAgICAgbGV0IHNob3VsZFVwZGF0ZSA9IGZhbHNlO1xyXG4gICAgICBjb25zdCBuZXdFbGVtZW50czogSFRNTEVsZW1lbnRbXSA9IFtdO1xyXG5cclxuICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHtcclxuICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHtcclxuICAgICAgICAgIC8vIENoZWNrIGZvciBuZXcgZWxlbWVudHMgdGhhdCBtaWdodCBiZSBiYWNrbGlua3NcclxuICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBBcnJheS5mcm9tKG11dGF0aW9uLmFkZGVkTm9kZXMpKSB7XHJcbiAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICBjb25zdCBlbWJlZGRlZEJhY2tsaW5rcyA9IG5vZGUuY2xvc2VzdCgnLmVtYmVkZGVkLWJhY2tsaW5rcycpO1xyXG4gICAgICAgICAgICAgIGNvbnN0IGJhY2tsaW5rc1BhbmVsID0gbm9kZS5jbG9zZXN0KCcuYmFja2xpbmtzLXBhbmUsIC5iYWNrbGluay1wYW5lLCAub3V0Z29pbmctbGluay1wYW5lLCAub3V0Z29pbmctbGlua3MsIC5iYWNrbGluay1jb250YWluZXInKTtcclxuXHJcbiAgICAgICAgICAgICAgaWYgKGVtYmVkZGVkQmFja2xpbmtzIHx8IGJhY2tsaW5rc1BhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICBzaG91bGRVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gRmluZCBwb3RlbnRpYWwgYmFja2xpbmsgZWxlbWVudHMgaW4gdGhlIG5ldyBub2RlXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RvcnMgPSBbJy50cmVlLWl0ZW0taW5uZXInLCAnLmJhY2tsaW5rLXRpdGxlJywgJy5iYWNrbGluay1maWxlLWxpbmsnLCAnLm91dGdvaW5nLWxpbmstZmlsZS1saW5rJywgJy50cmVlLWl0ZW0tc2VsZicsICcubmF2LWZpbGUtdGl0bGUnLCAnW2RhdGEtcGF0aF0nLCAnYS5pbnRlcm5hbC1saW5rJ107XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGw/LihzZWxlY3Rvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM/LmZvckVhY2goKGVsOiBFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50cy5wdXNoKGVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoYXJhY3RlckRhdGEnKSB7XHJcbiAgICAgICAgICBjb25zdCB0YXJnZXQgPSBtdXRhdGlvbi50YXJnZXQ7XHJcblxyXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgbXV0YXRpb24gaXMgaW4gYSBiYWNrbGluayBjb250YWluZXJcclxuICAgICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICBjb25zdCBlbWJlZGRlZEJhY2tsaW5rcyA9IHRhcmdldC5jbG9zZXN0KCcuZW1iZWRkZWQtYmFja2xpbmtzJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJhY2tsaW5rc1BhbmVsID0gdGFyZ2V0LmNsb3Nlc3QoJy5iYWNrbGlua3MtcGFuZSwgLmJhY2tsaW5rLXBhbmUsIC5vdXRnb2luZy1saW5rLXBhbmUsIC5vdXRnb2luZy1saW5rcywgLmJhY2tsaW5rLWNvbnRhaW5lcicpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGVtYmVkZGVkQmFja2xpbmtzIHx8IGJhY2tsaW5rc1BhbmVsKSB7XHJcbiAgICAgICAgICAgICAgc2hvdWxkVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQucGFyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICAvLyBDaGVjayBwYXJlbnQgZWxlbWVudFxyXG4gICAgICAgICAgICBjb25zdCBlbWJlZGRlZEJhY2tsaW5rcyA9IHRhcmdldC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5lbWJlZGRlZC1iYWNrbGlua3MnKTtcclxuICAgICAgICAgICAgY29uc3QgYmFja2xpbmtzUGFuZWwgPSB0YXJnZXQucGFyZW50RWxlbWVudC5jbG9zZXN0KCcuYmFja2xpbmtzLXBhbmUsIC5iYWNrbGluay1wYW5lLCAub3V0Z29pbmctbGluay1wYW5lLCAub3V0Z29pbmctbGlua3MsIC5iYWNrbGluay1jb250YWluZXInKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChlbWJlZGRlZEJhY2tsaW5rcyB8fCBiYWNrbGlua3NQYW5lbCkge1xyXG4gICAgICAgICAgICAgIHNob3VsZFVwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIE92ZXJyaWRlIG5ldyBlbGVtZW50cyBpbW1lZGlhdGVseSBhbmQgdXBkYXRlIHRoZW1cclxuICAgICAgbmV3RWxlbWVudHMuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUVsZW1lbnRUZXh0Q29udGVudChlbCk7XHJcbiAgICAgICAgLy8gQWxzbyB0cnkgdG8gdXBkYXRlIGltbWVkaWF0ZWx5IGlmIHdlIGNhbiBleHRyYWN0IHRoZSBmaWxlXHJcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZXh0cmFjdEZpbGVQYXRoRnJvbUVsZW1lbnQoZWwpO1xyXG4gICAgICAgIGlmIChmaWxlICYmIGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IGF3YWl0IHRoaXMuZ2V0RGlzcGxheU5hbWUoZmlsZSk7XHJcbiAgICAgICAgICAgIGlmIChkaXNwbGF5TmFtZSkge1xyXG4gICAgICAgICAgICAgIC8vIENoZWNrIGN1cnJlbnQgdGV4dCBhbmQgcmVwbGFjZSBpZiBpdCdzIHRoZSBmaWxlbmFtZVxyXG4gICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRUZXh0ID0gZWwudGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnJztcclxuICAgICAgICAgICAgICBpZiAoY3VycmVudFRleHQgPT09IGZpbGUuYmFzZW5hbWUgfHwgY3VycmVudFRleHQgPT09IGZpbGUubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgZWwudGV4dENvbnRlbnQgPSBkaXNwbGF5TmFtZTtcclxuICAgICAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS1wb3YtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc2VkRWxlbWVudHMuYWRkKGVsKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChzaG91bGRVcGRhdGUpIHtcclxuICAgICAgICAvLyBDbGVhciBwcm9jZXNzZWQgZWxlbWVudHMgY2FjaGUgd2hlbiB1cGRhdGluZ1xyXG4gICAgICAgIHRoaXMucHJvY2Vzc2VkRWxlbWVudHMgPSBuZXcgV2Vha1NldCgpO1xyXG5cclxuICAgICAgICAvLyBEZWJvdW5jZSB1cGRhdGVzIHRvIGF2b2lkIGV4Y2Vzc2l2ZSBwcm9jZXNzaW5nXHJcbiAgICAgICAgaWYgKHVwZGF0ZVRpbWVvdXQpIHtcclxuICAgICAgICAgIGNsZWFyVGltZW91dCh1cGRhdGVUaW1lb3V0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdXBkYXRlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVCYWNrbGlua3MoKTtcclxuICAgICAgICAgIHRoaXMub3ZlcnJpZGVCYWNrbGlua0VsZW1lbnRzKCk7IC8vIFJlLW92ZXJyaWRlIGluIGNhc2UgbmV3IGVsZW1lbnRzIHdlcmUgYWRkZWRcclxuICAgICAgICAgIHVwZGF0ZVRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgIH0sIDEwKTsgLy8gVmVyeSBzaG9ydCBkZWxheSBmb3IgZmFzdGVyIHVwZGF0ZXNcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gT2JzZXJ2ZSB0aGUgZW50aXJlIGRvY3VtZW50IGZvciBjaGFuZ2VzXHJcbiAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xyXG4gICAgICBjaGlsZExpc3Q6IHRydWUsXHJcbiAgICAgIHN1YnRyZWU6IHRydWUsXHJcbiAgICAgIGNoYXJhY3RlckRhdGE6IHRydWUsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE92ZXJyaWRlIHRleHRDb250ZW50IG9uIGFsbCBiYWNrbGluayBlbGVtZW50c1xyXG4gICAqL1xyXG4gIHByaXZhdGUgb3ZlcnJpZGVCYWNrbGlua0VsZW1lbnRzKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc2VsZWN0b3JzID0gW1xyXG4gICAgICAnLnRyZWUtaXRlbS1pbm5lcicsXHJcbiAgICAgICcuYmFja2xpbmstdGl0bGUnLFxyXG4gICAgICAnLmJhY2tsaW5rLWZpbGUtbGluaycsXHJcbiAgICAgICcub3V0Z29pbmctbGluay1maWxlLWxpbmsnLFxyXG4gICAgICAnLnRyZWUtaXRlbS1zZWxmJyxcclxuICAgICAgJy5uYXYtZmlsZS10aXRsZScsXHJcbiAgICAgICdbZGF0YS1wYXRoXScsXHJcbiAgICAgICdhLmludGVybmFsLWxpbmsnXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGNvbnRhaW5lcnMgPSBbXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVtYmVkZGVkLWJhY2tsaW5rcycpKSxcclxuICAgICAgLi4uQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYmFja2xpbmtzLXBhbmUnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhY2tsaW5rLXBhbmUnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm91dGdvaW5nLWxpbmstcGFuZScpKSxcclxuICAgICAgLi4uQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub3V0Z29pbmctbGlua3MnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhY2tsaW5rLWNvbnRhaW5lcicpKVxyXG4gICAgXTtcclxuXHJcbiAgICBjb250YWluZXJzLmZvckVhY2goY29udGFpbmVyID0+IHtcclxuICAgICAgc2VsZWN0b3JzLmZvckVhY2goc2VsZWN0b3IgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlbCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5vdmVycmlkZUVsZW1lbnRUZXh0Q29udGVudChlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgICAgLy8gSWdub3JlIGludmFsaWQgc2VsZWN0b3IgZXJyb3JzXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3ZlcnJpZGUgdGV4dENvbnRlbnQgc2V0dGVyIG9uIGFuIGVsZW1lbnQgdG8gaW50ZXJjZXB0IE9ic2lkaWFuJ3MgdXBkYXRlc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgb3ZlcnJpZGVFbGVtZW50VGV4dENvbnRlbnQoZWxlbWVudDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLm1vZGlmaWVkRWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XHJcbiAgICAgIHJldHVybjsgLy8gQWxyZWFkeSBvdmVycmlkZGVuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3RvcmUgb3JpZ2luYWwgdGV4dENvbnRlbnQgZGVzY3JpcHRvciBpZiBpdCBleGlzdHNcclxuICAgIGNvbnN0IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGVsZW1lbnQpIGFzIHsgdGV4dENvbnRlbnQ/OiBQcm9wZXJ0eURlc2NyaXB0b3IgfTtcclxuICAgIGNvbnN0IG9yaWdpbmFsRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG8sICd0ZXh0Q29udGVudCcpO1xyXG5cclxuICAgIGlmIChvcmlnaW5hbERlc2NyaXB0b3IgJiYgb3JpZ2luYWxEZXNjcmlwdG9yLnNldCkge1xyXG4gICAgICB0aGlzLm9yaWdpbmFsVGV4dENvbnRlbnREZXNjcmlwdG9ycy5zZXQoZWxlbWVudCwgb3JpZ2luYWxEZXNjcmlwdG9yKTtcclxuXHJcbiAgICAgIC8vIE92ZXJyaWRlIHRleHRDb250ZW50IHNldHRlclxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbGVtZW50LCAndGV4dENvbnRlbnQnLCB7XHJcbiAgICAgICAgICBzZXQ6ICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoaXMgbG9va3MgbGlrZSBhIGZpbGVuYW1lIHRoYXQgc2hvdWxkIGJlIHJlcGxhY2VkXHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmV4dHJhY3RGaWxlUGF0aEZyb21FbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgICAgICAgICBpZiAoZmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICAgICAgICB2b2lkIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IGF3YWl0IHRoaXMuZ2V0RGlzcGxheU5hbWUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGlzcGxheU5hbWUgJiYgKHZhbHVlID09PSBmaWxlLmJhc2VuYW1lIHx8IHZhbHVlID09PSBmaWxlLm5hbWUgfHwgdmFsdWUuZW5kc1dpdGgoZmlsZS5iYXNlbmFtZSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugd2l0aCBwcm9wZXJ0eSB2YWx1ZSB1c2luZyBvcmlnaW5hbCBzZXR0ZXJcclxuICAgICAgICAgICAgICAgICAgb3JpZ2luYWxEZXNjcmlwdG9yLnNldCEuY2FsbChlbGVtZW50LCBkaXNwbGF5TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgIC8vIE1hcmsgYXMgcHJvY2Vzc2VkXHJcbiAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi1wcm9jZXNzZWQnLCAndHJ1ZScpO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NlZEVsZW1lbnRzLmFkZChlbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gTm90IGEgZmlsZW5hbWUgb3Igbm8gcHJvcGVydHksIHVzZSBvcmlnaW5hbCBiZWhhdmlvclxyXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxEZXNjcmlwdG9yLnNldCEuY2FsbChlbGVtZW50LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgfSkoKTtcclxuICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIE5vdCBhIGZpbGVuYW1lIG9yIG5vIHByb3BlcnR5LCB1c2Ugb3JpZ2luYWwgYmVoYXZpb3JcclxuICAgICAgICAgICAgb3JpZ2luYWxEZXNjcmlwdG9yLnNldCEuY2FsbChlbGVtZW50LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIC8vIE1hcmsgYXMgcHJvY2Vzc2VkXHJcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi1wcm9jZXNzZWQnLCAndHJ1ZScpO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvdW5ib3VuZC1tZXRob2QgLS0gYWNjZXNzaW5nIHByb3BlcnR5IGRlc2NyaXB0b3Igb3JpZ2luYWwgc2V0dGVyXHJcbiAgICAgICAgICBnZXQ6IG9yaWdpbmFsRGVzY3JpcHRvci5nZXQgfHwgKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gRmFsbGJhY2s6IGFjY2VzcyB0aGUgbmF0aXZlIHRleHRDb250ZW50IHByb3BlcnR5IGRpcmVjdGx5XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ3RleHRDb250ZW50Jyk/LmdldD8uY2FsbChlbGVtZW50KSBhcyBzdHJpbmcgfHwgJyc7XHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIGVudW1lcmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgLy8gSWYgb3ZlcnJpZGUgZmFpbHMgKGUuZy4sIHByb3BlcnR5IGlzIG5vdCBjb25maWd1cmFibGUpLCBmYWxsIGJhY2sgdG8gbW9uaXRvcmluZ1xyXG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi1wcm9jZXNzZWQnLCAndHJ1ZScpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBGYWxsYmFjazogY2FuJ3Qgb3ZlcnJpZGUsIGJ1dCBtYXJrIGFzIHByb2Nlc3NlZCBzbyBDU1MgZG9lc24ndCBoaWRlIGl0XHJcbiAgICAgIC8vIFRoZSBtdXRhdGlvbiBvYnNlcnZlciB3aWxsIGNhdGNoIGFuZCB1cGRhdGUgaXRcclxuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG92LXByb2Nlc3NlZCcsICd0cnVlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5tb2RpZmllZEVsZW1lbnRzLmFkZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3Agb2JzZXJ2aW5nIERPTSBjaGFuZ2VzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdG9wT2JzZXJ2aW5nKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMub2JzZXJ2ZXIpIHtcclxuICAgICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGUgbGF5b3V0IGNoYW5nZXNcclxuICAgKi9cclxuICBvbkxheW91dENoYW5nZSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JCYWNrbGlua3MpIHtcclxuICAgICAgLy8gU21hbGwgZGVsYXkgdG8gbGV0IE9ic2lkaWFuIHJlbmRlciBmaXJzdFxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICB9LCAxMDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5zdG9wT2JzZXJ2aW5nKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGUgZmlsZSBvcGVuIGV2ZW50c1xyXG4gICAqL1xyXG4gIG9uRmlsZU9wZW4oKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMudXBkYXRlRW1iZWRkZWRCYWNrbGlua3MoKTtcclxuICAgICAgfSwgMjAwKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFuIHVwIG9uIHVubG9hZFxyXG4gICAqL1xyXG4gIG9udW5sb2FkKCk6IHZvaWQge1xyXG4gICAgdGhpcy5zdG9wT2JzZXJ2aW5nKCk7XHJcblxyXG4gICAgLy8gUmVzdG9yZSBvcmlnaW5hbCB0ZXh0Q29udGVudCBkZXNjcmlwdG9yc1xyXG4gICAgdGhpcy5vcmlnaW5hbFRleHRDb250ZW50RGVzY3JpcHRvcnMuZm9yRWFjaCgoZGVzY3JpcHRvciwgZWxlbWVudCkgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbGVtZW50LCAndGV4dENvbnRlbnQnLCBkZXNjcmlwdG9yKTtcclxuICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgLy8gSWdub3JlIGVycm9ycyB3aGVuIHJlc3RvcmluZ1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHRoaXMub3JpZ2luYWxUZXh0Q29udGVudERlc2NyaXB0b3JzLmNsZWFyKCk7XHJcbiAgICB0aGlzLm1vZGlmaWVkRWxlbWVudHMgPSBuZXcgV2Vha1NldCgpO1xyXG4gIH1cclxufVxyXG5cclxuIiwgIi8qKlxuICogVGFiIFNlcnZpY2VcbiAqIFxuICogVGhpcyBmaWxlIGNvbnRhaW5zIGNvZGUgYWRhcHRlZCBmcm9tIHRoZSBUaXRsZS1vbmx5IFRhYiBwbHVnaW4gYnkgdHJpc3RvbmUxM3RoLlxuICogT3JpZ2luYWwgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vdHJpc3RvbmUxM3RoL29ic2lkaWFuLXRpdGxlLW9ubHktdGFiXG4gKiBcbiAqIFRoZSBjb2RlIGhhcyBiZWVuIG1vZGlmaWVkIHRvIGludGVncmF0ZSB3aXRoIHRoZSBQcm9wZXJ0eSBPdmVyIEZpbGUgTmFtZSBwbHVnaW5cbiAqIGFuZCB1c2UgdGhlIHBsdWdpbidzIHByb3BlcnR5IGtleSBzZXR0aW5nIGluc3RlYWQgb2YgaGFyZGNvZGVkIFwidGl0bGVcIiBwcm9wZXJ0eS5cbiAqIFxuICogT3JpZ2luYWwgY29kZSBpcyBsaWNlbnNlZCB1bmRlciBNSVQuIFRoaXMgZmlsZSBpcyBhbHNvIGxpY2Vuc2VkIHVuZGVyIEdQTHYzLlxuICovXG5cbmltcG9ydCB7IE1hcmtkb3duVmlldywgV29ya3NwYWNlTGVhZiwgRXZlbnRSZWYgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IGdldEZyb250bWF0dGVyIH0gZnJvbSAnLi4vdXRpbHMvZnJvbnRtYXR0ZXInO1xuXG5leHBvcnQgY2xhc3MgVGFiU2VydmljZSB7XG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcbiAgcHJpdmF0ZSBsZWFmRXZlbnRSZWZzOiBNYXA8V29ya3NwYWNlTGVhZiwgRXZlbnRSZWY+ID0gbmV3IE1hcCgpO1xuXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5hbWVzIGFsbCBtYXJrZG93biB0YWJzIHRvIHVzZSB0aGUgY29uZmlndXJlZCBwcm9wZXJ0eSB2YWx1ZVxuICAgKiBGYWxscyBiYWNrIHRvIGZpbGUgYmFzZW5hbWUgaWYgcHJvcGVydHkgaXMgbm90IGZvdW5kXG4gICAqIEVYQUNUIGNvcHkgb2YgdGhlIHdvcmtpbmcgaW1wbGVtZW50YXRpb24gZnJvbSBvYnNpZGlhbi10aXRsZS1vbmx5LXRhYlxuICAgKi9cbiAgcmVuYW1lVGFicygpIHtcbiAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKTtcbiAgICBsZWF2ZXMuZm9yRWFjaCgobGVhZikgPT4ge1xuICAgICAgLypcbiAgICAgICAqIFdoZW4gT2JzaWRpYW4gZmlyc3Qgb3BlbnMsIGR1ZSB0byBsYXp5IGxvYWRpbmcsIHRoZSB2aWV3IG1heSBub3QgaGF2ZVxuICAgICAgICogYSBmaWxlIHByb3BlcnR5LiBXZSBuZWVkIHRvIG1hbnVhbGx5IHRyaWdnZXIgYSByZWxvYWQuIEJ5IHVzaW5nIHNldFZpZXdTdGF0ZVxuICAgICAgICogdG8gcmVhcHBseSB0aGUgdmlldyBzdGF0ZSwgd2UgZm9yY2UgdGhlIHZpZXcgdG8gcmVpbml0aWFsaXplIGFuZCBsb2FkIHRoZVxuICAgICAgICogY29ycmVzcG9uZGluZyBmaWxlLCB0aHVzIHBvcHVsYXRpbmcgdGhlIGZpbGUgcHJvcGVydHkuIElmIG1hbnkgdGFicyBhcmUgb3BlbixcbiAgICAgICAqIHRoaXMgbWF5IHNsaWdodGx5IGluY3JlYXNlIHN0YXJ0dXAgdGltZS5cbiAgICAgICAqL1xuICAgICAgY29uc3QgdmlldyA9IGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG4gICAgICBjb25zdCBzdGF0ZSA9IGxlYWYuZ2V0Vmlld1N0YXRlKCk7XG4gICAgICBpZiAoc3RhdGUuc3RhdGU/LmZpbGUgJiYgIXZpZXc/LmZpbGUpIHtcbiAgICAgICAgdm9pZCBsZWFmLnNldFZpZXdTdGF0ZSh7IHR5cGU6IHN0YXRlLnR5cGUsIHN0YXRlOiBzdGF0ZS5zdGF0ZSB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHZpZXc/LmZpbGUpIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHZpZXcuZmlsZTtcbiAgICAgICAgLy8gVXNlIGFzeW5jIHZlcnNpb24gdG8gc3VwcG9ydCBNRFggZmlsZXNcbiAgICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gYXdhaXQgZ2V0RnJvbnRtYXR0ZXIodGhpcy5wbHVnaW4uYXBwLCBmaWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XG4gICAgICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IGZyb250bWF0dGVyPy5bdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldIGFzIHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgICBjb25zdCB0YWJIZWFkZXJFbCA9IChsZWFmIGFzIHsgdGFiSGVhZGVyRWw/OiBIVE1MRWxlbWVudCB9KS50YWJIZWFkZXJFbDtcblxuICAgICAgICAgIGlmICh0YWJIZWFkZXJFbCkge1xuICAgICAgICAgICAgLy8gQWx3YXlzIG1hcmsgdGFicyBhcyBwcm9jZXNzZWQgc28gdGhleSdyZSBub3QgZGltbWVkIChldmVuIHdoZW4gZmVhdHVyZSBpcyBkaXNhYmxlZClcbiAgICAgICAgICAgIHRhYkhlYWRlckVsLnNldEF0dHJpYnV0ZSgnZGF0YS1wb3YtdGl0bGUtc2V0JywgJ3RydWUnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gT25seSBjaGFuZ2UgdGhlIHRpdGxlIGlmIHRoZSBmZWF0dXJlIGlzIGVuYWJsZWRcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JUYWJzKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHRpdGxlRWwgPSB0YWJIZWFkZXJFbC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXRhYi1oZWFkZXItaW5uZXItdGl0bGUnKTtcbiAgICAgICAgICAgICAgY29uc3QgZGlzcGxheVRleHQgPSBwcm9wZXJ0eVZhbHVlID8gU3RyaW5nKHByb3BlcnR5VmFsdWUpIDogZmlsZS5iYXNlbmFtZTtcbiAgICAgICAgICAgICAgaWYgKHRpdGxlRWwpIHtcbiAgICAgICAgICAgICAgICB0aXRsZUVsLnNldFRleHQoZGlzcGxheVRleHQpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGFiSGVhZGVyRWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgZGlzcGxheVRleHQpO1xuICAgICAgICAgICAgICB0YWJIZWFkZXJFbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZGlzcGxheVRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBwaW5uZWQtY2hhbmdlIGV2ZW50IGxpc3RlbmVycyBvbiBhbGwgbWFya2Rvd24gbGVhdmVzXG4gICAqIFRoaXMgZW5zdXJlcyB0YWIgdGl0bGVzIGFyZSByZS1hcHBsaWVkIHdoZW4gdGFicyBhcmUgcGlubmVkL3VucGlubmVkXG4gICAqL1xuICBwcml2YXRlIHJlZ2lzdGVyTGVhZkxpc3RlbmVycygpIHtcbiAgICBjb25zdCBjdXJyZW50TGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ21hcmtkb3duJyk7XG4gICAgY29uc3QgY3VycmVudExlYWZTZXQgPSBuZXcgU2V0KGN1cnJlbnRMZWF2ZXMpO1xuXG4gICAgLy8gUmVnaXN0ZXIgbGlzdGVuZXJzIG9uIG5ldyBsZWF2ZXNcbiAgICBjdXJyZW50TGVhdmVzLmZvckVhY2goKGxlYWYpID0+IHtcbiAgICAgIGlmICghdGhpcy5sZWFmRXZlbnRSZWZzLmhhcyhsZWFmKSkge1xuICAgICAgICAvLyBSZWdpc3RlciBwaW5uZWQtY2hhbmdlIGxpc3RlbmVyIHdpdGggYSBkZWxheSB0byBsZXQgT2JzaWRpYW4gZmluaXNoIERPTSB1cGRhdGVzXG4gICAgICAgIGNvbnN0IGV2ZW50UmVmID0gbGVhZi5vbigncGlubmVkLWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAvLyBVc2UgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGZvciBiZXR0ZXIgdGltaW5nIHdpdGggRE9NIHVwZGF0ZXNcbiAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgLy8gU21hbGwgYWRkaXRpb25hbCBkZWxheSB0byBlbnN1cmUgT2JzaWRpYW4gaGFzIGZpbmlzaGVkIHVwZGF0aW5nXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgdm9pZCB0aGlzLnJlbmFtZVRhYnMoKTtcbiAgICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGVhZkV2ZW50UmVmcy5zZXQobGVhZiwgZXZlbnRSZWYpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQ2xlYW4gdXAgbGlzdGVuZXJzIGZvciBsZWF2ZXMgdGhhdCBubyBsb25nZXIgZXhpc3RcbiAgICBmb3IgKGNvbnN0IFtsZWFmLCBldmVudFJlZl0gb2YgdGhpcy5sZWFmRXZlbnRSZWZzLmVudHJpZXMoKSkge1xuICAgICAgaWYgKCFjdXJyZW50TGVhZlNldC5oYXMobGVhZikpIHtcbiAgICAgICAgbGVhZi5vZmZyZWYoZXZlbnRSZWYpO1xuICAgICAgICB0aGlzLmxlYWZFdmVudFJlZnMuZGVsZXRlKGxlYWYpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBldmVudCBsaXN0ZW5lcnMgZm9yIHRhYiByZW5hbWluZ1xuICAgKiBFWEFDVCBjb3B5IG9mIHRoZSB3b3JraW5nIGltcGxlbWVudGF0aW9uIGZyb20gb2JzaWRpYW4tdGl0bGUtb25seS10YWJcbiAgICovXG4gIHJlZ2lzdGVyRXZlbnRzKCkge1xuICAgIHRoaXMucmVuYW1lVGFicygpO1xuXG4gICAgLy8gUmVnaXN0ZXIgbGVhZi1sZXZlbCBwaW5uZWQtY2hhbmdlIGxpc3RlbmVyc1xuICAgIHRoaXMucmVnaXN0ZXJMZWFmTGlzdGVuZXJzKCk7XG5cbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignbGF5b3V0LWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgdm9pZCB0aGlzLnJlbmFtZVRhYnMoKTtcbiAgICAgICAgLy8gUmUtcmVnaXN0ZXIgbGVhZiBsaXN0ZW5lcnMgdG8gY2F0Y2ggbmV3bHkgY3JlYXRlZCBsZWF2ZXNcbiAgICAgICAgdGhpcy5yZWdpc3RlckxlYWZMaXN0ZW5lcnMoKTtcbiAgICAgIH0pXG4gICAgKTtcblxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXG4gICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAoKSA9PiB0aGlzLnJlbmFtZVRhYnMoKSlcbiAgICApO1xuXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtb3BlbicsICgpID0+IHRoaXMucmVuYW1lVGFicygpKVxuICAgICk7XG5cbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoKSA9PiB0aGlzLnJlbmFtZVRhYnMoKSlcbiAgICApO1xuXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgIHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdjaGFuZ2VkJywgKCkgPT4gdGhpcy5yZW5hbWVUYWJzKCkpXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGFicyAocHVibGljIG1ldGhvZCBmb3IgbWFudWFsIHVwZGF0ZXMpXG4gICAqL1xuICB1cGRhdGVUYWJzKCkge1xuICAgIHZvaWQgdGhpcy5yZW5hbWVUYWJzKCk7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCBvbiB1bmxvYWRcbiAgICovXG4gIG9udW5sb2FkKCkge1xuICAgIC8vIFVucmVnaXN0ZXIgYWxsIGxlYWYtbGV2ZWwgZXZlbnQgbGlzdGVuZXJzXG4gICAgZm9yIChjb25zdCBbbGVhZiwgZXZlbnRSZWZdIG9mIHRoaXMubGVhZkV2ZW50UmVmcy5lbnRyaWVzKCkpIHtcbiAgICAgIGxlYWYub2ZmcmVmKGV2ZW50UmVmKTtcbiAgICB9XG4gICAgdGhpcy5sZWFmRXZlbnRSZWZzLmNsZWFyKCk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBURmlsZSwgVEZvbGRlciB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4sIFRGaWxlRXhwbG9yZXJJdGVtLCBURmlsZUV4cGxvcmVyVmlldyB9IGZyb20gJy4uL3R5cGVzJztcclxuXHJcbi8qKlxyXG4gKiBFeHBsb3JlciBTZXJ2aWNlXHJcbiAqIFxyXG4gKiBIYW5kbGVzIGRpc3BsYXlpbmcgcHJvcGVydHktYmFzZWQgdGl0bGVzIGluIHRoZSBmaWxlIGV4cGxvcmVyLlxyXG4gKiBTdXBwb3J0cyBmb2xkZXIgbm90ZXM6IGlmIGEgZm9sZGVyIGNvbnRhaW5zIGEgZmlsZSBtYXRjaGluZyB0aGUgY29uZmlndXJlZFxyXG4gKiBmb2xkZXIgbm90ZSBmaWxlbmFtZSAoZS5nLiwgXCJpbmRleC5tZFwiKSB3aXRoIGEgZnJvbnRtYXR0ZXIgdGl0bGUsIHRoZSBmb2xkZXJcclxuICogd2lsbCBkaXNwbGF5IHRoYXQgdGl0bGUgaW5zdGVhZCBvZiB0aGUgZm9sZGVyIG5hbWUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRXhwbG9yZXJTZXJ2aWNlIHtcclxuICBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luOyAvLyBQdWJsaWMgc28gRXhwbG9yZXJGaWxlSXRlbU11dGF0b3IgY2FuIGFjY2VzcyBpdFxyXG4gIHByaXZhdGUgZXhwbG9yZXJWaWV3OiBURmlsZUV4cGxvcmVyVmlldyB8IG51bGwgPSBudWxsO1xyXG4gIHByaXZhdGUgbW9kaWZpZWQgPSBuZXcgV2Vha01hcDxURmlsZUV4cGxvcmVySXRlbSwgRXhwbG9yZXJGaWxlSXRlbU11dGF0b3I+KCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBmaWxlIGV4cGxvcmVyIHZpZXdcclxuICAgKi9cclxuICBwcml2YXRlIGdldEV4cGxvcmVyVmlldygpOiBURmlsZUV4cGxvcmVyVmlldyB8IG51bGwge1xyXG4gICAgaWYgKHRoaXMuZXhwbG9yZXJWaWV3ID09PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdmaWxlLWV4cGxvcmVyJyk7XHJcbiAgICAgIGlmIChsZWF2ZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgbGVhZiA9IGxlYXZlc1swXTtcclxuICAgICAgaWYgKGxlYWYgJiYgbGVhZi52aWV3KSB7XHJcbiAgICAgICAgLy8gVHlwZSBhc3NlcnRpb24gdGhyb3VnaCB1bmtub3duIHRvIGhhbmRsZSB0aGUgaW50ZXJmYWNlIG1pc21hdGNoXHJcbiAgICAgICAgdGhpcy5leHBsb3JlclZpZXcgPSBsZWFmLnZpZXcgYXMgdW5rbm93biBhcyBURmlsZUV4cGxvcmVyVmlldztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuZXhwbG9yZXJWaWV3O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGZvbGRlciBub3RlIHRpdGxlIGZvciBhIGZvbGRlclxyXG4gICAqIFJldHVybnMgdGhlIGZyb250bWF0dGVyIHRpdGxlIHByb3BlcnR5IGZyb20gdGhlIGZvbGRlciBub3RlIGZpbGUgaWYgaXQgZXhpc3RzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRGb2xkZXJOb3RlVGl0bGUoZm9sZGVyOiBURm9sZGVyKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlck5vdGVGaWxlbmFtZSB8fCBcclxuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJOb3RlRmlsZW5hbWUudHJpbSgpID09PSAnJykge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmb2xkZXJOb3RlRmlsZW5hbWUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJOb3RlRmlsZW5hbWUudHJpbSgpO1xyXG4gICAgY29uc3QgZm9sZGVyTm90ZVBhdGggPSBgJHtmb2xkZXIucGF0aH0vJHtmb2xkZXJOb3RlRmlsZW5hbWV9Lm1kYDtcclxuICAgIGNvbnN0IGZvbGRlck5vdGVGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJOb3RlUGF0aCk7XHJcblxyXG4gICAgaWYgKGZvbGRlck5vdGVGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZm9sZGVyTm90ZUZpbGUpO1xyXG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gY2FjaGU/LmZyb250bWF0dGVyPy5bdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldIGFzIHN0cmluZyB8IHVuZGVmaW5lZDtcclxuICAgICAgaWYgKHByb3BlcnR5VmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gU3RyaW5nKHByb3BlcnR5VmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNvbHZlIHRpdGxlIGZvciBhIGZpbGUgb3IgZm9sZGVyXHJcbiAgICogUHVibGljIHNvIEV4cGxvcmVyRmlsZUl0ZW1NdXRhdG9yIGNhbiBhY2Nlc3MgaXRcclxuICAgKi9cclxuICBhc3luYyByZXNvbHZlVGl0bGUoaXRlbTogVEZpbGVFeHBsb3Jlckl0ZW0pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICAgIGlmIChpdGVtLmZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAvLyBGb3IgZmlsZXMsIHVzZSBwcm9wZXJ0eS1iYXNlZCB0aXRsZVxyXG4gICAgICBjb25zdCB7IGdldEZyb250bWF0dGVyLCBpc0ZpbGVUeXBlU3VwcG9ydGVkIH0gPSBhd2FpdCBpbXBvcnQoJy4uL3V0aWxzL2Zyb250bWF0dGVyJyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTa2lwIHVuc3VwcG9ydGVkIGZpbGUgdHlwZXNcclxuICAgICAgaWYgKCFpc0ZpbGVUeXBlU3VwcG9ydGVkKGl0ZW0uZmlsZS5leHRlbnNpb24sIHRoaXMucGx1Z2luLnNldHRpbmdzKSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBmcm9udG1hdHRlciA9IGF3YWl0IGdldEZyb250bWF0dGVyKHRoaXMucGx1Z2luLmFwcCwgaXRlbS5maWxlLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBmcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlID8gU3RyaW5nKHByb3BlcnR5VmFsdWUpIDogbnVsbDtcclxuICAgIH0gZWxzZSBpZiAoaXRlbS5maWxlIGluc3RhbmNlb2YgVEZvbGRlcikge1xyXG4gICAgICAvLyBGb3IgZm9sZGVycywgY2hlY2sgZm9yIGZvbGRlciBub3RlXHJcbiAgICAgIHJldHVybiB0aGlzLmdldEZvbGRlck5vdGVUaXRsZShpdGVtLmZpbGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYWxsIGZpbGUgZXhwbG9yZXIgaXRlbXNcclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZUFsbEl0ZW1zKCkge1xyXG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0RXhwbG9yZXJWaWV3KCk7XHJcbiAgICBpZiAoIXZpZXcgfHwgIXZpZXcuZmlsZUl0ZW1zKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpdGVtcyA9IE9iamVjdC52YWx1ZXModmlldy5maWxlSXRlbXMpO1xyXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XHJcbiAgICAgIGlmICghdGhpcy5tb2RpZmllZC5oYXMoaXRlbSkpIHtcclxuICAgICAgICB0aGlzLm1vZGlmaWVkLnNldChpdGVtLCBuZXcgRXhwbG9yZXJGaWxlSXRlbU11dGF0b3IoaXRlbSwgdGhpcykpO1xyXG4gICAgICB9XHJcbiAgICAgIGl0ZW0udXBkYXRlVGl0bGUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RvcmUgYWxsIG9yaWdpbmFsIHRpdGxlc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcmVzdG9yZUFsbEl0ZW1zKCkge1xyXG4gICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0RXhwbG9yZXJWaWV3KCk7XHJcbiAgICBpZiAoIXZpZXcgfHwgIXZpZXcuZmlsZUl0ZW1zKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpdGVtcyA9IE9iamVjdC52YWx1ZXModmlldy5maWxlSXRlbXMpO1xyXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XHJcbiAgICAgIGlmICh0aGlzLm1vZGlmaWVkLmhhcyhpdGVtKSkge1xyXG4gICAgICAgIGNvbnN0IG11dGF0b3IgPSB0aGlzLm1vZGlmaWVkLmdldChpdGVtKTtcclxuICAgICAgICBtdXRhdG9yPy5kZXN0cm95KCk7XHJcbiAgICAgICAgdGhpcy5tb2RpZmllZC5kZWxldGUoaXRlbSk7XHJcbiAgICAgICAgaXRlbS51cGRhdGVUaXRsZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWdpc3RlciBldmVudHMgYW5kIGluaXRpYWxpemVcclxuICAgKi9cclxuICByZWdpc3RlckV2ZW50cygpIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFdhaXQgZm9yIGxheW91dCB0byBiZSByZWFkeVxyXG4gICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcclxuICAgICAgdGhpcy5leHBsb3JlclZpZXcgPSBudWxsOyAvLyBSZXNldCB0byBnZXQgZnJlc2ggdmlld1xyXG4gICAgICB0aGlzLnVwZGF0ZUFsbEl0ZW1zKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBVcGRhdGUgd2hlbiBsYXlvdXQgY2hhbmdlc1xyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignbGF5b3V0LWNoYW5nZScsICgpID0+IHtcclxuICAgICAgICB0aGlzLmV4cGxvcmVyVmlldyA9IG51bGw7IC8vIFJlc2V0IHRvIGdldCBmcmVzaCB2aWV3XHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZUFsbEl0ZW1zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgd2hlbiBtZXRhZGF0YSBjaGFuZ2VzXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIpIHtcclxuICAgICAgICAgIHRoaXMudXBkYXRlQWxsSXRlbXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB3aGVuIGZpbGVzIGFyZSByZW5hbWVkXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQub24oJ3JlbmFtZScsICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIpIHtcclxuICAgICAgICAgIHRoaXMuZXhwbG9yZXJWaWV3ID0gbnVsbDsgLy8gUmVzZXQgdG8gZ2V0IGZyZXNoIHZpZXdcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy51cGRhdGVBbGxJdGVtcygpLCAxMDApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgZXhwbG9yZXIgd2hlbiBzZXR0aW5ncyBjaGFuZ2VcclxuICAgKi9cclxuICB1cGRhdGVFeHBsb3JlcigpIHtcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3Jlcikge1xyXG4gICAgICB0aGlzLmV4cGxvcmVyVmlldyA9IG51bGw7IC8vIFJlc2V0IHRvIGdldCBmcmVzaCB2aWV3XHJcbiAgICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnVwZGF0ZUFsbEl0ZW1zKCksIDEwMCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnJlc3RvcmVBbGxJdGVtcygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYW51cCBvbiB1bmxvYWRcclxuICAgKi9cclxuICBvbnVubG9hZCgpIHtcclxuICAgIHRoaXMucmVzdG9yZUFsbEl0ZW1zKCk7XHJcbiAgICB0aGlzLmV4cGxvcmVyVmlldyA9IG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogTXV0YXRvciBmb3IgaW5kaXZpZHVhbCBmaWxlIGV4cGxvcmVyIGl0ZW1zXHJcbiAqIEhvb2tzIGludG8gdXBkYXRlVGl0bGUoKSB0byByZXBsYWNlIGRpc3BsYXllZCB0ZXh0XHJcbiAqL1xyXG5jbGFzcyBFeHBsb3JlckZpbGVJdGVtTXV0YXRvciB7XHJcbiAgcHJpdmF0ZSBvcmlnaW5hbFVwZGF0ZVRpdGxlOiAoKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxTdGFydFJlbmFtZTogKCgpID0+IHZvaWQpIHwgdW5kZWZpbmVkO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgaXRlbTogVEZpbGVFeHBsb3Jlckl0ZW0sXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNlcnZpY2U6IEV4cGxvcmVyU2VydmljZVxyXG4gICkge1xyXG4gICAgLy8gU3RvcmUgb3JpZ2luYWwgbWV0aG9kc1xyXG4gICAgY29uc3QgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoaXRlbSkgYXMgeyB1cGRhdGVUaXRsZTogKCkgPT4gdm9pZDsgc3RhcnRSZW5hbWU/OiAoKSA9PiB2b2lkIH07XHJcbiAgICB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUgPSBwcm90by51cGRhdGVUaXRsZS5iaW5kKGl0ZW0pO1xyXG4gICAgdGhpcy5vcmlnaW5hbFN0YXJ0UmVuYW1lID0gcHJvdG8uc3RhcnRSZW5hbWUgPyBwcm90by5zdGFydFJlbmFtZS5iaW5kKGl0ZW0pIDogdW5kZWZpbmVkO1xyXG5cclxuICAgIC8vIE92ZXJyaWRlIHVwZGF0ZVRpdGxlXHJcbiAgICBpdGVtLnVwZGF0ZVRpdGxlID0gdGhpcy51cGRhdGVUaXRsZS5iaW5kKHRoaXMpO1xyXG4gICAgXHJcbiAgICAvLyBPdmVycmlkZSBzdGFydFJlbmFtZSBpZiBpdCBleGlzdHNcclxuICAgIGlmIChwcm90by5zdGFydFJlbmFtZSkge1xyXG4gICAgICBpdGVtLnN0YXJ0UmVuYW1lID0gdGhpcy5zdGFydFJlbmFtZS5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVUaXRsZSgpIHtcclxuICAgIC8vIENhbGwgb3JpZ2luYWwgdG8gc2V0IHVwIHRoZSBlbGVtZW50XHJcbiAgICB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUoKTtcclxuICAgIFxyXG4gICAgLy8gUmVwbGFjZSB3aXRoIHByb3BlcnR5LWJhc2VkIHRpdGxlIGlmIGVuYWJsZWRcclxuICAgIGlmICh0aGlzLnNlcnZpY2UucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgIHZvaWQgKGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCB0aXRsZSA9IGF3YWl0IHRoaXMuc2VydmljZS5yZXNvbHZlVGl0bGUodGhpcy5pdGVtKTtcclxuICAgICAgICBpZiAodGl0bGUgJiYgdGl0bGUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgdGhpcy5pdGVtLmlubmVyRWwuc2V0VGV4dCh0aXRsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGFydFJlbmFtZSgpIHtcclxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGl0bGUgZm9yIHJlbmFtaW5nXHJcbiAgICB0aGlzLml0ZW0uaW5uZXJFbC5zZXRUZXh0KHRoaXMuaXRlbS5nZXRUaXRsZSgpKTtcclxuICAgIHJldHVybiB0aGlzLm9yaWdpbmFsU3RhcnRSZW5hbWU/LigpO1xyXG4gIH1cclxuXHJcbiAgZGVzdHJveSgpIHtcclxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgbWV0aG9kc1xyXG4gICAgY29uc3QgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcy5pdGVtKSBhcyB7IHN0YXJ0UmVuYW1lPzogKCkgPT4gdm9pZCB9O1xyXG4gICAgdGhpcy5pdGVtLnVwZGF0ZVRpdGxlID0gdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlO1xyXG4gICAgaWYgKHByb3RvLnN0YXJ0UmVuYW1lICYmIHRoaXMub3JpZ2luYWxTdGFydFJlbmFtZSkge1xyXG4gICAgICB0aGlzLml0ZW0uc3RhcnRSZW5hbWUgPSB0aGlzLm9yaWdpbmFsU3RhcnRSZW5hbWU7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luLCBXb3Jrc3BhY2VFeHQgfSBmcm9tICcuLi90eXBlcyc7XHJcbmltcG9ydCB7IGdldEZyb250bWF0dGVyIH0gZnJvbSAnLi4vdXRpbHMvZnJvbnRtYXR0ZXInO1xyXG5cclxuLyoqXHJcbiAqIFdpbmRvdyBGcmFtZSBTZXJ2aWNlXHJcbiAqIFxyXG4gKiBIYW5kbGVzIGRpc3BsYXlpbmcgcHJvcGVydHktYmFzZWQgdGl0bGUgaW4gdGhlIGJyb3dzZXIgd2luZG93IHRpdGxlIGJhci5cclxuICogT3ZlcnJpZGVzIHdvcmtzcGFjZS51cGRhdGVUaXRsZSgpIHRvIHVzZSB0aGUgZnJvbnRtYXR0ZXIgcHJvcGVydHkgaW5zdGVhZFxyXG4gKiBvZiB0aGUgZmlsZSBuYW1lLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFdpbmRvd0ZyYW1lU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxVcGRhdGVUaXRsZTogKCgpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBlbmFibGVkOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSB0aXRsZSBmb3IgdGhlIGFjdGl2ZSBmaWxlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRBY3RpdmVGaWxlVGl0bGUoKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgIGlmIChhY3RpdmVGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgLy8gRm9yIE1EIGZpbGVzLCB1c2UgbWV0YWRhdGEgY2FjaGUgKGZhc3Qgc3luYyBhY2Nlc3MpXHJcbiAgICAgIGlmIChhY3RpdmVGaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgIGNvbnN0IGZpbGVDYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhY3RpdmVGaWxlKTtcclxuICAgICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gZmlsZUNhY2hlPy5mcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgaWYgKHByb3BlcnR5VmFsdWUpIHtcclxuICAgICAgICAgIHJldHVybiBTdHJpbmcocHJvcGVydHlWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhY3RpdmVGaWxlLmJhc2VuYW1lO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBGb3IgTURYIGZpbGVzLCB0cmlnZ2VyIGFzeW5jIHJlYWQgYW5kIHJldHVybiBmaWxlbmFtZSBmb3Igbm93XHJcbiAgICAgIC8vIFRoZSB0aXRsZSB3aWxsIHVwZGF0ZSBvbmNlIHRoZSBjYWNoZSBpcyBwb3B1bGF0ZWRcclxuICAgICAgaWYgKGFjdGl2ZUZpbGUuZXh0ZW5zaW9uID09PSAnbWR4JyAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNZHhTdXBwb3J0KSB7XHJcbiAgICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBhd2FpdCBnZXRGcm9udG1hdHRlcih0aGlzLnBsdWdpbi5hcHAsIGFjdGl2ZUZpbGUsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBmcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgICBpZiAocHJvcGVydHlWYWx1ZSkge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGl0bGUgYXN5bmNocm9ub3VzbHlcclxuICAgICAgICAgICAgY29uc3QgYXBwID0gdGhpcy5wbHVnaW4uYXBwIGFzIHsgZ2V0QXBwVGl0bGU/OiAodGl0bGU6IHN0cmluZykgPT4gc3RyaW5nIH07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXBwLmdldEFwcFRpdGxlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBhcHAuZ2V0QXBwVGl0bGUoU3RyaW5nKHByb3BlcnR5VmFsdWUpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBjb25zdCB2YXVsdE5hbWUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TmFtZSgpO1xyXG4gICAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gYCR7U3RyaW5nKHByb3BlcnR5VmFsdWUpfSAtICR7dmF1bHROYW1lfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KSgpO1xyXG4gICAgICAgIHJldHVybiBhY3RpdmVGaWxlLmJhc2VuYW1lOyAvLyBSZXR1cm4gZmlsZW5hbWUgaW1tZWRpYXRlbHksIHdpbGwgdXBkYXRlIGFzeW5jXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHJldHVybiBhY3RpdmVGaWxlLmJhc2VuYW1lO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3ZlcnJpZGUgdXBkYXRlVGl0bGUgdG8gdXNlIHByb3BlcnR5LWJhc2VkIHRpdGxlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB1cGRhdGVUaXRsZSgpIHtcclxuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XHJcbiAgICAgIGlmICh0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUpIHtcclxuICAgICAgICB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUoKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdGl0bGUgPSB0aGlzLmdldEFjdGl2ZUZpbGVUaXRsZSgpO1xyXG4gICAgaWYgKHRpdGxlKSB7XHJcbiAgICAgIC8vIEdldCB0aGUgYXBwIHRpdGxlIGZvcm1hdCAodXN1YWxseSBcIlRpdGxlIC0gVmF1bHQgTmFtZVwiKVxyXG4gICAgICAvLyBUcnkgdG8gdXNlIE9ic2lkaWFuJ3MgZ2V0QXBwVGl0bGUgbWV0aG9kIGlmIGF2YWlsYWJsZVxyXG4gICAgICBjb25zdCBhcHAgPSB0aGlzLnBsdWdpbi5hcHAgYXMgeyBnZXRBcHBUaXRsZT86ICh0aXRsZTogc3RyaW5nKSA9PiBzdHJpbmcgfTtcclxuICAgICAgaWYgKHR5cGVvZiBhcHAuZ2V0QXBwVGl0bGUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBkb2N1bWVudC50aXRsZSA9IGFwcC5nZXRBcHBUaXRsZSh0aXRsZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmFsbGJhY2s6IGZvcm1hdCBtYW51YWxseVxyXG4gICAgICAgIGNvbnN0IHZhdWx0TmFtZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXROYW1lKCk7XHJcbiAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBgJHt0aXRsZX0gLSAke3ZhdWx0TmFtZX1gO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBiZWhhdmlvclxyXG4gICAgICBpZiAodGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlKSB7XHJcbiAgICAgICAgdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVuYWJsZSB0aGUgd2luZG93IGZyYW1lIGZlYXR1cmVcclxuICAgKi9cclxuICBlbmFibGUoKSB7XHJcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB3b3Jrc3BhY2UgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlIGFzIFdvcmtzcGFjZUV4dDtcclxuICAgIGlmICh3b3Jrc3BhY2UudXBkYXRlVGl0bGUpIHtcclxuICAgICAgLy8gU3RvcmUgb3JpZ2luYWwgbWV0aG9kXHJcbiAgICAgIHRoaXMub3JpZ2luYWxVcGRhdGVUaXRsZSA9IHdvcmtzcGFjZS51cGRhdGVUaXRsZS5iaW5kKHdvcmtzcGFjZSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPdmVycmlkZSB3aXRoIG91ciBtZXRob2RcclxuICAgICAgd29ya3NwYWNlLnVwZGF0ZVRpdGxlID0gdGhpcy51cGRhdGVUaXRsZS5iaW5kKHRoaXMpO1xyXG4gICAgICBcclxuICAgICAgLy8gVXBkYXRlIGltbWVkaWF0ZWx5XHJcbiAgICAgIHRoaXMudXBkYXRlVGl0bGUoKTtcclxuICAgICAgXHJcbiAgICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEaXNhYmxlIHRoZSB3aW5kb3cgZnJhbWUgZmVhdHVyZVxyXG4gICAqL1xyXG4gIGRpc2FibGUoKSB7XHJcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgd29ya3NwYWNlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZSBhcyBXb3Jrc3BhY2VFeHQ7XHJcbiAgICBpZiAod29ya3NwYWNlLnVwZGF0ZVRpdGxlICYmIHRoaXMub3JpZ2luYWxVcGRhdGVUaXRsZSkge1xyXG4gICAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIG1ldGhvZFxyXG4gICAgICB3b3Jrc3BhY2UudXBkYXRlVGl0bGUgPSB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGU7XHJcbiAgICAgIFxyXG4gICAgICAvLyBVcGRhdGUgdG8gcmVzdG9yZSBvcmlnaW5hbCB0aXRsZVxyXG4gICAgICB3b3Jrc3BhY2UudXBkYXRlVGl0bGUoKTtcclxuICAgICAgXHJcbiAgICAgIHRoaXMub3JpZ2luYWxVcGRhdGVUaXRsZSA9IG51bGw7XHJcbiAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgZXZlbnRzIGZvciB3aW5kb3cgZnJhbWUgdXBkYXRlc1xyXG4gICAqL1xyXG4gIHJlZ2lzdGVyRXZlbnRzKCkge1xyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JXaW5kb3dGcmFtZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIHdoZW4gYWN0aXZlIGZpbGUgY2hhbmdlc1xyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignZmlsZS1vcGVuJywgKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcclxuICAgICAgICAgIHRoaXMudXBkYXRlVGl0bGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB3aGVuIG1ldGFkYXRhIGNoYW5nZXNcclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdjaGFuZ2VkJywgKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcclxuICAgICAgICAgIHRoaXMudXBkYXRlVGl0bGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIHdpbmRvdyBmcmFtZSB3aGVuIHNldHRpbmdzIGNoYW5nZVxyXG4gICAqL1xyXG4gIHVwZGF0ZVdpbmRvd0ZyYW1lKCkge1xyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvcldpbmRvd0ZyYW1lKSB7XHJcbiAgICAgIHRoaXMuZW5hYmxlKCk7XHJcbiAgICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYW51cCBvbiB1bmxvYWRcclxuICAgKi9cclxuICBvbnVubG9hZCgpIHtcclxuICAgIHRoaXMuZGlzYWJsZSgpO1xyXG4gIH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiB9IGZyb20gJy4uL3R5cGVzJztcclxuaW1wb3J0IHsgZ2V0RnJvbnRtYXR0ZXIgfSBmcm9tICcuLi91dGlscy9mcm9udG1hdHRlcic7XHJcblxyXG4vKipcclxuICogQm9va21hcmsgU2VydmljZVxyXG4gKiBcclxuICogSG9va3MgaW50byBPYnNpZGlhbidzIGludGVybmFsIEJvb2ttYXJrcyBwbHVnaW4gdG8gY3VzdG9taXplIHRoZSBkZWZhdWx0XHJcbiAqIHRpdGxlIHdoZW4gY3JlYXRpbmcgYSBuZXcgYm9va21hcmsgZm9yIGEgbm90ZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBCb29rbWFya1NlcnZpY2Uge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuICBwcml2YXRlIGlzSG9va2VkID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBtdXRhdGlvbk9ic2VydmVyPzogTXV0YXRpb25PYnNlcnZlcjtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYm9va21hcmtzIGhvb2sgYmFzZWQgb24gc2V0dGluZ3NcclxuICAgKi9cclxuICB1cGRhdGVCb29rbWFya3MoKSB7XHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQm9va21hcmtzICYmICF0aGlzLmlzSG9va2VkKSB7XHJcbiAgICAgIHRoaXMuaG9va0Jvb2ttYXJrcygpO1xyXG4gICAgfSBlbHNlIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQm9va21hcmtzICYmIHRoaXMuaXNIb29rZWQpIHtcclxuICAgICAgdGhpcy51bmhvb2tCb29rbWFya3MoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhvb2sgaW50byBib29rbWFyayBmdW5jdGlvbmFsaXR5IHVzaW5nIERPTSBvYnNlcnZhdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgaG9va0Jvb2ttYXJrcygpIHtcclxuICAgIC8vIENoZWNrIGlmIG1vZGFsIGlzIGFscmVhZHkgcHJlc2VudFxyXG4gICAgY29uc3QgZXhpc3RpbmdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbCcpO1xyXG4gICAgaWYgKGV4aXN0aW5nTW9kYWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICB0aGlzLmhhbmRsZU1vZGFsQXBwZWFyYW5jZShleGlzdGluZ01vZGFsKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTZXQgdXAgbXV0YXRpb24gb2JzZXJ2ZXIgdG8gd2F0Y2ggZm9yIGJvb2ttYXJrIG1vZGFsc1xyXG4gICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4ge1xyXG4gICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykge1xyXG4gICAgICAgIG11dGF0aW9uLmFkZGVkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xyXG4gICAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAvLyBUaGUgbW9kYWwgbWlnaHQgYmUgdGhlIG5vZGUgaXRzZWxmIG9yIGluc2lkZSBpdFxyXG4gICAgICAgICAgICBjb25zdCBtb2RhbEVsID0gbm9kZS5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsJykgPyBub2RlIDogbm9kZS5xdWVyeVNlbGVjdG9yKCcubW9kYWwnKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgaWYgKG1vZGFsRWwpIHtcclxuICAgICAgICAgICAgICB0aGlzLmhhbmRsZU1vZGFsQXBwZWFyYW5jZShtb2RhbEVsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBTdGFydCBvYnNlcnZpbmcgdGhlIGRvY3VtZW50IGJvZHkgZm9yIG5ldyBtb2RhbHNcclxuICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcclxuICAgICAgY2hpbGRMaXN0OiB0cnVlLFxyXG4gICAgICBzdWJ0cmVlOiB0cnVlXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmlzSG9va2VkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZSB3aGVuIGEgbW9kYWwgYXBwZWFyc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgaGFuZGxlTW9kYWxBcHBlYXJhbmNlKG1vZGFsRWw6IEhUTUxFbGVtZW50KSB7XHJcbiAgICBsZXQgYXR0ZW1wdHMgPSAwO1xyXG4gICAgY29uc3QgbWF4QXR0ZW1wdHMgPSAzMDsgLy8gVHJ5IGZvciB1cCB0byAxLjUgc2Vjb25kc1xyXG5cclxuICAgIGNvbnN0IHRyeUlkZW50aWZ5QW5kUG9wdWxhdGUgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHRpdGxlRWwgPSBtb2RhbEVsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC10aXRsZScpO1xyXG4gICAgICBjb25zdCB0aXRsZVRleHQgPSB0aXRsZUVsPy50ZXh0Q29udGVudD8udG9Mb3dlckNhc2UoKSB8fCAnJztcclxuICAgICAgXHJcbiAgICAgIC8vIExvb2sgZm9yIGluZGljYXRvcnMgdGhhdCB0aGlzIGlzIGEgYm9va21hcmsgbW9kYWxcclxuICAgICAgY29uc3QgaXNCb29rbWFya01vZGFsID0gdGl0bGVUZXh0LmluY2x1ZGVzKCdib29rbWFyaycpIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsRWwucXVlcnlTZWxlY3RvcignaW5wdXRbcGxhY2Vob2xkZXIqPVwiYm9va21hcmtcIl0nKSAhPT0gbnVsbCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsRWwucXVlcnlTZWxlY3RvcignaW5wdXRbcGxhY2Vob2xkZXIqPVwiQm9va21hcmtcIl0nKSAhPT0gbnVsbDtcclxuXHJcbiAgICAgIGlmIChpc0Jvb2ttYXJrTW9kYWwpIHtcclxuICAgICAgICAvLyBGaW5kIHRoZSBcIlRpdGxlXCIgYW5kIFwiUGF0aFwiIGlucHV0IGZpZWxkc1xyXG4gICAgICAgIGNvbnN0IHNldHRpbmdJdGVtcyA9IG1vZGFsRWwucXVlcnlTZWxlY3RvckFsbCgnLnNldHRpbmctaXRlbScpO1xyXG4gICAgICAgIGxldCB0aXRsZUlucHV0OiBIVE1MSW5wdXRFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgbGV0IHBhdGhJbnB1dDogSFRNTElucHV0RWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgICAgICBzZXR0aW5nSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgIGNvbnN0IG5hbWVFbCA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLnNldHRpbmctaXRlbS1uYW1lJyk7XHJcbiAgICAgICAgICBjb25zdCBuYW1lVGV4dCA9IG5hbWVFbD8udGV4dENvbnRlbnQ/LnRvTG93ZXJDYXNlKCkudHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgaWYgKG5hbWVUZXh0ID09PSAndGl0bGUnKSB7XHJcbiAgICAgICAgICAgIHRpdGxlSW5wdXQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJ0ZXh0XCJdJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICAgIH0gZWxzZSBpZiAobmFtZVRleHQgPT09ICdwYXRoJykge1xyXG4gICAgICAgICAgICBwYXRoSW5wdXQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJ0ZXh0XCJdJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmFsbGJhY2s6IGlmIHdlIGNhbid0IGZpbmQgYnkgbGFiZWwsIHRoZSBib29rbWFyayBtb2RhbCB1c3VhbGx5IGhhcyBQYXRoIGZpcnN0LCBUaXRsZSBzZWNvbmRcclxuICAgICAgICBpZiAoIXRpdGxlSW5wdXQpIHtcclxuICAgICAgICAgIGNvbnN0IGFsbElucHV0cyA9IG1vZGFsRWwucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1cInRleHRcIl0nKTtcclxuICAgICAgICAgIGlmIChhbGxJbnB1dHMubGVuZ3RoID49IDIpIHtcclxuICAgICAgICAgICAgcGF0aElucHV0ID0gYWxsSW5wdXRzWzBdIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHRpdGxlSW5wdXQgPSBhbGxJbnB1dHNbMV0gYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIElmIHdlIGZvdW5kIHRoZSB0aXRsZSBpbnB1dCwgYnV0IGl0J3MgZW1wdHkgb3IgaGFzIHRoZSBkZWZhdWx0IGZpbGVuYW1lLCB0cnkgdG8gcG9wdWxhdGUgaXRcclxuICAgICAgICBpZiAodGl0bGVJbnB1dCkge1xyXG4gICAgICAgICAgLy8gSWRlbnRpZnkgdGhlIGZpbGVcclxuICAgICAgICAgIGxldCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIFVzZSBwYXRoIGlucHV0IHZhbHVlIGlmIGF2YWlsYWJsZSBmb3IgYmV0dGVyIGFjY3VyYWN5XHJcbiAgICAgICAgICBpZiAocGF0aElucHV0ICYmIHBhdGhJbnB1dC52YWx1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBwYXRoID0gcGF0aElucHV0LnZhbHVlO1xyXG4gICAgICAgICAgICBjb25zdCBhYnN0cmFjdEZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aCArICcubWQnKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aCArICcubWR4Jyk7XHJcbiAgICAgICAgICAgIGlmIChhYnN0cmFjdEZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgICAgIGZpbGUgPSBhYnN0cmFjdEZpbGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAoZmlsZSkge1xyXG4gICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IGF3YWl0IGdldEZyb250bWF0dGVyKHRoaXMucGx1Z2luLmFwcCwgZmlsZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gZnJvbnRtYXR0ZXI/Llt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV07XHJcblxyXG4gICAgICAgICAgICBpZiAocHJvcGVydHlWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHByb3BlcnR5VmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICBsZXQgZGlzcGxheVZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0eVZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgZGlzcGxheVZhbHVlID0gcHJvcGVydHlWYWx1ZTtcclxuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9wZXJ0eVZhbHVlID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5VmFsdWUgPSBTdHJpbmcocHJvcGVydHlWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICBpZiAoZGlzcGxheVZhbHVlICYmIGRpc3BsYXlWYWx1ZS50cmltKCkgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBPbmx5IG92ZXJ3cml0ZSBpZiBpdCBtYXRjaGVzIHRoZSBmaWxlbmFtZSBvciBpcyBlbXB0eSAoZG9uJ3Qgb3ZlcndyaXRlIHVzZXIgZWRpdHMpXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB0aXRsZUlucHV0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXNEZWZhdWx0ID0gY3VycmVudFZhbHVlID09PSAnJyB8fCBjdXJyZW50VmFsdWUgPT09IGZpbGUuYmFzZW5hbWUgfHwgY3VycmVudFZhbHVlID09PSBmaWxlLm5hbWU7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmIChpc0RlZmF1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgdGl0bGVJbnB1dC52YWx1ZSA9IGRpc3BsYXlWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgdGl0bGVJbnB1dC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xyXG4gICAgICAgICAgICAgICAgICB0aXRsZUlucHV0LnNlbGVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gU3VjY2Vzc1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgYXR0ZW1wdHMrKztcclxuICAgICAgaWYgKGF0dGVtcHRzIDwgbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHZvaWQgdHJ5SWRlbnRpZnlBbmRQb3B1bGF0ZSgpLCA1MCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2b2lkIHRyeUlkZW50aWZ5QW5kUG9wdWxhdGUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3Agb2JzZXJ2aW5nIGZvciBib29rbWFyayBtb2RhbHNcclxuICAgKi9cclxuICBwcml2YXRlIHVuaG9va0Jvb2ttYXJrcygpIHtcclxuICAgIGlmICh0aGlzLm11dGF0aW9uT2JzZXJ2ZXIpIHtcclxuICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyID0gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgdGhpcy5pc0hvb2tlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYW51cCBvbiB1bmxvYWRcclxuICAgKi9cclxuICBvbnVubG9hZCgpIHtcclxuICAgIHRoaXMudW5ob29rQm9va21hcmtzKCk7XHJcbiAgfVxyXG59XHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBY0EsZUFBc0IsZUFDcEIsS0FDQSxNQUNBLFVBQ3lDO0FBRXpDLE1BQUksS0FBSyxjQUFjLE1BQU07QUFDM0IsVUFBTSxZQUFZLElBQUksY0FBYyxhQUFhLElBQUk7QUFDckQsWUFBTyx1Q0FBVyxnQkFBZTtBQUFBLEVBQ25DO0FBR0EsTUFBSSxLQUFLLGNBQWMsU0FBUyxTQUFTLGtCQUFrQjtBQUN6RCxRQUFJO0FBRUYsWUFBTSxVQUFVLE1BQU0sSUFBSSxNQUFNLEtBQUssSUFBSTtBQUl6QyxZQUFNLG1CQUFtQjtBQUN6QixZQUFNLFFBQVEsUUFBUSxNQUFNLGdCQUFnQjtBQUU1QyxVQUFJLFNBQVMsTUFBTSxDQUFDLEdBQUc7QUFDckIsY0FBTSxrQkFBa0IsTUFBTSxDQUFDO0FBRS9CLFlBQUk7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QUFNLGFBQWEsd0JBQWtDLGNBQXdCO0FBQzNFLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUVqQyxRQUFJLDJCQUEyQixVQUFhLDJCQUEyQixLQUFLLFNBQVMsd0JBQXdCO0FBQzNHLFdBQUssb0JBQW9CO0FBQUEsSUFDM0I7QUFDQSxRQUFJLGlCQUFpQixVQUFhLGlCQUFpQixLQUFLLFNBQVMsZUFBZTtBQUc5RSxXQUFLLEtBQUssV0FBVyxlQUFlO0FBQ3BDLFdBQUssV0FBVztBQUFBLElBQ2xCO0FBRUEsU0FBSyxnQkFBZ0I7QUFBQSxFQUN2QjtBQUNGOyIsCiAgIm5hbWVzIjogWyJnZXRGcm9udG1hdHRlciIsICJpbXBvcnRfb2JzaWRpYW4iLCAiZ2V0RnJvbnRtYXR0ZXIiLCAiaXNGaWxlVHlwZVN1cHBvcnRlZCIsICJiZWhhdmlvciIsICJzZWFyY2hRdWVyeSIsICJfYSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImdldEZyb250bWF0dGVyIiwgImlzRmlsZVR5cGVTdXBwb3J0ZWQiLCAiYmVoYXZpb3IiLCAic3VnZ2VzdGlvbnMiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiUXVpY2tTd2l0Y2hNb2RhbCIsICJRdWlja1N3aXRjaE1vZGFsIiwgImltcG9ydF9vYnNpZGlhbiIsICJhY3RpdmVWaWV3IiwgImdldEZyb250bWF0dGVyIiwgImlzRmlsZVR5cGVTdXBwb3J0ZWQiLCAiaW1wb3J0X29ic2lkaWFuIiwgIm5vZGUiLCAiaW1wb3J0X29ic2lkaWFuIiwgImdldEZyb250bWF0dGVyIiwgImlzRmlsZVR5cGVTdXBwb3J0ZWQiLCAiX2EiLCAiaW1wb3J0X29ic2lkaWFuIiwgImdldEZyb250bWF0dGVyIiwgImlzRmlsZVR5cGVTdXBwb3J0ZWQiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJfYSJdCn0K
